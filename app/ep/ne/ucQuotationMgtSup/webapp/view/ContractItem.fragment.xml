<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core" 
    xmlns:f="sap.f"
    xmlns:form="sap.ui.layout.form"
    xmlns:t="sap.ui.table"
    xmlns:layout="sap.ui.layout" >
    <Dialog id="dialogContractItem" class="sapUiSmallMargin" title="단가계약품목" contentWidth="100%"  contentHeight="630px" afterClose="dialogContractItemAfterclose">
        <VBox class="sapUiSmallMargin">
            <form:SimpleForm id="popSearchForm" maxContainerCols="2" editable="true" layout="ResponsiveGridLayout" adjustLabelSpan="false" labelSpanL="4" labelSpanM="4" emptySpanL="0" emptySpanM="0" columnsL="2" columnsM="2" Height="350px">
                    <form:content>
                        <VBox>
                            <Label
                                text="대분류(공종): "
                                labelFor="searchPopEpItemClassCode">
                            </Label>
                            <ComboBox   
                                id="searchPopEpItemClassCode"
                                placeholder="All"
                                showSecondaryValues= "true"
                                selectionChange=".onTenantChange"

                                items="{
                                    path: '/ItemClassView'
                                }"
                            >
                               <core:ListItem 
                                    key="{code}" 
                                    text="{name}"/>
                            </ComboBox>
                            <layoutData>
                                <layout:GridData span="XL3 L3 M12 S12" />
                            </layoutData>
                        </VBox>
                        <VBox>
                            <Label
                                text="단가운영단위(플랜트): "
                                labelFor="searchPopOrgCode">
                            </Label>
                            <Text id="searchPopOrgCode" />                               
                            <layoutData>
                                <layout:GridData span="XL3 L3 M12 S12" />
                            </layoutData>
                        </VBox>
                        <VBox>
                            <Label
                                text="만료계약포함: "
                                labelFor="searchRateUseflag">
                            </Label>
                            <SegmentedButton 
                                id="searchRateUseflag"
                                selectedKey="false" 
                                width="100%">
                                <items>
                                    <SegmentedButtonItem text="Yes" width="3em" key="true"/>
                                    <SegmentedButtonItem text="No" width="3em" key="false"/>
                                </items>
                            </SegmentedButton>
                            <layoutData>
                                <layout:GridData span="XL3 L3 M12 S12" />
                            </layoutData>
                        </VBox>

                        <FlexBox
                            alignItems="Start"
                            justifyContent="End">
                            <Button 
                                id="btn_search"
                                text="{I18N>/SEARCH}"
                                type="Emphasized"
                                press=".onSearch"/>
                            <layoutData>
                                <layout:GridData span="XL3 L3 M12 S12" />
                            </layoutData>
                        </FlexBox>

                        <VBox>
                            <Label
                                text="품목명: "
                                labelFor="searchPopItemDesc">
                            </Label>
                            <Input id="searchPopItemDesc" 
                                placeholder="Search Item name"/>
                            <layoutData>
                                <layout:GridData
                                    span="XL6 L6 M12 S12" />
                            </layoutData>
                        </VBox>

                        <VBox>
                            <Label
                                text="계약명: "
                                labelFor="searchPopNetPriceContractTitle">
                            </Label>
                            <Input id="searchPopNetPriceContractTitle" 
                                placeholder="Search Contract name"/>
                            <layoutData>
                                <layout:GridData
                                    span="XL6 L6 M12 S12" />
                            </layoutData>
                        </VBox>
                       </form:content>
                    <form:content>
                    
                        
                        
                      
                         </form:content>
                  </form:SimpleForm>

                  <HBox renderType="Bare">
                  <t:Table id="popTable"
                            selectionMode="MultiToggle"
                            rows="{
                                path: 'popUcQuotationSup>/'
                            }"
                            cellClick=".onCellClickPress"
                            rowSelectionChange=".onCheck"
                            visibleRowCountMode="Auto"
                            columnResize="onColumnResize"
                            width="45%">
                            <t:extension>
                                <OverflowToolbar class="sapFDynamicPageAlignContent">
                                <Title text="Available Contract Item List {= ${popUcQuotationSup>/}.length > 0 ? '(' + ${popUcQuotationSup>/}.length + ')' : ''}" level="H2"/>
                                <ToolbarSpacer/>
                                
                                <!-- <ToolbarSeparator/>
                                <Button icon="sap-icon://action-settings" press=".onMainTablePersoButtonPressed" >
                                    <layoutData>
                                    <OverflowToolbarLayoutData priority="NeverOverflow"/>
                                    </layoutData>
                                </Button> -->

                                
                                </OverflowToolbar>
                            </t:extension>
    
                            <t:columns>
                                <t:Column id="popEpItemCode" width="8rem" hAlign="Center">
                                <Label text="품목코드" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text text="{popUcQuotationSup>ep_item_code}"/>
                                </t:template>
                                </t:Column>
                                <t:Column id="popItemDesc" width="15rem">
                                <Label text="품목명" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text text="{popUcQuotationSup>item_desc}"/>
                                </t:template>
                                </t:Column>
                                <t:Column id="popSpecDesc" width="20rem">
                                <Label text="규격" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text text="{popUcQuotationSup>spec_desc}" />
                                </t:template>
                                </t:Column> 
                                <t:Column id="popUnit" width="4rem">
                                <Label text="단위" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text text="{popUcQuotationSup>unit}"/>
                                </t:template>
                                </t:Column>
                                <t:Column id="popMaterialNetPrice" width="8rem" hAlign="Right">
                                <Label text="자재단가" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text  text="{
                                                    path: 'popUcQuotationSup>material_net_price',
                                                    formatter: '.numberFormatter.toNumberString'
                                                }"/>
                                </t:template>
                                </t:Column>
                                <t:Column id="popLaborNetPrice" width="8rem" hAlign="Right">
                                <Label text="노무단가" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text  text="{
                                                path: 'popUcQuotationSup>labor_net_price',
                                                formatter: '.numberFormatter.toNumberString'
                                            }"/>
                                </t:template>
                                </t:Column>  
                                <t:Column id="popNetPriceContractTitle" width="20rem" hAlign="Left">
                                <Label text="계약명" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text text="{popUcQuotationSup>net_price_contract_title}"/>
                                </t:template>
                                </t:Column>
                                <t:Column id="popNetPriceContractStartDate" width="12rem" hAlign="Center"> 
                                <Label text="계약기간" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text text="{popUcQuotationSup>net_price_contract_period}"/>
                                </t:template>
                                </t:Column>
                                
                            </t:columns>
                            </t:Table>

                    <VBox justifyContent="Center" class="sapUiTinyMarginBeginEnd">
                        <Button
                            class="sapUiTinyMarginBottom"
                            icon="sap-icon://navigation-right-arrow"
                            tooltip="Move to selected"
                            press="moveToTable2"/>
                        <Button
                            icon="sap-icon://navigation-left-arrow"
                            tooltip="Move to available"
                            press="moveToTable1"/>
                    </VBox>


                    <t:Table id="popTable2"
                            selectionMode="MultiToggle"
                            rows="{
                                path: 'viewModel>/popUcdetails/'
                            }"
                            cellClick=".onCellClickPress"
                            rowSelectionChange=".onCheck"
                            visibleRowCountMode="Auto"
                            columnResize="onColumnResize"
                            width="45%">
                            <t:extension>
                                <OverflowToolbar class="sapFDynamicPageAlignContent">
                                <Title text="Selected Contract Item List {= ${viewModel>/popUcdetails>/}.length > 0 ? '(' + ${viewModel>/popUcdetails>/}.length + ')' : ''}" level="H2"/>
                                <ToolbarSpacer/>
                                
                                <!-- <ToolbarSeparator/>
                                <Button icon="sap-icon://action-settings" press=".onMainTablePersoButtonPressed" >
                                    <layoutData>
                                    <OverflowToolbarLayoutData priority="NeverOverflow"/>
                                    </layoutData>
                                </Button> -->

                                
                                </OverflowToolbar>
                            </t:extension>
    
                            <t:columns>
                                <t:Column id="popEpItemCode2" width="8rem" hAlign="Center">
                                <Label text="품목코드" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text text="{viewModel>ep_item_code}"/>
                                </t:template>
                                </t:Column>
                                <t:Column id="popItemDesc2" width="15rem">
                                <Label text="품목명" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text text="{viewModel>item_desc}"/>
                                </t:template>
                                </t:Column>
                                <t:Column id="popSpecDesc2" width="20rem">
                                <Label text="규격" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text text="{viewModel>spec_desc}" />
                                </t:template>
                                </t:Column> 
                                <t:Column id="popUnit2" width="4rem">
                                <Label text="단위" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text text="{viewModel>unit}"/>
                                </t:template>
                                </t:Column>
                                <t:Column id="popMaterialNetPrice2" width="8rem" hAlign="Right">
                                <Label text="자재단가" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text  text="{
                                                path: 'viewModel>material_net_price',
                                                formatter: '.numberFormatter.toNumberString'
                                            }"/>
                                </t:template>
                                </t:Column>
                                <t:Column id="popLaborNetPrice2" width="8rem" hAlign="Right">
                                <Label text="노무단가" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text  text="{
                                                path: 'viewModel>labor_net_price',
                                                formatter: '.numberFormatter.toNumberString'
                                            }"/>
                                </t:template>
                                </t:Column>  
                                <t:Column id="popNetPriceContractTitle2" width="20rem" hAlign="Left">
                                <Label text="계약명" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text text="{viewModel>net_price_contract_title}"/>
                                </t:template>
                                </t:Column>
                                <t:Column id="popNetPriceContractStartDate2" width="12rem" hAlign="Center"> 
                                <Label text="계약기간" textAlign="Center" width="100%"/>
                                <t:template>
                                    <Text text="{viewModel>net_price_contract_period}"/>
                                    <!-- <Text text="{
                                            path: 'popUcQuotationSup>net_price_contract_period',
                                            type: 'sap.ui.model.type.Date',
                                            formatOptions: {
                                                pattern: 'yyyy/MM/dd'
                                            }                                        
                                        }" />  -->
                                </t:template>
                                </t:Column>
                                
                            </t:columns>
                            </t:Table>
                        </HBox>
            </VBox>       

      
        <ToolbarSpacer/>
        <HBox alignItems="End" justifyContent="End" >
            <Button text="Cancel" type="Transparent"  class="sapUiSmallMargin" press=".onExitContractItem"/>
            <Button text="Apply" class="sapUiSmallMargin" type="Emphasized" press=".onContractItemSelectionApply"/>
        </HBox>
    </Dialog>
</core:FragmentDefinition>
