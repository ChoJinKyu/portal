<mvc:View controllerName="sp.vi.basePriceMgt.controller.BasePriceList"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m"
  xmlns:f="sap.f"
  xmlns:core="sap.ui.core"
  xmlns:form="sap.ui.layout.form"
  xmlns:t="sap.ui.table"
  xmlns:layout="sap.ui.layout"
  xmlns:tnt="sap.tnt"
  xmlns:lib-m="ext.lib.control.m"
  displayBlock="true"
  height="100%">
    <f:DynamicPage
        headerExpanded="true"
        showFooter="true"
        toggleHeaderOnTitleClick="true">
      <f:title>
        <f:DynamicPageTitle>
          <f:heading>
            <Title text="{I18N>/SP_BASE_PRICE_APPROVAL_LIST}" />
          </f:heading>
          <f:actions>
            <Button text="{I18N>/SEARCH}" type="Emphasized" press=".onSearch"/>
          </f:actions>
        </f:DynamicPageTitle>
      </f:title>
      <f:header>
        <f:DynamicPageHeader pinnable="true">
          <!--Filterbar 시작-->
          <form:SimpleForm
            editable="true"
            layout="ResponsiveGridLayout"
            adjustLabelSpan="false">
                <form:content>
                    <!-- Type 시작 -->
                    <VBox>
                        <Label text="{I18N>/TYPE} "></Label>
                        <ComboBox
                            width="100%"
                            selectedKey="{filterModel>/type}"
                            items="{
                            path: 'filterModel>/type_list',
                            filters: [
                            ]
                            }">
                            <items>
                            <core:Item key="{filterModel>code}" text="{filterModel>text}" />
                            </items>
                        </ComboBox>
                        <layoutData>
                            <layout:GridData span="XL2 L4 M6 S12" />
                        </layoutData>
                    </VBox>
                    <!-- Type 끝 -->
                    
                    <!-- Approval Number 시작 -->
                    <VBox>
                        <Label text="{I18N>/APPROVAL_NUMBER} " />
                        <Input value="{filterModel>/approvalNumber}" change=".onSearch" />
                        <layoutData>
                            <layout:GridData span="XL2 L4 M6 S12" />
                        </layoutData>
                    </VBox>
                    <!-- Approval Number 끝 -->

                    <!-- Approval Title 시작 -->
                    <VBox>
                        <Label text="{I18N>/APPROVAL_TITLE} " />
                        <Input value="{filterModel>/approvalTitle}" change=".onSearch" />
                        <layoutData>
                            <layout:GridData span="XL2 L4 M6 S12" />
                        </layoutData>
                    </VBox>
                    <!-- Approval Title 끝 -->

                    <!-- Request Date 시작 -->
                    <VBox>
                        <Label text="{I18N>/REQUEST_DATE} "></Label>
                        <DateRangeSelection
                             value="{
                                    parts: [
                                        {path: 'filterModel>/dateValue'}, 
                                        {path: 'filterModel>/secondDateValue'}
                                    ], 
                                    type: 'sap.ui.model.type.DateInterval',
                                    formatOptions: { UTC: true, format: 'yMd' }
                                }" />
                        <layoutData>
                            <layout:GridData span="XL2 L4 M6 S12" />
                        </layoutData>
                    </VBox>
                    <!-- Request Date 끝 -->

                    <!-- Request By 시작 -->
                    <VBox height="56px">
                        <Label text="{I18N>/REQUESTOR} "></Label>
                        <lib-m:CodePicker
                            placeholder="Enter a Employee name"
                            value="{filterModel>/requestBy}"
                            keyField="employee_number"
                            textField="user_local_name"
                            suggestionItems="{
                                path: '/',
                                filters: [
                                    {path: 'tenant_id', operator: 'EQ', value1: 'L2100'}
                                ],
                                serviceUrl: 'srv-api/odata/v2/cm.util.HrService/',
                                entityName: 'Employee'
                            }">
                            <lib-m:CodePickerValueHelp contentWidth="500px" title="Choose a Employee"
                                keyFieldHeaderText="Employee ID" textFieldHeaderText="Employee" />
                        </lib-m:CodePicker>
                        <layoutData>
                            <layout:GridData span="XL2 L4 M6 S12" />
                        </layoutData>
                    </VBox>
                    <!-- Request By 끝 -->
                    <!-- 품의유형 시작 -->
                    <VBox>
                        <Label text="{I18N>/SP_APPROVAL_TYPE}"></Label>
                        <ComboBox
                            width="100%"
                            selectedKey="{filterModel>/net_price_type_code}"
                            items="{
                            path: 'codeMgt>/CodeLanguages',
                            filters: [ 
                                 {path: 'group_code', operator: 'EQ', value1: 'SP_VI_NET_PRICE_TYPE_CODE'}
                            ]
                            }">
                            <items>
                            <core:Item key="{codeMgt>code}" text="{codeMgt>code_name}" />
                            </items>
                        </ComboBox>
                        <layoutData>
                            <layout:GridData span="XL2 L4 M6 S12" />
                        </layoutData>
                    </VBox>
                    <!-- 품의유형 끝 -->

                    <!-- Status 시작 -->
                    <VBox>
                        <Label text="{I18N>/STATUS} "></Label>
                        <SegmentedButton id="searchStatusS" selectedKey="{filterModel>/status}" class="sapUiSmallMarginBottom" width="100%" selectionChange="onStatusSelectionChange" >
                            <items>
                                <SegmentedButtonItem text="{I18N>/ALL}" key="" />
                                <SegmentedButtonItem text="{rootModel>/processList/0/code_name}" key="{rootModel>/processList/0/code}" width="4.7rem" />
                                <SegmentedButtonItem text="{rootModel>/processList/1/code_name}" key="{rootModel>/processList/1/code}" width="5.2rem" />
                                <SegmentedButtonItem text="{rootModel>/processList/2/code_name}" key="{rootModel>/processList/2/code}" width="4.8rem" />
                                <SegmentedButtonItem text="{rootModel>/processList/3/code_name}" key="{rootModel>/processList/3/code}" width="4.5rem" />
                                <SegmentedButtonItem text="{rootModel>/processList/4/code_name}" key="{rootModel>/processList/4/code}" width="4.5rem" />
                            </items>
                        </SegmentedButton>
                        <layoutData>
                            <layout:GridData span="XL4 L4 M6 S12" />
                        </layoutData>
                    </VBox>
                    <!-- Status 끝 -->
                </form:content>
            </form:SimpleForm>
            <!--Filterbar 끝-->
        </f:DynamicPageHeader>
      </f:header>
      <f:content>
        <!--Base Price List 시작-->
        <t:Table id="listTable"
            selectionMode="None"
            rows="{listModel>/results}"
            visibleRowCountMode="Auto">
            <t:extension>
                <OverflowToolbar class="sapFDynamicPageAlignContent">
                    <Title text="{I18N>/BASE_PRICE_LIST} ({= ${listModel>/results}.length || 0})" level="H2"/>
                    <ToolbarSpacer />
                    <Button text="{I18N>/CREATE}" press=".onOpenCreateDialog" />
                    <ToolbarSeparator/>
                    <Button icon="sap-icon://excel-attachment" press=".onExcelExport" >
                        <layoutData>
                            <OverflowToolbarLayoutData priority="NeverOverflow" />
                        </layoutData>
                    </Button>
                </OverflowToolbar>
            </t:extension>
            <t:columns>
                <t:Column hAlign="Center" width="10rem">
                    <Label text="{I18N>/APPROVAL_NUMBER}" textAlign="Center" />
                    <t:template>
                        <Link text="{listModel>approval_number}" press=".onGoDetail" />
                    </t:template>
                </t:Column>
                <t:Column>
                    <Label text="{I18N>/APPROVAL_TITLE}" textAlign="Center" width="100%" />
                    <t:template>
                        <Text text="{listModel>approval_title}" />
                    </t:template>
                </t:Column>
                <t:Column hAlign="Center" width="12rem">
                    <Label text="{I18N>/SP_APPROVAL_TYPE}"  textAlign="Center" width="100%" />
                    <t:template>
                        <tnt:InfoLabel 
                            text="{listModel>net_price_type_code_nm}" 
                            colorScheme="{
                                path: 'listModel>net_price_type_code',
                                formatter: '.onStatusColor'
                            }" />
                    </t:template>
                </t:Column>
                <t:Column hAlign="Center" width="12rem">
                    <Label text="{I18N>/STATUS}"  textAlign="Center" width="100%" />
                    <t:template>
                        <tnt:InfoLabel 
                            text="{listModel>approve_status_code_nm}" 
                            colorScheme="{
                                path: 'listModel>approve_status_code',
                                formatter: '.onStatusColor'
                            }" />
                    </t:template>
                </t:Column>
                <t:Column hAlign="Center" width="7rem">
                    <Label text="{I18N>/REQUEST_DATE}" />
                    <t:template>
                        <Text text="{
                                path: 'listModel>local_create_dtm',
                                formatter: '.dateFormatter.toDateString'}" />
                    </t:template>
                </t:Column>
                <t:Column hAlign="Center" width="12rem">
                    <Label text="{I18N>/REQUESTOR}" />
                    <t:template>
                        <Text text="{listModel>requestor_local_nm}" />
                    </t:template>
                </t:Column>
            </t:columns>
        </t:Table>
        <!--Base Price List 끝-->
      </f:content>
    </f:DynamicPage>
</mvc:View>
