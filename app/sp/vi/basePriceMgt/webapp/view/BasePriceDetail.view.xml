<mvc:View controllerName="sp.vi.basePriceMgt.controller.BasePriceDetail"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:uxap="sap.uxap"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:form="sap.ui.layout.form"
    xmlns:layout="sap.ui.layout"
    xmlns:core="sap.ui.core"
    xmlns:lib-m="ext.lib.m"
    xmlns:lib-cm="ext.lib.control.m"
    xmlns:t="sap.ui.table"
    xmlns:tnt="sap.tnt"    
    xmlns:co="sap.suite.ui.commons"
    xmlns:rte="sap.ui.richtexteditor"
    height="100%">

    <uxap:ObjectPageLayout
        showTitleInHeaderContent="true"
		showEditHeaderButton="true"
        upperCaseAnchorBar="false"
        headerContentPinnable="false"
        showAnchorBarPopover="false"
        showFooter="true">

		<uxap:headerTitle>
			<uxap:ObjectPageDynamicHeaderTitle>
				<uxap:expandedHeading>
                    <HBox alignItems="End">
                        <OverflowToolbarButton type="Transparent" icon="sap-icon://nav-back" press=".onBack" />
                        <Title text="{I18N>/NEW_BASE_PRICE}" wrapping="true"/>
                    </HBox>
				</uxap:expandedHeading>
                <uxap:navigationActions>
					<!-- <OverflowToolbarButton icon="sap-icon://decline" text="{I18N>/BACK}" press=".onBack" /> -->
                </uxap:navigationActions>
			</uxap:ObjectPageDynamicHeaderTitle>
		</uxap:headerTitle>

		<uxap:headerContent>
			<FlexBox wrap="Wrap">
                <!-- base Info 시작 -->
                <layout:VerticalLayout class="sapUiLargeMarginBeginEnd">
                    <ObjectStatus title="{I18N>/APPROVAL_NO}" text="{detailModel>/approval_number}"/>
                    <ObjectStatus title="{I18N>/REQUESTOR}" text="{detailModel>/create_user_id}"/>
                    <ObjectStatus title="{I18N>/REQUEST_DATE}" text="{path:'detailModel>/local_update_dtm', formatter: '.dateFormatter.toDateString'}"/>
                    <ObjectStatus title="사번본부" text="{detailModel>/corp}"/>
                </layout:VerticalLayout>
                <!-- base Info 끝 -->

                <!-- Status 시작 -->
				<layout:VerticalLayout class="sapUiLargeMarginBeginEnd">
					<Label text="{I18N>/STATUS} :"/>
                    <ObjectStatus class="sapMObjectStatusLarge" text="{I18N>/DRAFT}" state="Error" />
				</layout:VerticalLayout>
                <!-- Status 끝 -->

                <!-- Process 시작 -->
                <layout:VerticalLayout class="sapUiLargeMarginBeginEnd">
					<Label text="Process : "/>
                    <HBox>
                        <co:MicroProcessFlow>
                            <co:content>   
                                <!-- <co:MicroProcessFlowItem 
                                    state="{= ${detailModel>/approval_status_code} === '10' ? 'Error' : 'None'}" 
                                    stepWidth="5rem" 
                                    icon="{= ${detailModel>/approval_status_code} === '10' ? 'sap-icon://circle-task' : 'sap-icon://complete'}" />
                                <co:MicroProcessFlowItem 
                                    state="{= ${detailModel>/approval_status_code} === '20' ? 'Error' : 'None'}" 
                                    stepWidth="5rem"
                                    icon="{= ${detailModel>/approval_status_code} === '20' ? 'sap-icon://circle-task' : (${detailModel>/approval_status_code} === '30' ? 'sap-icon://complete' : '')}" />
                                <co:MicroProcessFlowItem 
                                    state="{= ${detailModel>/approval_status_code} === '30' ? 'Error' : 'None'}" 
                                    stepWidth="5rem"
                                    icon="{= ${detailModel>/approval_status_code} === '30' ? 'sap-icon://circle-task' : ''}" /> -->
                                <co:MicroProcessFlowItem  
                                    state="Error" 
                                    stepWidth="5rem" 
                                    icon="sap-icon://complete" />
                                <co:MicroProcessFlowItem 
                                    state="None" 
                                    stepWidth="5rem"
                                    icon="sap-icon://circle-task" />
                                <co:MicroProcessFlowItem 
                                    state="None" 
                                    stepWidth="5rem"
                                    icon="sap-icon://circle-task" />
                            </co:content>
                        </co:MicroProcessFlow>
                    </HBox>
                    <HBox>
                        <Text text="{I18N>/DRAFT}" width="4rem" />
                        <Text text="{I18N>/REQUEST_FOR_APPROVAL}" width="6rem" textAlign="Center" />
                        <Text text="{I18N>/APPROVED}" width="6rem" textAlign="Center" />
                    </HBox>
				</layout:VerticalLayout>
                <!-- Process 끝 -->
			</FlexBox>
		</uxap:headerContent>

        <uxap:sections>
            <!-- General Information 시작 -->
			<uxap:ObjectPageSection titleUppercase="false" title="{I18N>/GENERAL_INFO}">
				<uxap:subSections>
					<uxap:ObjectPageSubSection>
						<uxap:blocks>
                            <VBox>
                                <HBox alignItems="Center">
                                    <Label text="{I18N>/TITLE}" class="sapUiTinyMarginEnd" textAlign="Left" labelFor="input" required="true"/>
                                    <Input width="20rem" placeholder="" editable="true" value="{detailModel>/approval_title}">
                                    </Input>
                                </HBox>
                                <VBox>
                                    <Label text="{I18N>/DESCRIPTION}" required="true"/>
                                    <!-- Text Editor 시작 -->
                                    <!-- <layout:VerticalLayout id="idVerticalLayout" class="sapUiContentPadding" width="100%">
                                    </layout:VerticalLayout> -->
                                    <rte:RichTextEditor 
                                        width="100%" 
                                        height="200px" 
                                        value="{detailModel>/approval_request_desc}" 
                                        customToolbar="true" 
                                        showGroupFont="true" 
                                        showGroupLink="true" 
                                        showGroupInsert="true"
                                        editable="{detailViewModel>/viewMode}" />
                                    <!-- Text Editor 끝 -->
                                </VBox>
                            </VBox>
						</uxap:blocks>
					</uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>
            <!-- General Information 끝 -->

            <!-- Base Price List 시작 -->
			<uxap:ObjectPageSection titleUppercase="false" title="{I18N>/BASE_PRICE_LIST}">
				<uxap:subSections>
					<uxap:ObjectPageSubSection>
						<uxap:blocks>
                            <VBox>
                            <t:Table id="BasePriceDetailTable" selectionMode="Single" width="auto" class="sapFDynamicPageAlignContent" visibleRowCountMode="Auto" 
                                  rows="{detailModel>/details}">
                                    <t:extension>
                                        <OverflowToolbar class="sapFDynamicPageAlignContent">
                                            <Title text="{I18N>/BASE_PRICE_LIST}" level="H2"/>
                                        <ToolbarSpacer />
                                        <Label text="{I18N>/MANAGEMENT}/{I18N>/MARKET_PRICE}" class="sapUiTinyMarginEnd" textAlign="Left" /> 
                                        <ComboBox id="listManagementComboBox" width="7rem" selectedKey="" 
                                            items="{path: 'rootModel>/management_mprice_code'}">
                                            <items>
                                                <core:Item key="{rootModel>code}" text="{rootModel>text}" />
                                            </items>
                                        </ComboBox>
                                        <ToolbarSeparator/>
                                        <Button text="{I18N>/TEMPLATE}" type="Emphasized" press=".onTemplateDownload" />
                                        <Button text="{I18N>/UPLOAD}" type="Emphasized" press=".onExcelUpload" />
                                        <Button text="{I18N>/ROW_ADD}" type="Emphasized" press=".onListRowAdd" />
                                        <Button text="{I18N>/ROW_DELETE}" type="Emphasized" press=".onListRowDelete" />
                                        <!-- <Button icon="sap-icon://excel-attachment" press=".onExcelExportPress"/>
                                        <Button icon="sap-icon://excel-attachment" press=".onExcelExportPress"/>
                                        <Button icon="sap-icon://excel-attachment" press=".onExcelExportPress"/> --> 
                                        </OverflowToolbar>
                                    </t:extension>
                                    <t:columns>
                                        <t:Column hAlign="Left" width="3rem">
                                        <Label text="{I18N>/STATUS}" textAlign="Center" width="100%"/>
                                        <t:template>
                                            <Text text="{detailModel>status}" />
                                        </t:template>
                                        </t:Column>
                                        <t:Column hAlign="Left" width="5rem">
                                            <Label text="{I18N>/LINE_NO}" textAlign="Center" width="100%"/>
                                            <t:template>
                                                <Text text="{detailModel>line_no}" />
                                            </t:template>
                                        </t:Column>
                                        <t:Column hAlign="Left" width="8rem">
                                            <Label text="{I18N>/MANAGEMENT}/{I18N>/MARKET_PRICE}" textAlign="Center" width="100%"/>
                                            <t:template>
                                                <Text text="{detailModel>management}" />
                                            </t:template>
                                        </t:Column>
                                        <t:Column hAlign="Left" width="8rem">
                                            <Label text="{I18N>/BASE} {I18N>/YEAR}" textAlign="Center" width="100%"/>
                                            <t:template>
                                                <Text text="{detailModel>base_year}" />
                                            </t:template>
                                        </t:Column>
                                        <t:Column hAlign="Left" width="8rem">
                                            <Label text="{I18N>/APPLY_START_DATE}" textAlign="Center" width="100%"/>
                                            <t:template>
                                                <DatePicker editable="{= ${detailModel>row_state} === 'edit' }" required="true"
                                                            displayFormat="y-MM" class="sapUiSmallMarginBottom" 
                                                            value="{ path: 'detailModel>apply_start_date'}" />
                                            </t:template>
                                        </t:Column>
                                    <t:Column hAlign="Left" width="8rem">
                                        <Label text="{I18N>/APPLY_END_DATE}" textAlign="Center" width="100%"/>
                                        <t:template>
                                            <DatePicker editable="{= ${detailModel>row_state} === 'edit' }" required="true"
                                                        displayFormat="y-MM" class="sapUiSmallMarginBottom" 
                                                        value="{ path: 'detailModel>apply_end_date' }" />
                                        </t:template>
                                    </t:Column>
                                    <t:Column hAlign="Left" width="10rem">
                                        <Label text="{I18N>/BUSINESS_DIVISION}" textAlign="Center" width="100%"/>
                                        <t:template>
                                            <ComboBox id="listDivComboBox" width="100%" selectedKey="{detailModel>business_division}" 
                                                items="{
                                                        path: 'rootModel>/org_Division'
                                                       }">
                                                <items>
                                                    <core:Item key="{rootModel>bizdivision_code}" text="{rootModel>bizdivision_code} [{rootModel>bizdivision_name}]" />
                                                </items>
                                            </ComboBox>
                                        </t:template>
                                    </t:Column>
                                    <t:Column hAlign="Left" width="8rem">
                                        <Label text="{I18N>/CORPORATION}" textAlign="Center" width="100%" />
                                        <t:template>
                                            <ComboBox id="CorpComboBox" width="100%"  selectedKey="{detailModel>corporation}" 
                                                editable="{= ${detailModel>row_state} === 'edit' }"
                                                items="{ path: 'rootModel>/org_Company' }" change=".onChangeCorporation"> 
                                                <items>
                                                    <core:Item key="{rootModel>company_code}" text="{rootModel>affiliate_code} [{rootModel>company_code}]" />
                                                </items>
                                            </ComboBox>
                                        </t:template>
                                    </t:Column>
                                    <t:Column hAlign="Center" width="8rem">
                                        <Label text="{I18N>/PLANT}" textAlign="Center" width="100%" />
                                        <t:template>
                                            <ComboBox width="100%" editable="{= ${detailModel>row_state} === 'edit' }"
                                                selectedKey="{detailModel>plant}" 
                                                items="{
                                                        path: 'detailModel>org_Plant'
                                                        }">
                                                <items>
                                                    <core:Item key="{detailModel>plant_code}" text="{detailModel>plant_code}" />
                                                </items>
                                            </ComboBox>
                                        </t:template>
                                    </t:Column>
                                    <t:Column hAlign="Center" width="8rem">
                                        <Label text="{I18N>/SUPPLIER_CODE}" textAlign="Center" width="100%" />
                                        <t:template>
                                            <MultiInput editable="{= ${detailModel>row_state} === 'edit' }"
                                                    valueHelpRequest=".onInputSupplierWithOrgValuePress" value="{detailModel>supplier_code}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column hAlign="Center" width="8rem">
                                        <Label  text="{I18N>/SUPPLIER}" textAlign="Center" width="100%" />
                                        <t:template>
                                            <Input editable="{= ${detailModel>row_state} === 'edit' }" value="{detailModel>supplier}"/>
                                        </t:template>
                                    </t:Column>
                                     <t:Column hAlign="Left" width="8rem">
                                        <Label text="{I18N>/MATERIAL} {I18N>/CODE}" textAlign="Center" width="100%"/>
                                        <t:template>
                                            <MultiInput editable="{= ${detailModel>row_state} === 'edit' }"
                                                    valueHelpRequest="onMaterialMasterMultiDialogPress" value="{detailModel>material_code}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column hAlign="Left" width="8rem">
                                        <Label text="{I18N>/MATERIAL}" textAlign="Center" width="100%"/>
                                        <t:template>
                                            <Input editable="{= ${detailModel>row_state} === 'edit' }" value="{detailModel>material}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column hAlign="Left" width="8rem">
                                        <Label text="{I18N>/VENDOR_POOL}" textAlign="Center" width="100%"/>
                                        <t:template>
                                            <Input editable="{= ${detailModel>row_state} === 'edit' }" value="{detailModel>vendor_pool}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column hAlign="Left" width="8rem">
                                        <Label text="{I18N>/CURRENCY}" textAlign="Center" width="100%"/>
                                        <t:template>
                                            <ComboBox selectedKey="" editable="{= ${detailModel>row_state} === 'edit' }"
                                                    items="{ path: 'currencyODataModel>/Currency' }">
                                            <items>
                                                <core:Item key="{currencyODataModel>currency_code}" text="{currencyODataModel>currency_code}" />
                                            </items>
                                        </ComboBox>
                                        </t:template>
                                    </t:Column>
                                    <t:Column hAlign="Left" width="8rem">
                                        <Label text="{I18N>/QUANTITY}" textAlign="Center" width="100%"/>
                                        <t:template>
                                            <Input editable="{= ${detailModel>row_state} === 'edit' }" value="{detailModel>basePriceUnit}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column hAlign="Left" width="8rem">
                                        <Label text="{I18N>/BASE_PRICE}" textAlign="Center" width="100%"/>
                                        <t:template>
                                            <Input editable="{= ${detailModel>row_state} === 'edit' }" value="{detailModel>base_price}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column hAlign="Left" width="8rem">
                                        <Label text="{I18N>/BUYER}" textAlign="Center" width="100%"/>
                                        <t:template>
                                            <MultiInput editable="{= ${detailModel>row_state} === 'edit' }"
                                                    valueHelpRequest="onEmployeeDialogPress" value="{detailModel>buyer}"/>
                                        </t:template>
                                    </t:Column>
                                </t:columns>
                            </t:Table>
                            </VBox>
						</uxap:blocks>
					</uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>
            <!-- Base Price List 끝 -->

            <!-- Attachment 시작 -->
			<uxap:ObjectPageSection titleUppercase="false" title="{I18N>/ATTACHMENT}">
				<uxap:subSections>
					<uxap:ObjectPageSubSection>
						<uxap:blocks>
                            <!-- File Upload 시작-->
                            <UploadCollection
                                id="UploadCollection"
                                maximumFilenameLength="55"
                                maximumFileSize="10"
                                multiple="true"
                                sameFilenameAllowed="true"
                                instantUpload="false"
                                noDataDescription="Drop files or use the &quot;Add&quot; button to keep files ready for upload"
                                change="onChange"
                                fileDeleted="onFileDeleted"
                                filenameLengthExceed="onFilenameLengthExceed"
                                fileSizeExceed="onFileSizeExceed"
                                typeMissmatch="onTypeMissmatch"
                                uploadComplete="onUploadComplete"
                                beforeUploadStarts="onBeforeUploadStarts" />
                            <!-- File Upload 끝-->
						</uxap:blocks>
					</uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>
            <!-- GAttachment 끝 -->

            <!-- Report Line 시작 -->
			<uxap:ObjectPageSection titleUppercase="false" title="{I18N>/APPROVAL_LINE}">
				<uxap:subSections>
					<uxap:ObjectPageSubSection>
						<uxap:blocks>
                            <!-- Approval & Reference 시작 -->
                            <core:Fragment fragmentName="sp.vi.basePriceMgt.view.ApprovalLine" type="XML" />
                            <!-- <VBox>
                            <Table id="ApprovalTable"
                                    growing="true"
                                    growingThreshold="20"
                                    class="sapFDynamicPageAlignContent"
                                    mode="None"
                                    width="auto"
                                    items="{appdetailModel>/undefined}"
                                    >
                                <headerToolbar>
                                    <OverflowToolbar>
                                    <Label text="{I18N>/APPROVAL_LINE}"/>
                                    </OverflowToolbar>
                                </headerToolbar>
                                <columns>
                                    <Column minScreenWidth="Tablet" hAlign="Center" mergeDuplicates="true" width="3rem" >
                                        <Text text="{I18N>/LINE_NO}" />
                                    </Column>
                                    <Column minScreenWidth="Tablet" hAlign="Center" mergeDuplicates="true" width="6em" >
                                        <Text text="{I18N>/TYPE}" />
                                    </Column>
                                    <Column minScreenWidth="Tablet" hAlign="Center" width="16em" >
                                        <Text text="{I18N>/NAME}/{I18N>/DEPARTMENT}" />
                                    </Column>
                                    <Column minScreenWidth="Tablet" hAlign="Center"  >
                                        <Text text="{I18N>/DESCRIPTION}" />
                                    </Column>
                                    <Column minScreenWidth="Tablet" hAlign="Center" width="6em" >
                                        <Text text="{I18N>/STATUS}" />
                                    </Column>
                                </columns>
                                <items>
                                    <ColumnListItem>
                                        <cells>
                                            <Text text="{appdetailModel>no}" />
                                            <ComboBox  width="100%"
                                                selectedKey="{appdetailModel>type}"
                                                enabled="{appdetailModel>editMode}"
                                                items="{
                                                    path: 'org>/Org_Company',
                                                    filters: [
                                                        {path: 'tenant_id', operator: 'EQ', value1: 'L1100'}
                                                    ],
                                                    sorter: { path: 'company_code'},
                                                    templateShareable:false
                                                }"
                                                >
                                            <core:Item key="{org>company_code}" text="[{org>company_code}] {org>company_name}" />
                                            </ComboBox>
                                            <SearchField enabled="{appdetailModel>editMode}" search=".onSearch" width="100%" placeholder="Search employee" value="{appdetailModel>nameDept}"/>
                                            <Text text="{appdetailModel>status}" />
                                            <Text text="{appdetailModel>comment}" />
                                            <Button icon="{appdetailModel>arrowUp}" press=".onSortUp(${appdetailModel>no})" tooltip="sort" visible="{= ${appdetailModel>arrowUp}===''?false:true }"></Button>
                                            <Button icon="{appdetailModel>arrowDown}" press=".onSortDown(${appdetailModel>no})"  visible="{= ${appdetailModel>arrowDown}===''?false:true }" tooltip="sort"></Button>
                                            <Button icon="sap-icon://delete" press=".setApprovalRemoveRow(${appdetailModel>no})" tooltip="삭제" visible="{appdetailModel>trashShow}"></Button>
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>

                            <Text text="Referrer" />
                            <Input value="{detailModel>/abc}"
                                showValueHelp="true"
                                valueHelpRequest=".onOpenMaterialCode" />
                            </VBox> -->
                            <!-- Approval & Reference 끝 -->
						</uxap:blocks>
					</uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>
            <!-- Report Line 끝 -->
        </uxap:sections>

        <!-- footer 시작 -->
        <uxap:footer>
			<OverflowToolbar visible="{= ${detailModel>/approval_status_code} === '10' ? true : false}">
				<ToolbarSpacer />
                <Button
                    type="Emphasized"
                    text="{I18N>/REQUEST}"
                    visible="true"
                    press=".onSave" />
			</OverflowToolbar>
		</uxap:footer>
        <!-- footer 끝 -->
    </uxap:ObjectPageLayout>
</mvc:View>
