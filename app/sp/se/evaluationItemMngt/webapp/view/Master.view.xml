<mvc:View 
    controllerName="sp.se.evaluationItemMngt.controller.Master"
    xmlns:mvc="sap.ui.core.mvc" 
    xmlns="sap.m" 
    xmlns:f="sap.f" 
    xmlns:form="sap.ui.layout.form"
    xmlns:smartFilterBar="sap.ui.comp.smartfilterbar"
    xmlns:t="sap.ui.table"
    xmlns:layout="sap.ui.layout" 
    xmlns:core="sap.ui.core" 
    height="100%"
    xmlns:lib-f="ext.lib.control.f"
    xmlns:lib-m="ext.lib.control.m"
>
    
    <f:DynamicPage 
        id="page"
        toggleHeaderOnTitleClick="true"
        preserveHeaderStateOnScroll="true"
        headerExpanded="{=
            ${viewModel>/App/layout} === 'OneColumn'
        }"
    >
        
        <f:title>
            <lib-f:CustomDynamicPageTitle>
                <lib-f:heading>
                     <!-- 평가항목 관리 -->
                     <!-- <Toolbar style="Clear">
                         <lib-m:FavoriteMenuButton menuCode="SPSMU00001"/>
                         <Title text="{I18N>/EVAL_ITEM} {I18N>/MANAGEMENT}" />
                     </Toolbar> -->
                     
                    <HBox class="sapUiSizeCompact">
                        <lib-m:FavoriteMenuButton menuCode="SPSMU00001"/>
                        <Title text="{I18N>/EVAL_ITEM} {I18N>/MANAGEMENT}" />
                    </HBox>
                </lib-f:heading>
                <lib-f:actions>
                </lib-f:actions>
                 <lib-f:navigationActions>
                </lib-f:navigationActions>

                <lib-f:fixedContent>
                    <form:SimpleForm 
                        layout="ResponsiveGridLayout">
                        <form:content>
                            <VBox>
                                <!-- 평가항목명 -->
                                <Label text="{I18N>/EVAL_ITEM_NM}" />
                                <Input 
                                    value="{viewModel>/cond/Contains/evaluation_article_name}"
                                />
                                <layoutData>
                                    <layout:GridData span="L3 M6 S10" />
                                </layoutData>
                            </VBox>
                             <VBox>
                                <Label/>
                                <FlexBox alignItems="End" justifyContent="End">
                                <Button id="btnSearch" text="{I18N>/DISPLAY}" type="Emphasized" press="onPressSearch"/>
                                </FlexBox>
                                <layoutData>
                                    <layout:GridData span="L2 M2 S2" indent="L7 M4 S0"/>
                                </layoutData>
                            </VBox>
                        </form:content>
                    </form:SimpleForm>
                </lib-f:fixedContent>
            </lib-f:CustomDynamicPageTitle>
        </f:title>

        <f:header> 
            <f:DynamicPageHeader pinnable="true">
                <form:SimpleForm 
                    layout="ResponsiveGridLayout"
                >
                    <VBox>
                        <!-- 평가조직 -->
                        <Label text="{I18N>/EVAL_ORG}" required="true"/>
                        <ComboBox 
                            id="orgCode" 
                            width="100%" 
                            required="true"
                            fieldGroupIds="searchRequired"
                            showSecondaryValues="true"
                            selectionChange="onSelectionChangeOrgCode"
                            selectedKey="{viewModel>/cond/EQ/org_code}"
                        />
                        <layoutData>
                            <layout:GridData span="L2 M6 S12" />
                        </layoutData>
                    </VBox>
                    <VBox>
                        <!-- 평가운영단위 -->
                        <Label text="{I18N>/EVAL_OP_UNT}" required="true"/>
                        <ComboBox 
                            id="unitCode" 
                            width="100%" 
                            required="true"
                            fieldGroupIds="searchRequired"
                            showSecondaryValues="true"
                            selectionChange="onSelectionChangeUnitCode"
                            selectedKey="{viewModel>/cond/EQ/evaluation_operation_unit_code}"
                        />
                        <layoutData>
                            <layout:GridData span="L2 M6 S12" />
                        </layoutData>
                    </VBox>
                    <VBox>
                        <!-- 평가유형명 -->
                        <Label text="{I18N>/EVALUATION_TYPE_NAME}" required="true"/>
                        <ComboBox 
                            id="evaluType" 
                            width="100%" 
                            required="true"
                            fieldGroupIds="searchRequired"
                            showSecondaryValues="true"
                            selectedKey="{viewModel>/cond/EQ/evaluation_type_code}"
                            selectionChange="onSelectionChangeEvaluTypeCode"
                        />
                        <layoutData>
                            <layout:GridData span="L2 M6 S12" />
                        </layoutData>
                    </VBox>
                    <VBox>
                        <!-- 평가항목구분 -->
                        <Label text="{I18N>/EVAL_ITEM_TYPE}" />
                        <SegmentedButton 
                            id="evaluExecuteMode" 
                            selectedKey="{viewModel>/cond/EQ/evaluation_article_type_code}"
                        />
                        <layoutData>
                            <layout:GridData span="L2 M6 S12"/>
                        </layoutData>
                    </VBox>
                    <!-- <VBox>
                        <Label text="{I18N>/EVAL_ITEM_NM}" />
                        <Input 
                            value="{viewModel>/cond/Contains/evaluation_article_name}"
                            submit="onPressSearch"
                        />
                        <layoutData>
                            <layout:GridData span="L2 M6 S12" />
                        </layoutData>
                    </VBox> -->
                    <!-- <FlexBox alignItems="End" justifyContent="End">
                        <Button id="btnSearch" text="{I18N>/DISPLAY}" type="Emphasized" press="onPressSearch"/>
                        <layoutData>
                            <layout:GridData span="XL12 L12 M12 S12" />
                        </layoutData>
                    </FlexBox> -->
                </form:SimpleForm>
            </f:DynamicPageHeader>
        </f:header>
        <f:content>
            <t:TreeTable 
                id="treeTable"
                minAutoRowCount="10"
                visibleRowCountMode="Auto"
                cellClick="onRowSelectionChange"
                selectionMode="Single"
                rowActionCount="1"
                fixedColumnCount="1"
                rows="{
                    path : 'viewModel>/Tree',
                    parameters : {
                        arrayNames: ['nodes'],
                        numberOfExpandedLevels: 5
                    }
                }"
            >
                <t:extension>
                    <OverflowToolbar>
                        <Title id="title" text="{I18N>/EVAL_ITEM}({=${viewModel>/Tree/list}.length || 0})" level="H2"/> 
                        <ToolbarSeparator/>
                        <ToolbarSpacer/>
                        <Button 
                            text="{I18N>/NEW}" type="Transparent" press="onPressCreate($event, 'NewLevel')" 
                            visible="{=
                                ${viewModel>/App/layout} !== 'TwoColumnsMidExpanded' &amp;&amp;
                                ${viewModel>/Btn/UserEvalType}
                            }"
                        />
                        <Button 
                            text="{I18N>/CREATE_SAME_LEVEL}" type="Transparent" press="onPressCreate($event, 'SameLevel')" 
                            visible="{=${viewModel>/App/layout} !== 'TwoColumnsMidExpanded'}"
                        />
                        <Button 
                            text="{I18N>/CREATE_LOWER_LEVEL}" type="Transparent" press="onPressCreate($event, 'LowLevel')" 
                            visible="{=${viewModel>/App/layout} !== 'TwoColumnsMidExpanded'}"
                        />
                        <MenuButton 
                            icon="sap-icon://create-form"
                            visible="{=${viewModel>/App/layout} === 'TwoColumnsMidExpanded'}"
                        >
                            <menu>
                                <Menu>
                                    <MenuItem 
                                        text="{I18N>/NEW}" press="onPressCreate($event, 'NewLevel')"
                                        visible="{=
                                            !!${viewModel>/Btn/UserEvalType}
                                        }"
                                    />
                                    <MenuItem text="{I18N>/CREATE_SAME_LEVEL}" press="onPressCreate($event, 'SameLevel')"/>
                                    <MenuItem text="{I18N>/CREATE_LOWER_LEVEL}" press="onPressCreate($event, 'LowLevel')"/>
                                </Menu>
                            </menu>
                        </MenuButton>
                        <Button icon="sap-icon://expand-all" tooltip="{I18N>/EXPAND}" type="Transparent" press="onPressExpandAll" />
                        <Button icon="sap-icon://collapse-all" tooltip="{I18N>/COLLAPSE}" type="Transparent" press="onPressCollapseAll" />
                        <Button icon="sap-icon://excel-attachment" tooltip="excel-download" type="Transparent" press="onExcelExport" />
                        <Button icon="sap-icon://action-settings" type="Transparent" press="onMainTablePersoButtonPressed"/>
                    </OverflowToolbar>
                </t:extension>
                <t:rowActionTemplate>
                    <t:RowAction>
                        <t:RowActionItem type="Navigation"/>
                    </t:RowAction>
                </t:rowActionTemplate>
                <t:columns>
                    <!-- 평가항목 -->
                    <t:Column label="{I18N>/EVAL_ITEM}" name="" width="20em">    
                        <t:template>
                            <Text text="{viewModel>evaluation_article_name}" tooltip="{viewModel>evaluation_article_name}" wrapping="false" />
                        </t:template>
                        <t:customData>
                            <core:CustomData key="property" value="evaluation_article_name"/>
                        </t:customData>
                    </t:Column>
                    <!-- 평가운영단위 -->
                    <t:Column label="{I18N>/EVAL_OP_UNT}" name="" width="7em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>evaluation_operation_unit_name}" tooltip="{viewModel>evaluation_operation_unit_name}" wrapping="false" />
                        </t:template>
                        <t:customData>
                            <core:CustomData key="property" value="evaluation_operation_unit_name"/>
                        </t:customData>
                    </t:Column>
                    <!-- 평가유형명 -->
                    <t:Column label="{I18N>/EVALUATION_TYPE_NAME}" name="" width="7em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>evaluation_type_name}" tooltip="{viewModel>evaluation_type_name}" wrapping="false" />
                        </t:template>
                        <t:customData>
                            <core:CustomData key="property" value="evaluation_type_name"/>
                        </t:customData>
                    </t:Column>
                    <!-- 평가수행방식 -->
                    <t:Column label="{I18N>/EVAL_EXEC_MODE}" name="" width="7em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>evaluation_execute_mode_name}" tooltip="{viewModel>evaluation_execute_mode_name}" wrapping="false" />
                        </t:template>
                        <t:customData>
                            <core:CustomData key="property" value="evaluation_execute_mode_name"/>
                        </t:customData>
                    </t:Column>
                    <!-- 평가항목구분-->
                    <t:Column label="{I18N>/EVAL_ITEM_TYPE}" name="" width="7em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>evaluation_article_type_name}" tooltip="{viewModel>evaluation_article_type_name}" wrapping="false" />
                        </t:template>
                        <t:customData>
                            <core:CustomData key="property" value="evaluation_article_type_name"/>
                        </t:customData>
                    </t:Column>
                    <!-- 배점유형 -->
                    <t:Column label="{I18N>/DISTRB_SCOR_TYPE}" name="" width="7em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>evaluation_distrb_scr_type_name}" tooltip="{viewModel>evaluation_distrb_scr_type_name}" wrapping="false" />
                        </t:template>
                        <t:customData>
                            <core:CustomData key="property" value="evaluation_distrb_scr_type_name"/>
                        </t:customData>
                    </t:Column>
                    <!-- Scale유형 -->
                    <t:Column label="{I18N>/SCLE_TYPE}" name="" width="7em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>evaluation_result_input_type_name}" tooltip="{viewModel>evaluation_result_input_type_name}" wrapping="false" />
                        </t:template>
                        <t:customData>
                            <core:CustomData key="property" value="evaluation_result_input_type_name"/>
                        </t:customData>
                    </t:Column>
                    <!-- 평가항목설명 -->
                    <t:Column label="{I18N>/EVAL_ITEM_DESC}" name="" width="20em">    
                        <t:template>
                            <Text text="{viewModel>evaluation_article_desc}" tooltip="{viewModel>evaluation_article_desc}" wrapping="false" />
                        </t:template>
                        <t:customData>
                            <core:CustomData key="property" value="evaluation_article_desc"/>
                        </t:customData>
                    </t:Column>
                    <!-- 정렬 -->
                    <t:Column name="" width="5em" hAlign="End">    
                        <Label text="{I18N>/SORT}" width="100%" textAlign="Center"/>
                        <t:template>
                            <Text text="{
                                path:'viewModel>sort_sequence',
                                type:'sap.ui.model.odata.type.Decimal'
                            }" tooltip="{viewModel>sort_sequence}" wrapping="false" />
                        </t:template>
                        <t:customData>
                            <core:CustomData key="property" value="sort_sequence"/>
                            <core:CustomData key="type" value="number"/>
                            <core:CustomData key="textAlign" value="End"/>
                        </t:customData>
                    </t:Column>
                    <!-- 작성자 -->
                    <t:Column label="{I18N>/WRITER}" name="" width="8em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>writer}" tooltip="{viewModel>writer}" wrapping="false" />
                        </t:template>
                        <t:customData>
                            <core:CustomData key="property" value="writer"/>
                        </t:customData>
                    </t:Column>
                    <!-- 작성일자 -->
                    <t:Column label="{I18N>/WRITE_DATE}" width="8em" hAlign="Center">    
                        <t:template>
                            <Text text="{
                                path:'viewModel>write_tm',
                                type:'sap.ui.model.odata.type.DateTime',
                                constraints : {
                                    displayFormat: 'Date'
                                }
                            }" tooltip="{
                                path:'viewModel>write_tm',
                                type:'sap.ui.model.odata.type.DateTime',
                                constraints : {
                                    displayFormat: 'Date'
                                }
                            }" wrapping="false" />
                        </t:template>
                        <t:customData>
                            <core:CustomData key="property" value="write_tm"/>
                            <core:CustomData key="type" value="date"/>
                        </t:customData>
                    </t:Column>


                    <!-- <t:Column id="colNone" label="" width="2rem" >
                        <t:template>
                            <ObjectStatus icon="sap-icon://feeder-arrow"   />
                        </t:template>
                    </t:Column> -->
                </t:columns>
            </t:TreeTable>
        </f:content>
        
        
        <!-- <f:footer>
            <OverflowToolbar>
                <ToolbarSpacer />
				<Button text="Save" type="Emphasized" press=".onPageSaveButtonPress" />
				<Button text="Cancel" type="Transparent" press=".onPageCancelEditButtonPress"/>
            </OverflowToolbar>
        </f:footer> -->
    </f:DynamicPage>
    
</mvc:View>