<mvc:View 
    controllerName="sp.se.evaluationItemMngt.controller.Master"
    xmlns:mvc="sap.ui.core.mvc" 
    xmlns="sap.m" 
    xmlns:f="sap.f" 
    xmlns:form="sap.ui.layout.form"
    xmlns:smartFilterBar="sap.ui.comp.smartfilterbar"
    xmlns:t="sap.ui.table"
    xmlns:layout="sap.ui.layout" 
    xmlns:core="sap.ui.core" 
    height="100%"
>
    
    <f:DynamicPage 
        id="page"
        toggleHeaderOnTitleClick="true"
    >
        <!-- headerExpanded="{=
            ${viewModel>/App/layout} !== 'TwoColumnsMidExpanded'
        }" -->
        
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                     <!-- 평가항목 관리 -->
                    <Title text="{I18N>/EVAL_ITEM} {I18N>/DISPLAY}" />
                </f:heading>

                <!-- <f:expandedHeading> -->
                     <!-- 평가항목 관리 -->
                    <!-- <Title text="{I18N>/EVAL_ITEM} {I18N>/DISPLAY}" /> -->
                <!-- </f:expandedHeading> -->
                <f:expandedContent>
                </f:expandedContent>

                <!-- <f:snappedHeading> -->
                     <!-- 평가항목 관리 -->
                    <!-- <Title text="{I18N>/EVAL_ITEM} {I18N>/DISPLAY}" /> -->
                <!-- </f:snappedHeading> -->
                <f:snappedContent>
                    <!-- <form:SimpleForm 
                        layout="ResponsiveGridLayout"
                    > -->
                        <VBox>
                            <!-- 평가항목명 -->
                            <Label text="{I18N>/EVAL_ITEM_NM}" />
                            <Input 
                                value="{viewModel>/cond/Contains/evaluation_article_name}"
                            />
                            <!-- <layoutData>
                                <layout:GridData span="L2 M6 S12" />
                            </layoutData> -->
                        </VBox>
                    <!-- </form:SimpleForm> -->
                </f:snappedContent>
                
                <f:actions>
                    <!-- 조회 -->
                    <Button text="{I18N>/DISPLAY}" type="Emphasized" press="onPressSearch"/>
                </f:actions>
            </f:DynamicPageTitle>
        </f:title>

        <f:header> 
            <f:DynamicPageHeader pinnable="true">
                <form:SimpleForm 
                    layout="ResponsiveGridLayout"
                >
                    <VBox>
                        <!-- 평가조직 -->
                        <Label text="{I18N>/EVAL_ORG}" required="true"/>
                        <ComboBox 
                            id="orgCode" 
                            width="100%" 
                            required="true"
                            fieldGroupIds="searchRequired"
                            showSecondaryValues="true"
                            selectionChange="onSelectionChangeOrgCode"
                            selectedKey="{viewModel>/cond/EQ/org_code}"
                        />
                        <layoutData>
                            <layout:GridData span="L2 M6 S12" />
                        </layoutData>
                    </VBox>
                    <VBox>
                        <!-- 평가운영단위 -->
                        <Label text="{I18N>/EVAL_OP_UNT}" required="true"/>
                        <ComboBox 
                            id="unitCode" 
                            width="100%" 
                            required="true"
                            fieldGroupIds="searchRequired"
                            showSecondaryValues="true"
                            selectionChange="onSelectionChangeUnitCode"
                            selectedKey="{viewModel>/cond/EQ/evaluation_operation_unit_code}"
                        />
                        <layoutData>
                            <layout:GridData span="L2 M6 S12" />
                        </layoutData>
                    </VBox>
                    <VBox>
                        <!-- 평가유형명 -->
                        <Label text="{I18N>/EVALUATION_TYPE_NAME}" required="true"/>
                        <SegmentedButton 
                            id="evaluType" 
                            selectedKey="{viewModel>/cond/EQ/evaluation_type_code}"
                        />
                        <layoutData>
                            <layout:GridData span="L8 M6 S12" />
                        </layoutData>
                    </VBox>
                    <VBox>
                        <!-- 평가항목구분 -->
                        <Label text="{I18N>/EVAL_ITEM_TYPE}" />
                        <SegmentedButton 
                            id="evaluExecuteMode" 
                            selectedKey="{viewModel>/cond/EQ/evaluation_article_type_code}"
                        />
                        <layoutData>
                            <layout:GridData span="L2 M6 S12" linebreak="true"/>
                        </layoutData>
                    </VBox>
                    <VBox>
                        <!-- 평가항목명 -->
                        <Label text="{I18N>/EVAL_ITEM_NM}" />
                        <Input 
                            value="{viewModel>/cond/Contains/evaluation_article_name}"
                        />
                        <layoutData>
                            <layout:GridData span="L2 M6 S12" />
                        </layoutData>
                    </VBox>
                </form:SimpleForm>
            </f:DynamicPageHeader>
        </f:header>
        <f:content>
            <t:TreeTable 
                id="treeTable"
                enableSelectAll="false"
                visibleRowCount="{=
                    ${viewModel>/App/layout} !== 'TwoColumnsMidExpanded' ? 13 : 16
                }"
                enableColumnReordering="false"
                class="sapFDynamicPageAlignContent" 
                rowSelectionChange="onRowSelectionChange"
                selectionMode="Single"
                selectionBehavior="Row"
                fixedColumnCount="1"
                expandFirstLevel="true"
                rows="{
                    path : 'viewModel>/Tree',
                    parameters : {
                        arrayNames: ['nodes'],
                        numberOfExpandedLevels: 5
                    }
                }"
            >
                <t:extension>
                    <OverflowToolbar>
                        <Title id="title" text="{I18N>/EVAL_ITEM}({=${viewModel>/Tree/list}.length || 0})" level="H2"/> 
                        <ToolbarSeparator/>
                        <ToolbarSpacer/>
                        <Button 
                            text="{I18N>/CREATE_SAME_LEVEL}" type="Transparent" press="onPressCreate($event, 'SameLevel')" 
                            visible="{=${viewModel>/App/layout} !== 'TwoColumnsMidExpanded'}"
                        />
                        <Button 
                            text="{I18N>/CREATE_LOWER_LEVEL}" type="Transparent" press="onPressCreate($event, 'LowLevel')" 
                            visible="{=${viewModel>/App/layout} !== 'TwoColumnsMidExpanded'}"
                        />
                        <MenuButton 
                            icon="sap-icon://create-form"
                            visible="{=${viewModel>/App/layout} === 'TwoColumnsMidExpanded'}"
                        >
                            <menu>
                                <Menu>
                                    <MenuItem text="{I18N>/CREATE_SAME_LEVEL}" press="onPressCreate($event, 'SameLevel')"/>
                                    <MenuItem text="{I18N>/CREATE_LOWER_LEVEL}" press="onPressCreate($event, 'LowLevel')"/>
                                </Menu>
                            </menu>
                        </MenuButton>
                        <Button icon="sap-icon://expand-all" tooltip="{I18N>/EXPAND}" type="Transparent" press="onPressExpandAll" />
                        <Button icon="sap-icon://collapse-all" tooltip="{I18N>/COLLAPSE}" type="Transparent" press="onPressCollapseAll" />
                        <Button icon="sap-icon://excel-attachment" type="Transparent" press="onExcelExport" />
                        <Button icon="sap-icon://action-settings" type="Transparent" press="onMainTablePersoButtonPressed"/>
                    </OverflowToolbar>
                </t:extension>
                
                <t:columns>
                    <!-- 평가항목 -->
                    <t:Column label="{I18N>/EVAL_ITEM}" name="evaluation_article_name" width="20em">    
                        <t:template>
                            <Text text="{viewModel>evaluation_article_name}" tooltip="{viewModel>evaluation_article_name}" wrapping="false" />
                        </t:template>
                    </t:Column>
                    <!-- 평가운영단위 -->
                    <t:Column label="{I18N>/EVAL_OP_UNT}" name="evaluation_operation_unit_name" width="7em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>evaluation_operation_unit_name}" tooltip="{viewModel>evaluation_operation_unit_name}" wrapping="false" />
                        </t:template>
                    </t:Column>
                    <!-- 평가유형명 -->
                    <t:Column label="{I18N>/EVALUATION_TYPE_NAME}" name="evaluation_type_name" width="7em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>evaluation_type_name}" tooltip="{viewModel>evaluation_type_name}" wrapping="false" />
                        </t:template>
                    </t:Column>
                    <!-- 평가수행방식 -->
                    <t:Column label="{I18N>/EVAL_EXEC_MODE}" name="evaluation_execute_mode_name" width="7em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>evaluation_execute_mode_name}" tooltip="{viewModel>evaluation_execute_mode_name}" wrapping="false" />
                        </t:template>
                    </t:Column>
                    <!-- 평가항목구분-->
                    <t:Column label="{I18N>/EVAL_ITEM_TYPE}" name="evaluation_article_type_name" width="7em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>evaluation_article_type_name}" tooltip="{viewModel>evaluation_article_type_name}" wrapping="false" />
                        </t:template>
                    </t:Column>
                    <!-- 배점유형 -->
                    <t:Column label="{I18N>/DISTRB_SCOR_TYPE}" name="evaluation_distrb_scr_type_name" width="7em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>evaluation_distrb_scr_type_name}" tooltip="{viewModel>evaluation_distrb_scr_type_name}" wrapping="false" />
                        </t:template>
                    </t:Column>
                    <!-- Scale유형 -->
                    <t:Column label="{I18N>/SCLE_TYPE}" name="evaluation_result_input_type_name" width="7em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>evaluation_result_input_type_name}" tooltip="{viewModel>evaluation_result_input_type_name}" wrapping="false" />
                        </t:template>
                    </t:Column>
                    <!-- 평가항목설명 -->
                    <t:Column label="{I18N>/EVAL_ITEM_DESC}" name="evaluation_article_desc" width="20em">    
                        <t:template>
                            <Text text="{viewModel>evaluation_article_desc}" tooltip="{viewModel>evaluation_article_desc}" wrapping="false" />
                        </t:template>
                    </t:Column>
                    <!-- 정렬 -->
                    <t:Column label="{I18N>/SORT}" name="sort_sequence" width="5em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>sort_sequence}" tooltip="{viewModel>sort_sequence}" wrapping="false" />
                        </t:template>
                    </t:Column>
                    <!-- 작성자 -->
                    <t:Column label="{I18N>/WRITER}" name="writer" width="8em" hAlign="Center">    
                        <t:template>
                            <Text text="{viewModel>writer}" tooltip="{viewModel>writer}" wrapping="false" />
                        </t:template>
                    </t:Column>
                    <!-- 작성일자 -->
                    <t:Column label="{I18N>/WRITE_DATE}" name="write_tm" width="8em" hAlign="Center">    
                        <t:template>
                            <Text text="{
                                path:'viewModel>write_tm',
                                type:'sap.ui.model.odata.type.DateTime',
                                constraints : {
                                    displayFormat: 'Date'
                                }
                            }" tooltip="{
                                path:'viewModel>write_tm',
                                type:'sap.ui.model.odata.type.DateTime',
                                constraints : {
                                    displayFormat: 'Date'
                                }
                            }" wrapping="false" />
                        </t:template>
                        <t:customData>
                            <core:CustomData key="type" value="date"/>
                        </t:customData>
                    </t:Column>


                    <!-- <t:Column id="colNone" label="" width="2rem" >
                        <t:template>
                            <ObjectStatus icon="sap-icon://feeder-arrow"   />
                        </t:template>
                    </t:Column> -->
                </t:columns>
            </t:TreeTable>
        </f:content>
        
        
        <!-- <f:footer>
            <OverflowToolbar>
                <ToolbarSpacer />
				<Button text="Save" type="Emphasized" press=".onPageSaveButtonPress" />
				<Button text="Cancel" type="Transparent" press=".onPageCancelEditButtonPress"/>
            </OverflowToolbar>
        </f:footer> -->
    </f:DynamicPage>
    
</mvc:View>