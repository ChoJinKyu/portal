<mvc:View controllerName="sp.np.npMst.controller.MainList" 
    xmlns:mvc="sap.ui.core.mvc" 
    xmlns="sap.m" 
    xmlns:f="sap.f" 
    xmlns:form="sap.ui.layout.form" 
    xmlns:layout="sap.ui.layout" 
    xmlns:core="sap.ui.core" 
    xmlns:table="sap.ui.table"
    xmlns:lib-m="ext.lib.control.m"
    xmlns:pg-m="ext.pg.util.control.m"
    height="100%">
    <App id="app">
        <f:DynamicPage id="page"
            headerExpanded="{mainListView>/headerExpanded}" 
            toggleHeaderOnTitleClick="true">
            <!-- DynamicPage Title -->
            <f:title>
                <f:DynamicPageTitle>
                    <f:heading>
                        <Title text="{i18n>appTitle}" />
                    </f:heading>
                    <f:snappedContent>
                        <form:SimpleForm id="pageSearchFormS" maxContainerCols="3" editable="true" layout="ResponsiveGridLayout" adjustLabelSpan="false" labelSpanL="4" labelSpanM="4" emptySpanL="0" emptySpanM="0" columnsL="2" columnsM="2">
                            <form:content>
                                <VBox>
                                    <Label text="Company Name" labelFor="search_company_s" required="true"></Label>     
                                    <MultiComboBox id="search_company_s" width="100%" required="true" 
                                        items="{
                                                    path: 'org>/Org_Company',
                                                    filters: [
                                                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'}
                                                    ]
                                                }" selectionFinish="handleSelectionFinishComp">
                                        <items>
                                            <core:Item key="{org>company_code}" text="[{org>company_code}] {org>company_name}" />
                                        </items>
                                    </MultiComboBox>
                                    <layoutData><layout:GridData span="XL2 L2 M2 S12"/></layoutData>
                                </VBox>
                                <VBox>
                                    <Label text="Operation ORG" labelFor="search_operation_org_s" required="true"></Label>
                                    <MultiComboBox id="search_operation_org_s" width="100%" required="true"
                                            items="{
                                                path: 'purOrg>/Pur_Operation_Org',
                                                filters: [
                                                    {path: 'tenant_id', operator: 'EQ', value1: 'L2100'}
                                                ]
                                            }">
                                        <items>
                                            <core:Item key="{purOrg>code}" text="[{purOrg>code}] {purOrg>type}" />
                                        </items>
                                    </MultiComboBox>
                                    <layoutData><layout:GridData span="XL2 L2 M2 S12"/></layoutData>                                   
                                </VBox>
                                <VBox>
                                    <Label text="Status" labelFor="status" required="true"></Label>
                                    <SegmentedButton id="status_s" selectionChange="onStatusChange">
                                        <items>
                                            <SegmentedButtonItem key="all" text="All" />
                                            <SegmentedButtonItem key="effPrc" text="유효단가" />
                                            <SegmentedButtonItem key="expPrc" text="만료단가" />
                                        </items>
                                    </SegmentedButton>
                                    <layoutData>
                                        <layout:GridData span="XL2 L2 M2 S12"/>                                        
                                    </layoutData>
                                </VBox>
                            </form:content>
                        </form:SimpleForm>
                    </f:snappedContent>
                    <f:expandedContent>
                        <form:SimpleForm id="pageSearchFormE" maxContainerCols="2" editable="true" layout="ResponsiveGridLayout" adjustLabelSpan="false" labelSpanL="4" labelSpanM="4" emptySpanL="0" emptySpanM="0" columnsL="2" columnsM="2">
                            <form:content>
                                <VBox>
                                    <Label text="Company" labelFor="search_company_e" required="true"></Label>
                                    <MultiComboBox id="search_company_e" width="100%" required="true" 
                                        items="{
                                                    path: 'org>/Org_Company',
                                                    filters: [
                                                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'}
                                                    ]
                                                }" selectionFinish="handleSelectionFinishComp">
                                        <items>
                                            <core:Item key="{org>company_code}" text="[{org>company_code}] {org>company_name}" />
                                        </items>
                                    </MultiComboBox>
                                    <layoutData><layout:GridData span="XL2 L2 M2 S12"/></layoutData>
                                </VBox>
                                <VBox>
                                    <Label text="Operation ORG" labelFor="search_operation_org_e" required="true"></Label>
                                    <MultiComboBox id="search_operation_org_e" width="100%" required="true"
                                            items="{
                                                path: 'purOrg>/Pur_Operation_Org',
                                                filters: [
                                                    {path: 'tenant_id', operator: 'EQ', value1: 'L2100'}
                                                ]
                                            }" selectionFinish="handleSelectionFinishOrg">
                                        <items>
                                            <core:Item key="{purOrg>code}" text="[{purOrg>code}] {purOrg>type}" />
                                        </items>
                                    </MultiComboBox>
                                    <layoutData><layout:GridData span="XL2 L2 M2 S12"/></layoutData>
                                </VBox>
                                <VBox>
                                    <Label text="Status" labelFor="status_e" required="true"></Label>
                                    <SegmentedButton id="status_e" selectionChange="onStatusChange">
                                        <items>
                                            <SegmentedButtonItem key="all" text="All" />
                                            <SegmentedButtonItem key="effPrc" text="유효단가" />
                                            <SegmentedButtonItem key="expPrc" text="만료단가" />
                                        </items>
                                    </SegmentedButton>
                                    <layoutData><layout:GridData span="XL2 L2 M2 S12"/></layoutData>
                                </VBox>
                            </form:content>
                        </form:SimpleForm>
                    </f:expandedContent>
                    <f:actions>
                        <Button id="pageSearchButton" text="Search" type="Emphasized" press=".fnSearch" />
                    </f:actions>
                    <f:navigationActions>
                        <Button icon="sap-icon://unfavorite" type="Transparent" />
                    </f:navigationActions>
                </f:DynamicPageTitle>
            </f:title>
            <!-- DynamicPage Header -->
            <f:header>
                <f:DynamicPageHeader pinnable="true">
                    <form:SimpleForm id="pageSearchForm" maxContainerCols="2" editable="true" layout="ResponsiveGridLayout" adjustLabelSpan="false" labelSpanL="4" labelSpanM="4" emptySpanL="0" emptySpanM="0" columnsL="2" columnsM="2">
                        <form:content>
                            <VBox>
                                <Label text="Supplier" labelFor="search_supplier_code"></Label>
                                <Input id="search_supplier_code" type="Text" showValueHelp="true" valueHelpRequest=".vhSupplierCode" />
                                <layoutData><layout:GridData span="XL2 L2 M2 S12"/></layoutData>
                            </VBox>
                            <VBox>
                                <Label text="Material" labelFor="search_material_code"></Label>
                                <Input id="search_material_code" type="Text" value="" placeholder="" showValueHelp="true" valueHelpRequest=".vhMatrialCode"/>
                                <layoutData><layout:GridData span="XL1 L1 M1 S12"/></layoutData>
                            </VBox>
                            <VBox>
                                <Label text="Document Type" labelFor="search_document"></Label>
                                <ComboBox id="search_document" width="100%"
                                    items="{
                                        path: 'util>/Code',
                                        filters: [
                                            {path: 'group_code', operator: 'EQ', value1: 'SP_DOCUMENT_TYPE'}
                                        ]
                                    }" selectionFinish="handleSelectionFinishComp">
                                    <items>
                                        <core:Item key="{util>code}" text="{util>code_name}" />
                                    </items>
                                    <layoutData>
                                        <layout:GridData span="XL2 L2 M3 S12" />
                                    </layoutData>
                                </ComboBox>
                                <layoutData><layout:GridData span="XL1 L1 M1 S12"/></layoutData>
                            </VBox>
                            <VBox>
                                <Label text="Net Price Type" labelFor="search_net_price_type"></Label>
                                <ComboBox id="search_net_price_type" width="100%"
                                    items="{
                                        path: 'util>/Code',
                                        filters: [
                                            {path: 'group_code', operator: 'EQ', value1: 'SP_NET_PRICE_TYPE'}
                                        ]
                                    }" selectionFinish="handleSelectionFinishOrg">
                                    <items>
                                        <core:Item key="{util>code}" text="{util>code_name}" />
                                    </items>
                                    <layoutData>
                                        <layout:GridData span="XL2 L2 M3 S12" />
                                    </layoutData>
                                </ComboBox>
                                <layoutData><layout:GridData span="XL1 L1 M1 S12"/></layoutData>
                            </VBox>
                            <VBox>
                                <Label text="Effective Start Date" labelFor="search_effective_start_date"></Label>
                                <DateRangeSelection id="search_effective_start_date" width="100%" change="handleChange"/>
                                <layoutData><layout:GridData span="XL2 L2 M2 S12"/></layoutData>
                            </VBox>
                            <VBox>
                                <Label text="Effective End Date" labelFor="search_effective_end_date"></Label>
                                <DatePicker id="search_effective_end_date" displayFormat="yyyy.MM.dd" valueFormat="yyyy.MM.dd" editable="true" navigate="onclickDate" value="9999-12-31"/>
                                <layoutData><layout:GridData span="XL1 L1 M1 S12"/></layoutData>
                            </VBox>
                            <!-- <VBox>
                                <Input id="test" type="Text" liveChange=".chkReplaceChange" />
                                <MultiInput id="testVendorpoll" type="Text" showValueHelp="true" valueHelpOnly="true" valueHelpRequest=".vhVendorPoolCode" />
                                <pg-m:CodePicker id="search_supplier_code"
                                    placeholder="Enter a Supplier name"
                                    keyField="supplier_code"
                                    textField="supplier_local_name"
                                    startSuggestion="3"
                                    suggestionItems="{
                                        path: '/',
                                        filters : [
                                            {path : 'tenant_id', operator : 'EQ', value1 : 'L2100'},
                                            {path : 'language_cd', operator : 'EQ', value1 : 'KO'}
                                        ],
                                        serviceUrl: 'srv-api/odata/v2/pg.vendorPoolMappingService/',
                                        entityName: 'VpSupplierDtlView'
                                    }" value="">
                                    <pg-m:SupplierValueHelp contentWidth="800px" title="Choose a supplier"
                                        keyFieldHeaderText="Supplier ID" textFieldHeaderText="Supplier" />
                                </pg-m:CodePicker>
                            </VBox>
                            <VBox>
                                <MultiInput id="testSupplier" type="Text" showValueHelp="true" valueHelpOnly="true" valueHelpRequest=".vhSupplierCode" />
                            </VBox> -->
                        </form:content>
                    </form:SimpleForm>
                </f:DynamicPageHeader>
            </f:header>
            <f:content>
                <table:Table
                    id="mainTable"
                    selectionMode="MultiToggle"
                    fixedColumnCount="7"
                    rows="{path: 'list>/SpNetpriceView'}"
                    cellClick=".onCellClick"
                    rowSelectionChange=".onCheck">
                        <table:extension>
                            <OverflowToolbar>
                                <Title text="List ({= ${list>/SpNetpriceView}.length || 0})" level="H2"/>
                                <ToolbarSpacer/>
                                <ToolbarSeparator/>
                                <Button icon="sap-icon://action-settings" press=".onMoldMstTablePersoButtonPressed" >
                                    <layoutData>
                                        <OverflowToolbarLayoutData priority="NeverOverflow" />
                                    </layoutData>
                                </Button>
                            </OverflowToolbar>
                    </table:extension> 
                    <table:columns>
                        <table:Column label="Operation Org Code" width="8rem" filterProperty="org_code" hAlign="Center">
                            <table:template>
                                <Text text="{list>org_code}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Operation Org Name" width="8rem" filterProperty="org_name" hAlign="Center">
                            <table:template>
                                <Text text="{list>org_name}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Doc Type" width="8rem" filterProperty="net_price_document_type_name" hAlign="Center">
                            <table:template>
                                <Text text="{list>net_price_document_type_name}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Source" width="8rem" filterProperty="net_price_source_name" hAlign="Center">
                            <table:template>
                                <Text text="{list>net_price_source_name}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Supplier Code" width="8rem" filterProperty="supplier_code" hAlign="Center">
                            <table:template>
                                <Text text="{list>supplier_code}"/>
                            </table:template>
                        </table:Column>
                        <table:Column label="Supplier Name" width="8rem" filterProperty="supplier_name" hAlign="Center">
                            <table:template>
                                <Text text="{list>supplier_name}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Material Code" width="8rem" filterProperty="material_code" hAlign="Center">
                            <table:template>
                                <Text text="{list>material_code}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Description" width="12rem" filterProperty="material_desc" hAlign="Center">
                            <table:template>
                                <Text text="{list>material_desc}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Market" width="8rem" filterProperty="market_name" hAlign="Center">
                            <table:template>
                                <Text text="{list>market_name}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="UOM" width="5rem" filterProperty="uom_code" hAlign="Center">
                            <table:template>
                                <Text text="{list>uom_code}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column width="5rem">
                            <Label text="QTY" width="100%" textAlign="Center"/>
                            <table:template>
                                <Text text="{path: 'list>purchasing_quantity', type: 'sap.ui.model.type.Integer'}" width="100%" textAlign="Right"/>
                            </table:template>
                        </table:Column>
                        <table:Column label="Currency" width="5rem" filterProperty="currency_code" hAlign="Center">
                            <table:template>
                                <Text text="{list>currency_code}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Net Price" width="7rem" filterProperty="net_price" hAlign="Center">
                            <table:template>
                                <Text text="{path: 'list>net_price', formatter: '.numberFormatter.toNumberString'}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column width="5rem" filterProperty="material_price_unit">
                            <Label text="Price Unit" width="100%" textAlign="Center"/>
                            <table:template>
                                <Text text="{path: 'list>material_price_unit', type: 'sap.ui.model.type.Integer'}" wrapping="false"  width="100%" textAlign="Right"/>
                            </table:template>
                        </table:Column>
                        <table:Column label="Conversion Price" width="5rem" filterProperty="conversion_net_price" hAlign="Center">
                            <table:template>
                                <Text text="{list>conversion_net_price}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Amount" width="5rem" filterProperty="purchasing_amount" hAlign="Center">
                            <table:template>
                                <Text text="{path: 'list>purchasing_amount', formatter: '.numberFormatter.toNumberString'}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Line Type" width="5rem" filterProperty="line_type_code" hAlign="Center">
                            <table:template>
                                <Text text="{list>line_type_code}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Net Price Type" width="8rem" filterProperty="x3" hAlign="Center">
                            <table:template>
                                <Text text="{list>net_price_type_name}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Sample Flag" width="8rem" filterProperty="x4" hAlign="Center">
                            <table:template>
                                <Text text="{list>x4}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Effective Start Date" width="8rem" filterProperty="effective_start_date" hAlign="Center">
                            <table:template>
                                <Text text="{path: 'list>effective_start_date', formatter: '.cvtStringToDate'}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Effective End Date" width="8rem" filterProperty="effective_end_date" hAlign="Center">
                            <table:template>
                                <Text text="{list>}" wrapping="false" />
                                <Text text="{path: 'list>effective_end_date', formatter: '.cvtStringToDate'}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Payment Terms" width="8rem" filterProperty="payterms_name" hAlign="Center">
                            <table:template>
                                <Text text="{list>payterms_name}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Incoterms" width="8rem" filterProperty="incoterms" hAlign="Center">
                            <table:template>
                                <Text text="{list>incoterms}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Tax" width="8rem" filterProperty="tax_code" hAlign="Center">
                            <table:template>
                                <Text text="{list>tax_code}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Customs Rate" width="8rem" filterProperty="customs_rate" hAlign="Center">
                            <table:template>
                                <Text text="{list>customs_rate}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Origin" width="8rem" filterProperty="origin_code" hAlign="Center">
                            <table:template>
                                <Text text="{list>origin_code}:{list>origin_name}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="ERP Net Price No" width="8rem" filterProperty="erp_pur_netprice_number" hAlign="Center">
                            <table:template>
                                <Text text="{list>erp_pur_netprice_number}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="ERP Net Detail No" width="8rem" filterProperty="erp_pur_netprice_item_no" hAlign="Center">
                            <table:template>
                                <Text text="{list>erp_pur_netprice_item_no}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Creator" width="8rem" filterProperty="create_user_id" hAlign="Center">
                            <table:template>
                                <Text text="{list>create_user_id}" wrapping="false" />
                            </table:template>
                        </table:Column>
                        <table:Column label="Creation Date" width="10rem" filterProperty="system_create_dtm" hAlign="Center">
                            <table:template>
                                <Text text="{path: 'list>system_create_dtm', formatter: '.dateFormatter.toDateTimeString'}" wrapping="false" />
                            </table:template>
                        </table:Column>
                    </table:columns>
                </table:Table>                
            </f:content>
            <!-- DynamicPage Footer -->
            <f:footer>
                <OverflowToolbar>
                    <ToolbarSpacer />
                    <Button type="Accept" text="Accept"/>
                    <Button type="Reject" text="Reject"/>
                </OverflowToolbar>
            </f:footer>
        </f:DynamicPage>
    </App>
</mvc:View>
