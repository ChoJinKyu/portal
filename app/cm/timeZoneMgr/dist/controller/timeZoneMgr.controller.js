sap.ui.define(["ext/lib/controller/BaseController","sap/ui/model/json/JSONModel","ext/lib/model/ManagedListModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageToast","sap/m/MessageBox","sap/ui/table/TablePersoController","./timeZonePersoService"],function(e,t,n,i,o,s,a,r,c){"use strict";return e.extend("cm.timeZoneMgr.controller.timeZoneMgr",{onInit:function(){this.getView().setModel(new n,"list");this._oTPC=new r({customDataKey:"timeZoneMgr",persoService:c}).setTable(this.byId("mainTable"))},onMainTablePersoButtonPressed:function(e){this._oTPC.openDialog()},onAfterRendering:function(){this.onSearch()},onSearch:function(){var e=[];if(!!this.byId("searchTenantCombo").getSelectedKey())e.push(new i("tenant_id",o.Contains,this.byId("searchTenantCombo").getSelectedKey()));if(!!this.byId("searchTimeZoneInput").getValue()){e.push(new i({filters:[new i("timezone_code",o.Contains,this.byId("searchTimeZoneInput").getValue()),new i("timezone_name",o.Contains,this.byId("searchTimeZoneInput").getValue())],and:false}))}if(!!this.byId("searchCountryCombo").getSelectedKey())e.push(new i("country_code",o.Contains,this.byId("searchCountryCombo").getSelectedKey()));this.getView().setBusy(true).getModel("list").setTransactionModel(this.getView().getModel()).read("/TimeZone",{filters:e,success:function(e){this.getView().setBusy(false)}.bind(this)})},onDelete:function(){var[e,t]=arguments;var n=this.byId(e);var i=this.getView().getModel(t);n.getSelectedIndices().reverse().forEach(function(e){i.markRemoved(e)});n.clearSelection().removeSelections(true)},onAdd:function(){var[e,t,n,i]=arguments;var o=this.getView().getModel(t);o.addRecord(i.reduce(function(e,t){e[t]=(this||{})[0][t]||"";return e}.bind(typeof n=="string"&&!!n?o.getData()[n]:o.getData()),{local_create_dtm:new Date,local_update_dtm:new Date}),0)},onSave:function(){var[e,t]=arguments;var n=this.getView();var i=n.getModel(t);if(i.getChanges()<=0){a.alert("변경사항이 없습니다.");return}a.confirm("Are you sure ?",{title:"Comfirmation",initialFocus:sap.m.MessageBox.Action.CANCEL,onClose:function(e){if(e===a.Action.OK){n.setBusy(true);i.submitChanges({success:function(e){n.setBusy(false);s.show("Success to save.");this.onSearch()}.bind(this)})}}.bind(this)})}})});