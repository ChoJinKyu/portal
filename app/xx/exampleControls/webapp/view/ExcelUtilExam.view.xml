<mvc:View controllerName="xx.exampleControls.controller.ExcelUtilExam" 
    xmlns:mvc="sap.ui.core.mvc" 
    xmlns="sap.m" 
    xmlns:core="sap.ui.core" 
    xmlns:u="sap.ui.unified"
    xmlns:layout="sap.ui.layout" 
    xmlns:table="sap.ui.table"
    xmlns:lib-m="ext.lib.m"
	xmlns:html="http://www.w3.org/1999/xhtml"
	xmlns:app="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"
    height="100%">

    <Page id="page" title="Excel Util" titleLevel="H2" class="sapUiContentPadding" showNavButton="true" navButtonPress=".onNavigationBackPress">
        <content>

           <Table id="rTable" 
                  title="ResponsibleTable"
                  inset="false"
                  noDataText="No Data"
                  class="sapFDynamicPageAlignContent" 
                  updateFinished=".onRtableUpdateFinished"
                  items="{rModelList>/Message}"
                  mode="MultiSelect" 
                  width="auto">
                <headerToolbar>
                    <OverflowToolbar>
                        <Title text="Responsible Table / Total : {= ${rModelList>/Message}.length > 0 ? '(' + ${rModelList>/Message}.length + ')' : '0'}" level="H2" />
                        <ToolbarSpacer />
                        <Button text="Load Data" type="Transparent" press=".onRLoadPress" />
                        <Button text="Reset Data" type="Transparent" press=".onResetRModelListPress" />
                        <Button text="Change Mode" type="Transparent" press=".onChangeModePress" />
                        <Button id="rTableExportButton" text="Export" type="Transparent" press=".onExportPress($event, {modelName: 'rModelList', path: '/Message'})" class="sapUiTinyMargin" icon="sap-icon://excel-attachment" />
                        <u:FileUploader id="rFileUploader" uploadComplete="handleUploadComplete" change=".onImportChange($event, {modelName : 'rModelList', path : '/Message'})" />
                        <!--<Button text="Import" type="Transparent" press=".onImportPress" class="sapUiTinyMargin" icon="sap-icon://excel-attachment"/>-->
                    </OverflowToolbar>
                </headerToolbar>
                <columns>
                    <Column minScreenWidth="Tablet" hAlign="Center" width="40px">
                        <ObjectStatus icon="sap-icon://document" text="State" visible="false" />
                    </Column>
                    <Column width="10em">
                        <Text text="Product" />
                        <customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="product_id" />
                        </customData>
                    </Column>
                    <Column minScreenWidth="Tablet" hAlign="Center" mergeDuplicates="true" width="10em">
                        <VBox>
                        <Text text="Chain" />
                        </VBox>
                        <!--specify customData for Excel Imporing-->
                        <customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="chain_code" />
                        </customData>
                    </Column>
                    <Column minScreenWidth="Tablet" hAlign="Center" mergeDuplicates="true" width="10em">
                        <Text text="Language" />
                        <customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="language_code" />
                        </customData>
                    </Column>
                    <Column minScreenWidth="Tablet" hAlign="Center" width="15em">
                        <Text text="Code" />
                        <customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="message_code" />
                        </customData>
                    </Column>
                    <Column minScreenWidth="Tablet" hAlign="Left">
                        <Text text="Content" textAlign="Center" />
                        <customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="message_contents" />
                        </customData>
                    </Column>
                    <Column minScreenWidth="Tablet" hAlign="Center" width="10em">
                        <Text text="Type" />
                        <customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="message_type_code" />
                        </customData>
                    </Column>
                    <Column minScreenWidth="Tablet" hAlign="Center" width="10em">
                        <Text text="Price"/>
                        <customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="price" />
                            <!--Export EDM Type-->
                            <core:CustomData key="type" value="Number" />
                            <!--Export 천단위 표시 여부-->
                            <core:CustomData key="delimiter" value="true" />
                            <!--Export 숫자 값 옆에 측정 단위 또는 통화로 표시 할 텍스트-->
                            <core:CustomData key="unit" value="KRW" />
                            <!--Export Width 지정(default 20)-->
                            <core:CustomData key="width" value="30" />
                        </customData>
                    </Column>
                    <Column minScreenWidth="Tablet" hAlign="Center" width="10em">
                        <Text text="Using" textAlign="Center" />
                        <customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="use_flag" />
                            <!--Export EDM Type-->
                            <core:CustomData key="type" value="Boolean" />
                            <!--Export Boolean type 의 text 표현-->
                            <core:CustomData key="trueValue" value="Yes" />
                            <core:CustomData key="falseValue" value="No" />
                        </customData>
                    </Column>
                    <Column minScreenWidth="Tablet" hAlign="Center" width="10em">
                        <Text text="create date" textAlign="Center" />
                        <customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="local_create_dtm" />
                            <!--Export EDM Type-->
                            <core:CustomData key="type" value="Date" />
                            <!--Export format-->
                            <core:CustomData key="format" value="yyyy-mm-dd" />
                            <!--엑셀 칼럼 textAlign-->
                            <core:CustomData key="textAlign" value="Center" />
                        </customData>
                    </Column>
                    <Column minScreenWidth="Tablet" hAlign="Center" width="10em">
                        <Text text="update datetime" textAlign="Center" />
                        <customData>
                            <!--Import시 적용될 property-->
                            <core:CustomData key="bindName" value="local_update_dtm" />
                            <!--EDM Type-->
                            <core:CustomData key="type" value="DateTime" />
                            <!--format 시간은 분단위 까지만 출력됩니다.-->
                            <core:CustomData key="format" value="yyyy-mm-dd HH:mm:ss" />
                            <!--엑셀 칼럼 textAlign-->
                            <core:CustomData key="textAlign" value="Center" />
                        </customData>
                    </Column>
                    <Column minScreenWidth="Tablet" hAlign="End" width="10em" visible="false">
                        <Text text="Hidden Column" textAlign="Center" />
                        <customData>
                            <!--Import시 적용될 property-->
                            <core:CustomData key="bindName" value="product_name" />
                            <!--엑셀 칼럼 width 지정-->
                            <core:CustomData key="width" value="50" />
                        </customData>
                    </Column>
                    <Column minScreenWidth="Tablet" hAlign="End" width="10em">
                        <Text text="noExport Column" textAlign="Center" />
                        <customData>
                            <!--Import시 적용될 property-->
                            <core:CustomData key="bindName" value="create_user_id" />
                            <!--엑셀 칼럼 width 지정 true 이어야 적용됨-->
                            <core:CustomData key="noExport" value="true" />
                        </customData>
                    </Column>
                </columns>
                <items>
                    <ColumnListItem>
                        <cells>
                            <ObjectStatus icon="{
                                path: 'rModelList>_row_state_',
                                formatter: '.formatter.toModelStateColumnIcon'
                            }" />
                            <ObjectIdentifier
                                title="{rModelList>name}"
                                text="{rModelList>product_id}"/>
                            <ComboBox selectedKey="{rModelList>chain_code}" width="100%" items="{
                                    path: 'common>/Code',
                                    filters: [
                                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'},
                                        {path: 'group_code', operator: 'EQ', value1: 'CM_CHAIN_CD'}
                                    ]
                                }" required="true">
                                <items>
                                    <core:Item key="{common>code}" text="{common>code_name}" />
                                </items>
                            </ComboBox>
                            <ComboBox selectedKey="{rModelList>language_code}" width="100%" items="{
                                    path: 'common>/Code',
                                    filters: [
                                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'},
                                        {path: 'group_code', operator: 'EQ', value1: 'CM_LANG_CODE'}
                                    ]
                                }" required="true">
                                <items>
                                    <core:Item key="{common>code}" text="{common>code_name}" />
                                </items>
                            </ComboBox>
                            <HBox>
                                <Text text="{rModelList>message_code}" visible="{displayModel>/readMode}"/>
                                <Input textAlign="End" value="{
                                        path: 'rModelList>message_code',
                                        type: 'sap.ui.model.type.String',
                                        constraints: {
                                            maxLength: 30
                                        }
                                    }" required="true" visible="{displayModel>/editMode}"/>
                            </HBox>

                            <TextArea value="{rModelList>message_contents}" width="100%" />
                            <Select forceSelection="false" selectedKey="{rModelList>message_type_code}" autoAdjustWidth="true" items="{
                                    path: 'common>/Code',
                                    type: 'sap.ui.model.type.String',
                                    constraints: {
                                        maxLength: 1000
                                    },
                                    filters: [
                                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'},
                                        {path: 'group_code', operator: 'EQ', value1: 'CM_MESSAGE_TYPE_CODE'}
                                    ]
                                }">
                                <core:Item key="{common>code}" text="{common>code_name}" />
                            </Select>
                            <ObjectNumber number="{
                                    parts:[
                                        {path:'rModelList>price'},
                                        {path:'rModelList>currency_code'}
                                    ],
                                    type: 'sap.ui.model.type.Currency',
                                    formatOptions: {showMeasure: false}
                                }" unit="{rModelList>currency_code}" textDirection="RTL" />
                            <Switch state="{= typeof ${rModelList>use_flag} === 'string' ? JSON.parse(${rModelList>use_flag}) : ${rModelList>use_flag}}" customTextOn="Yes" customTextOff="No">
                                <layoutData>
                                    <FlexItemData growFactor="1" />
                                </layoutData>
                            </Switch>
                            <ObjectIdentifier text="{
                                    path: 'rModelList>local_create_dtm',
                                    formatter: '.DateFormatter.toUTCDateString'
                                }"/>
                            <ObjectIdentifier text="{
                                    path: 'rModelList>local_update_dtm',
                                    formatter: '.DateFormatter.toUTCDateTimeString'
                                }"/>
                            <Text text="{rModelList>product_name}" />
                            <Text text="{rModelList>create_user_id}" />
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>


            <!--Grid Table-->
            <table:Table id="gTable" sticky="HeaderToolbar,ColumnHeaders" inset="false" noDataText="{I18N>/NCM01004}" class="sapFDynamicPageAlignContent sapUiLargeMarginTop" updateFinished=".onGtableUpdateFinished" rows="{gModelList>/Message}" width="auto">
                <table:extension>
                    <OverflowToolbar>
                        <Title text="Grid Table / Total : {= ${gModelList>/Message}.length > 0 ? '(' + ${gModelList>/Message}.length + ')' : '0'}" level="H2" />
                        <ToolbarSpacer />
                        <Button text="Load Data" type="Transparent" press=".onGLoadPress" />
                        <Button text="Reset Data" type="Transparent" press=".onResetGModelListPress" />
                        <Button text="Change mode" type="Transparent" press=".onChangeModePress" />
                        <Button id="gTableExportButton" text="Export" type="Transparent" press=".onExportPress($event, {modelName: 'gModelList', path: '/Message'})" class="sapUiTinyMargin" icon="sap-icon://excel-attachment" />
                        <u:FileUploader id="gFileUploader" uploadComplete="handleUploadComplete" change=".onImportChange($event, {modelName : 'gModelList', path : '/Message'})" />
                    </OverflowToolbar>
                </table:extension>
                <table:columns>
                    <table:Column width="11rem">
                        <!--specify customData for Excel Imporing-->
                        <table:customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="chain_code" />
                        </table:customData>
                        <Label text="Chain" />
                        <table:template>
                            <ComboBox selectedKey="{gModelList>chain_code}" width="100%" items="{
                                    path: 'common>/Code',
                                    filters: [
                                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'},
                                        {path: 'group_code', operator: 'EQ', value1: 'CM_CHAIN_CD'}
                                    ]
                                }" editable="{= ${gModelList>_row_state_} === 'C' }" required="true">
                                <items>
                                    <core:Item key="{common>code}" text="{common>code_name}" />
                                </items>
                            </ComboBox>
                        </table:template>
                    </table:Column>
                    <table:Column width="11rem">
                        <table:customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="language_code" />
                        </table:customData>
                        <Label text="Language" />
                        <table:template>
                            <ComboBox selectedKey="{gModelList>language_code}" width="100%" items="{
                                    path: 'common>/Code',
                                    filters: [
                                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'},
                                        {path: 'group_code', operator: 'EQ', value1: 'CM_LANG_CODE'}
                                    ]
                                }" editable="{= ${gModelList>_row_state_} === 'C' }" required="true">
                                <items>
                                    <core:Item key="{common>code}" text="{common>code_name}" />
                                </items>
                            </ComboBox>
                        </table:template>
                    </table:Column>
                    <table:Column width="9rem" hAlign="End">
                        <table:customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="message_code" />
                        </table:customData>
                        <Label text="Code" />
                        <table:template>

                            <HBox>
                                <Text text="{gModelList>message_code}" visible="{displayModel>/readMode}"/>
                                <Input textAlign="End" value="{
                                        path: 'gModelList>message_code',
                                        type: 'sap.ui.model.type.String',
                                        constraints: {
                                            maxLength: 30
                                        }
                                    }" required="true" visible="{displayModel>/editMode}"/>
                            </HBox>

                        </table:template>
                    </table:Column>
                    <table:Column width="9rem">
                        <table:customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="message_contents" />
                        </table:customData>
                        <Label text="Content" />
                        <table:template>
                            <Text text="{gModelList>message_contents}" textAlign="Begin" width="100%" />
                        </table:template>
                    </table:Column>
                    <table:Column width="9rem">
                        <table:customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="message_type_code" />
                        </table:customData>
                        <Label text="Type" />
                        <table:template>
                            <ComboBox selectedKey="{gModelList>message_type_code}" width="100%" items="{
                                    path: 'common>/Code',
                                    type: 'sap.ui.model.type.String',
                                    constraints: {
                                        maxLength: 1000
                                    },
                                    filters: [
                                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'},
                                        {path: 'group_code', operator: 'EQ', value1: 'CM_MESSAGE_TYPE_CODE'}
                                    ]
                                }">
                                <items>
                                    <core:Item key="{common>code}" text="{common>code_name}" />
                                </items>
                            </ComboBox>
                        </table:template>
                    </table:Column>
					<table:Column
						width="11rem"
						headerSpan="3,2">
						<table:multiLabels>
							<Label text="Contact" textAlign="Center" width="100%"/>
							<Label text="Address" textAlign="Center" width="100%"/>
							<Label text="Street" textAlign="Center" width="100%"/>
                        </table:multiLabels>
                        <table:customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="street" />
                        </table:customData>
						<table:template>
							<Text text="{gModelList>street}" wrapping="false"/>
						</table:template>
					</table:Column>
					<table:Column
						width="11rem"
						headerSpan="2">
						<table:multiLabels>
							<Label text="Contact"/>
							<Label text="Address"/>
							<Label text="City" textAlign="Center" width="100%"/>
                        </table:multiLabels>
                        <table:customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="city" />
                        </table:customData>
						<table:template>
							<Input value="{gModelList>city}"/>
						</table:template>
					</table:Column>
					<table:Column
						width="11rem">
						<table:multiLabels>
							<Label text="Contact"/>
							<Label text="Phone" textAlign="Center" width="100%"/>
                        </table:multiLabels>
                        <table:customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="phone" />
                        </table:customData>
						<table:template>
							<Input value="{gModelList>phone}"/>
						</table:template>
					</table:Column>
					<table:Column width="8rem" hAlign="End">
						<table:multiLabels>
							<Label visible="false" />
							<Label visible="false" />
							<Label text="Scale" />
                        </table:multiLabels>
                        <table:customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="scale" />
                            <!--Export column textAlign-->
                            <core:CustomData key="textAlign" value="End" />
                            <!--Export column EDM Type-->
                            <core:CustomData key="type" value="Number" />
                            <!--Export column scale 2자리-->
                            <core:CustomData key="scale" value="2" />
                        </table:customData>
						<table:template>
							<Text text="{gModelList>scale}"/>
						</table:template>
                    </table:Column>
                    <table:Column width="8rem" hAlign="Center">
                        <Label text="Create Date" />
                        <table:customData>
                            <!--Import 적용될 property-->
                            <core:CustomData key="bindName" value="local_create_dtm" />
                            <!--Export EDM Type-->
                            <core:CustomData key="type" value="Date" />
                            <!--Export format-->
                            <core:CustomData key="format" value="yyyy-mm-dd" />
                        </table:customData>
						<table:template>
							<Text text="{
                                    path: 'gModelList>local_create_dtm',
                                    formatter: '.DateFormatter.toUTCDateString'
                                }"/>
						</table:template>
					</table:Column>
                </table:columns>
            </table:Table>
        </content>
    </Page>
</mvc:View>