sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/Fragment","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/FilterType","sap/m/MessageStrip","sap/m/MessageBox","sap/m/MessageToast","pg/monitor/controller/BaseController"],function(e,t,i,o,n,r,a,s,g){"use strict";return g.extend("pg.monitor.controller.Monitor",{onInit:function(){var e={OperationCNT:[{title:"소명",value:23},{title:"알람",value:34},{title:"조회",value:20}],ColumnMicroChart:[{type:"원재료",value:10},{type:"설비",value:20},{type:"본사",value:5}]};var t=new sap.ui.model.json.JSONModel(e);this.getView().byId("comChart").setModel(t,"chartModel");this.getView().byId("columnChart").setModel(t,"chartModel");var i="/MonitoringMasterView/$count";var o=this.getView().getModel();var n=this.getView().byId("numeric");o.read(i,{success:function(e,t){var i=e;n.setValue(i)},error:function(e){}})},onPress_ShowingPanel:function(){var e=this.getView().byId("h_layout");e.setVisible(!e.getVisible());var t=this.getView().byId("btn_showChart");t.setText(e.getVisible()===false?"Show MiniCharts":"Hide MiniCharts")},onBeforeExport:function(e){var t=e.getParameter("exportSettings");t.worker=false},onSort:function(){var e=this._getSmartTable();if(e){e.openPersonalisationDialog("Sort")}},onFilter:function(){var e=this._getSmartTable();if(e){e.openPersonalisationDialog("Filter")}},onGroup:function(){var e=this._getSmartTable();if(e){e.openPersonalisationDialog("Group")}},onColumns:function(){var e=this._getSmartTable();if(e){e.openPersonalisationDialog("Columns")}},_getSmartTable:function(){if(!this._oSmartTable){this._oSmartTable=this.getView().byId("LineItemsSmartTable")}return this._oSmartTable},onPressCategory:function(e){var t=this.getView().byId("distribution_combo");var i=this.getView().byId("distribution_input");var o=e.getSource().getProperty("value");if(o==="구분"){i.bindAggregation("suggestionItems",{path:"/Products",template:new sap.ui.core.Item({key:"{ProductID}",text:"{ProductID}"})})}else if(o==="시나리오"){i.bindAggregation("suggestionItems",{path:"/Products",template:new sap.ui.core.Item({key:"{SupplierID}",text:"{SupplierID}"})})}else{i.bindAggregation("suggestionItems",{path:"/Products",template:new sap.ui.core.Item({key:"{UnitPrice}",text:"{UnitPrice}"})})}},onPopoverPress:function(e){var i=e.getSource();if(!this._oPopover){t.load({name:"pg.test.view.Popover",controller:this}).then(function(e){this._oPopover=e;this.getView().addDependent(this._oPopover);this._oPopover.openBy(i)}.bind(this))}else{this._oPopover.openBy(i)}},onCloseButton:function(e){this._oPopover.close()},onBeforeRebindTable:function(e){var t=e.getParameter("bindingParams");var n=this.getView().byId("smartFilterBar");var r=n.getControlByKey("company_combo");var a=n.getControlByKey("corp_combo");var s=n.getControlByKey("business_combo");var g=r.getValue();var l=a.getValue();var c=s.getValue();if(g.length>0){var u=new i("tenant_name",o.EQ,g);t.filters.push(u)}if(g.length>0){var m=new i("company_name",o.EQ,l);t.filters.push(u)}if(g.length>0){var p=new i("business_name",o.EQ,g);t.filters.push(u)}},onDelete:function(){var e=this.getView().byId("MasterTable");a.confirm("삭제하시겠습니까?",{actions:[a.Action.OK,a.Action.CANCEL],emphasizedAction:a.Action.OK,onClose:function(t){if(t===a.Action.OK){var i=e.getSelectedItems();for(var o=0;o<i.length;o++){e.removeItem(i[o])}s.show("삭제가 완료되었습니다.")}}})},onCopy:function(){var e=this.getView().byId("MasterTable");var t=e.getSelectedItems();if(t.length>1){a.warning("1개의 행만 선택해주세요.")}},onNavToRegister:function(e){var t=e.getSource().getBindingContext().getPath();var i=e.getSource().getBindingContext().getProperty("scenario_code");var o=e.getSource().getBindingContext().getProperty("tenant_id");var n=e.getSource().getBindingContext().getProperty("company_code");this.getRouter().navTo("Register",{scenario_code:"S000000001",tenant_id:"L2100",company_code:"LGCKR"})},onChangeCombo:function(e){var t=e.getSource().getSelectedKey();var i=this.getView().byId("corp_combo");var o=this.getView().byId("business_combo");var n=i.getBinding("items");var r=[];var a=new sap.ui.model.Filter("tenant_id","EQ",t);r.push(a);i.bindAggregation("items",{path:"/OrgCompanyView",filters:r,template:new sap.ui.core.Item({key:"{company_code}",text:"{company_name}"})});o.bindAggregation("items",{path:"/OrgUnitView",filters:r,template:new sap.ui.core.Item({key:"{bizunit_code}",text:"{bizunit_name}"})})},onChangeCorpCombo:function(e){var t=this.getView().byId("company_combo").getSelectedKey();var i=this.getView().byId("business_combo");var o=i.getBinding("items");var n=[];var r=new sap.ui.model.Filter("tenant_id","EQ",t);n.push(r);i.bindAggregation("items",{path:"/OrgUnitView",filters:n,template:new sap.ui.core.Item({key:"{bizunit_code}",text:"{bizunit_name}"})})},onChangeTenant:function(e){var t=e.oSource.getSelectedItem().getBindingContexts();var i=this.getView().byId("company_combo");var o=i.getBinding("items");var n=[];var r=new sap.ui.model.Filter("tenant_id","Contains",t);n.push(r);o.filter(n)}})});