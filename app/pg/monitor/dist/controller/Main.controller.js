sap.ui.define(["sap/m/MessageBox","sap/m/MessageToast","pg/monitor/controller/BaseController","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/FilterType","sap/ui/model/Sorter","sap/ui/model/json/JSONModel","sap/m/Token","sap/m/MessageStrip","sap/ui/core/InvisibleMessage","sap/ui/core/library","sap/ui/comp/library","sap/m/SearchField","sap/m/ColumnListItem","sap/m/SearchField","sap/ui/model/type/String","sap/m/Label","sap/ui/core/Fragment","sap/ui/core/util/MockServer","sap/ui/model/odata/v2/ODataModel","sap/m/UploadCollectionParameter","sap/ui/core/format/FileSizeFormat","sap/base/util/deepExtend"],function(e,t,o,s,i,a,n,r,l,c,u,p,d,m,g,f,y,h,b,v,S,I,C){"use strict";var M=p.InvisibleMessageMode;return o.extend("pg.monitor.controller.Main",{onInit:function(){console.group("onInit");this._createView();this._setMessage();this._setSetData();console.groupEnd()},_createView:function(){console.group("_createView");this.oInvisibleMessage=u.getInstance();var e=new r({bEditMode:false,busy:false});this.oViewParam=new r({signalList:false});this.setModel(e,"ui");this.byId("buttonEdit").addStyleClass("customerButton");this.byId("buttonDelete").addStyleClass("customerButton");this.byId("buttonSave").addStyleClass("customerButton");this.byId("buttonHistory").addStyleClass("customerButton");console.groupEnd()},_upcollection:function(){var e;e=sap.ui.require.toUrl("uploadCollection.json");this.getView().setModel(new r(e));this.byId("UploadCollection").addEventDelegate({onBeforeRendering:function(){this.byId("attachmentTitle").setText(this._getAttachmentTitleText())}.bind(this)});this.bIsUploadVersion=false},_setMessage:function(){console.group("_setMessage");this.errorDeleteRowChooice="삭제할 항목을 선택해야 합니다.";this.confirmAllDeleteRow="선택된 항목을 삭제 하시 겠습니까? 하위 등록된 데이타도 같이 삭제 됩니다.";this.confirmDeleteRow="선택된 항목을 삭제 하시 겠습니까?";this.confirmDeleteRowTitle="삭제 확인";this.sucessDelete="삭제가 성공 하였습니다.";console.groupEnd()},_getLoadData:function(e){console.group("_getLoadData");console.groupEnd()},_setSetData:function(){console.group("_setSetData");var e=this.getView(),t=this.getOwnerComponent().getModel("odata");console.dir(t);e.byId("comboBoxType").setSelectedKey(t.getProperty("/comboBoxType"));e.byId("comboboxScenario").setSelectedKey(t.getProperty("/comboboxScenario"));var o=t.getProperty("/radioActive");o=parseInt(o);e.byId("radioActive").setSelectedIndex(o);e.byId("comboBoxRawMaterials").setSelectedKey(t.getProperty("/comboBoxRawMaterials"));e.byId("comboboxOffice").setSelectedKey(t.getProperty("/comboboxOffice"));e.byId("conboBoxNatioinStatus").setSelectedKey(t.getProperty("/conboBoxNatioinStatus"));e.byId("reMonitoringPurpose").setHeight("150px");e.byId("reMonitoringPurpose").setValue(this._richTextEditor());e.byId("reMonitoringPurposeDetail").setValue(t.getProperty("/reMonitoringPurposeDetail"));e.byId("checkBoxOMType1").setSelected(t.getProperty("/checkBoxOMType1"));e.byId("checkBoxOMType2").setSelected(t.getProperty("/checkBoxOMType2"));e.byId("checkBoxOMType3").setSelected(t.getProperty("/checkBoxOMType3"));e.byId("reSourceSystem").setValue(t.getProperty("/reSourceSystem"));e.byId("reSourceSystemDetail").setValue(t.getProperty("/reSourceSystemDetail"));console.groupEnd()},_getToday:function(){var e=new Date;var t=("0"+e.getDate()).slice(-2);var o=("0"+(e.getMonth()+1)).slice(-2);var s=e.getFullYear();console.log(s+"-"+o+"-"+t);return s+"-"+o+"-"+t},_getUtcSapDate:function(){var e=sap.ui.core.format.DateFormat.getDateInstance({pattern:"yyyy-MM-dd'T'HH:mm"});var t=new Date;var o=e.format(t)+":00Z";console.log("utcDate",o);return o},_setFilter:function(){console.group("_setFilter");var e=this.byId("mainList");var t=new s("tenant_id",i.EQ,"0000");var o=e.getBinding("rows");o.filter([t]);console.groupEnd()},_showMsgStrip:function(e,t){console.group("onShowMsgStrip");var o=sap.ui.getCore().byId("msgStrip"),s="Information";switch(e){case"i":s="Information";break;case"w":s="Warning";break;case"e":s="Error";break;case"s":s="Success";break;default:s="Information"}if(o){o.destroy()}this._generateMsgStrip(s,t);console.groupEnd()},_generateMsgStrip:function(e,t){console.group("_generateMsgStrip");var o=this.byId("oVerticalContent"),s=new c("msgStrip",{text:t,showCloseButton:true,showIcon:true,type:e});this.oInvisibleMessage.announce("New Message "+e+" "+t,M.Assertive);o.addContent(s);console.groupEnd()},onEdit:function(){console.group("onEdit");var e=this.getModel("ui");console.log(e.getProperty("/bEditMode"));if(e.getProperty("/bEditMode")){e.setProperty("/bEditMode",false)}else{e.setProperty("/bEditMode",true)}console.groupEnd()},onSignalListAddRow:function(e){console.group("onSignalListAddRow");var t=this.getOwnerComponent().getModel("odata"),o=t.getProperty("/SignalCollection"),s=this.byId("signalList"),i={sid:Math.floor(Math.random()*1e3),condition:"LessThen",value1:Math.floor(Math.random()*100),value2:Math.floor(Math.random()*100),status:"A"};o.push(i);t.refresh(true);console.dir(o);console.groupEnd()},onSignalListDelete:function(t){console.group("onSignalListDelete");var o=this.getOwnerComponent().getModel("odata"),s=o.getProperty("/SignalCollection"),i=this.byId("signalList"),a=o.getData(),n,r=this;var l=this.byId("signalList").getSelectedContexts();if(l.length>0){var c=this.confirmDeleteRow;this.getView().setBusy(true);e.confirm(c,{title:this.confirmDeleteRowTitle,initialFocus:sap.m.MessageBox.Action.CANCEL,onClose:function(t){if(t===e.Action.OK){console.log("delete ok");for(var a=l.length-1;a>=0;a--){var n=parseInt(l[0].sPath.substring(l[0].sPath.lastIndexOf("/")+1));s.splice(n,1)}r.getView().setBusy(false);o.setProperty("/SignalCollection",s);i.removeSelections();o.refresh(true);e.show(r.confirmDeleteRowTitle,{icon:e.Icon.ERROR,title:r.sucessDelete,actions:[e.Action.OK],styleClass:"sapUiSizeCompact"})}else if(t===e.Action.CANCEL){this.getView().setBusy(false);return}}})}else{e.show(this.errorDeleteRowChooice,{icon:e.Icon.ERROR,title:this.errorCheckChangeCopyRowTitle,actions:[e.Action.OK],styleClass:"sapUiSizeCompact"})}o.setProperty("/SignalCollection",s);i.clearSelection();o.refresh(true);console.groupEnd()},onDelete:function(){console.group("onDelete-");e.confirm("삭제 하시 겠습니까?",{title:"monitor Item Delete",initialFocus:sap.m.MessageBox.Action.CANCEL,onClose:function(t){if(t===e.Action.OK){e.show("삭제 확인",{icon:e.Icon.Sucess,title:"삭제 되었습니다.",actions:[e.Action.OK],styleClass:"sapUiSizeCompact"})}else if(t===e.Action.CANCEL){return}}});console.groupEnd()},onHistory:function(e){console.group("onHistory");var t=this.byId("panelHistory");var o=t.getExpanded();if(o){t.setExpanded(false)}else{t.setExpanded(true)}console.groupEnd()},onHistoryPopoverClose:function(){this._HistoryPopover.close();this._HistoryPopover.destroy();this._HistoryPopover=null},_getDefaultTokens:function(){var e=new l({key:"HistoryData",text:"monitor"});return[e]},onHistoryItemPress:function(e){console.group("onHistoryItemPress");var t=this.byId("historyDetailTable");var o="odata>"+e.oSource._aSelectedPaths[0]+"/modifyHistory";console.groupEnd()},onSave:function(){console.group("onSave");var t=this.byId("comboBoxType").getSelectedItem().getKey();var o=this.byId("comboboxScenario").getSelectedItem().getKey();var s=this.byId("radioActive").getSelectedIndex();var i=this.byId("comboBoxRawMaterials").getSelectedItem().getKey();var a=this.byId("comboboxOffice").getSelectedItem().getKey();var n=this.byId("conboBoxNatioinStatus").getSelectedItem().getKey();var r=this.getView().byId("multiinputUser").getTokens();var l=r.map(function(e){return e.getKey()}).join(",");var c=jQuery.sap.encodeHTML(this.byId("reMonitoringPurpose").getValue());var u=jQuery.sap.encodeHTML(this.byId("reMonitoringPurposeDetail").getValue());var p=this.byId("checkBoxOMType1").getSelected()==true?"1":"0";var d=this.byId("checkBoxOMType2").getSelected()==true?"1":"0";var m=this.byId("checkBoxOMType3").getSelected()==true?"1":"0";var g=jQuery.sap.encodeHTML(this.byId("reSourceSystem").getValue());var f=jQuery.sap.encodeHTML(this.byId("reSourceSystemDetail").getValue());var y=[];var h=this.byId("signalList").getItems();debugger;for(var b=0;b<h.length;b++){var v={condition:h[b].getCells(0)[0].mProperties.selectedKey,"Value 1":h[b].getCells(0)[1].mProperties.value,"Value 2":h[b].getCells(0)[2].mProperties.value,Department:h[b].getCells(0)[3].mProperties.selectedKey};y.push(v)}var S=[];var I=this.byId("multiComboBoxCycle").getSelectedItems();for(var C=0;C<I.length;C++){var h={key:I[C].mProperties.key,text:I[C].mProperties.text};S.push(h)}var M=this.byId("UploadCollection");var x=M.getItems().length;if(x>0){}console.log("comboBoxType",t);console.log("comboboxScenario",o);console.log("radioActive",s);console.log("comboBoxRawMaterials",i);console.log("comboboxOffice",a);console.log("conboBoxNatioinStatus",n);console.log("multiinputUser",l);console.log("reMonitoringPurpose",c);console.log("reMonitoringPurposeDetail",c);console.log("checkBoxOMType1",p);console.log("checkBoxOMType2",d);console.log("checkBoxOMType3",m);console.log("reSourceSystem",g);console.log("reSourceSystemDetail",f);e.confirm("저장 하시 겠습니까?",{title:"Monitor Item Save",initialFocus:sap.m.MessageBox.Action.CANCEL,onClose:function(t){if(t===e.Action.OK){e.show("저장 확인",{icon:e.Icon.Sucess,title:"저장 되었습니다.",actions:[e.Action.OK],styleClass:"sapUiSizeCompact"})}else if(t===e.Action.CANCEL){return}}});console.groupEnd()},onFileItemDelete:function(e){console.group("onFileItemDelete");console.groupEnd()},onChange:function(e){console.group("onChange");var t=e.getSource();var o=new sap.m.UploadCollectionParameter({name:"x-csrf-token",value:"securityTokenFromModel"});t.addHeaderParameter(o);console.groupEnd()},onFileDeleted:function(e){console.group("onFileDeleted");t.show("Event fileDeleted triggered");console.groupEnd()},onFileSizeExceed:function(t){console.group("onFileSizeExceed");e.show("허용된 파일 사이즈가 아닙니다. 파일 허용 크기는 10메가 입니다.",{icon:e.Icon.ERROR,title:"파일 사이즈 오류",actions:[e.Action.OK],styleClass:"sapUiSizeCompact"});console.groupEnd()},onFilenameLengthExceed:function(t){console.group("onFilenameLengthExceed");e.show("허용된 파일 이름 길이가 아닙니다.이름은 50자 이내 입니다.",{icon:e.Icon.ERROR,title:"파일 이름 오류",actions:[e.Action.OK],styleClass:"sapUiSizeCompact"});console.groupEnd()},onTypeMissmatch:function(t){console.group("onTypeMissmatch");e.show("허용된 파일 타입이 아닙니다. 허용파일 목록 : gif, png, jpg, jpeg, doc, docx, xls, xlsx, hwp, pdf, ppt, pdf",{icon:e.Icon.ERROR,title:"파일 타입오류",actions:[e.Action.OK],styleClass:"sapUiSizeCompact"});console.groupEnd()},onStartUpload:function(e){var t=this.byId("UploadCollection");if(cFiles>0){t.upload()}},onBeforeUploadStarts:function(e){var o=new S({name:"slug",value:e.getParameter("fileName")});e.getParameters().addHeaderParameter(o);setTimeout(function(){t.show("Event beforeUploadStarts triggered")},4e3)},onUploadComplete:function(e){var o=e.getParameter("files")[0].fileName;setTimeout(function(){var e=this.byId("UploadCollection");for(var s=0;s<e.getItems().length;s++){if(e.getItems()[s].getFileName()===o){e.removeItem(e.getItems()[s]);break}}t.show("Event uploadComplete triggered")}.bind(this),8e3)},onSelectChange:function(e){var t=this.byId("UploadCollection");t.setShowSeparators(e.getParameters().selectedItem.getProperty("key"))},_richTextEditor:function(){var e='<p style="text-align: justify; background: white; font-size: 10pt; font-family: Calibri, sans-serif;"><strong><span style="font-size: 10.5pt; font-family: sans-serif; color: black;">Lorem ipsum dolor sit amet</span></strong>'+'<span style="font-size: 10.5pt; font-family: sans-serif; color: black;">, consectetur adipiscing elit. Suspendisse ornare, nibh nec gravida tincidunt, ipsum quam venenatis nisl, vitae venenatis urna sem eget ipsum. Ut cursus auctor leo et vulputate. '+"Curabitur nec pretium odio, sed auctor felis. In vehicula, eros aliquam pharetra mattis, ante mi fermentum massa, nec pharetra arcu massa finibus augue. </span></p> "+'<p style="margin: 0in 0in 11.25pt; text-align: justify; background: white; font-size: 10pt; font-family: Calibri, sans-serif;"><img style="float: left; padding-right: 1em;" src="img/wo.jpg" width="304" height="181">'+'<span style="font-size: 10.5pt; font-family: sans-serif; color: #0070c0;">Phasellus imperdiet metus est, in luctus erat fringilla ut. In commodo magna justo, sit amet ultrices ipsum egestas quis.</span><span style="font-size: 10.5pt; font-family: sans-serif; color: black;"> '+"Nullam ac mauris felis. Sed tempor odio diam, nec ullamcorper lacus laoreet vitae. <strong>Aenean quam libero</strong>, varius eu ex eu, aliquet fermentum orci. Donec eget ante sed enim pretium tempus. <strong><em>Aliquam semper neque eu aliquam dictum</em></strong>. "+"Nulla in convallis diam. Fusce molestie risus nec posuere ullamcorper. Fusce ut sodales tortor. <u>Morbi eget odio a augue viverra semper.</u></span></p>"+'<p style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Fusce dapibus sodales ornare. '+"Nullam ac mauris felis. Sed tempor odio diam, nec ullamcorper lacus laoreet vitae. Aenean quam libero, varius eu ex eu, aliquet fermentum orci. Donec eget ante sed enim pretium tempus. Nullam laoreet metus ac enim placerat, nec tempor arcu finibus. "+"Curabitur nec pretium odio, sed auctor felis. Nam eu neque faucibus, pharetra purus id, congue elit. Phasellus neque lectus, gravida at cursus at, pretium eu lorem. </span></p>"+"<ul>"+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Nulla non elit hendrerit, auctor arcu sit amet, tempor nisl.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Morbi sed libero pulvinar, maximus orci et, hendrerit orci.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Phasellus sodales enim nec sapien commodo mattis.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Integer laoreet eros placerat pharetra euismod.</span></li>'+"</ul>"+'<p style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #c00000;">Ut vitae commodo ante. Morbi nibh dolor, ullamcorper sed interdum id, molestie vel libero. '+"Proin volutpat dui eget ipsum scelerisque, a ullamcorper ipsum mattis. Cras sed elit sit amet diam convallis vehicula vitae ut nisl. Ut ornare dui ligula, id euismod lectus eleifend at. Nulla facilisi. In pharetra lectus et augue consequat vestibulum.</span></p>"+"<ol>"+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Proin id eros vel libero maximus dignissim ac et velit.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">In non odio pharetra, dapibus augue quis, laoreet felis.</span></li>'+"</ol>"+'<p style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Donec a consectetur libero. Donec ut massa justo. Duis euismod varius odio in rhoncus. Nullam sagittis enim vel massa tempor, '+"ut malesuada libero mollis. Vivamus dictum diam diam, quis rhoncus ex congue vel.</span></p>"+'<p style="text-align: center; font-size: 10pt; font-family: Calibri, sans-serif;" align="center"><em><span style="font-family: sans-serif; color: #a6a6a6;">"Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit..."</span></em></p>'+'<p style="text-align: right; font-size: 10pt; font-family: Calibri, sans-serif;" align="right"><span style="font-family: sans-serif; color: #353535;">-</span> <strong><span style="font-family: sans-serif; color: #353535;">Sed in lacus dolor.</span></strong></p>';return e},onExit:function(){if(this._oPopover){this._oPopover.destroy()}}})});