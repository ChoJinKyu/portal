<mvc:View
    controllerName="pg.mi.miMaster.controller.MainList"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:form="sap.ui.layout.form"
    xmlns:layout="sap.ui.layout"
    xmlns:core="sap.ui.core"
    xmlns:lib-m="ext.lib.m"
    xmlns:smartFilterBar="sap.ui.comp.smartfilterbar"
    xmlns:smartTable="sap.ui.comp.smarttable"
    xmlns:sv="sap.ui.comp.smartvariants"
    xmlns:micro="sap.suite.ui.microchart"
    xmlns:smartVariantManagement="sap.ui.comp.smartvariants"
    xmlns:customData="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"
    height="100%">

    <f:DynamicPage
        id="page"
        headerExpanded="{oUi>/headerExpanded}"
        toggleHeaderOnTitleClick="true">
        <!-- DynamicPage Title -->
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                    <Title text="{I18N>/MIMASTER_TITLE}"/>
                </f:heading>
                <f:snappedContent></f:snappedContent>
                <f:expandedContent></f:expandedContent>
                <!-- <f:navigationActions>
                    <Button icon="sap-icon://unfavorite" type="Transparent"/>
                </f:navigationActions> -->
            </f:DynamicPageTitle>
        </f:title>
        <!-- DynamicPage Header -->
        <f:header>

            <f:DynamicPageHeader pinnable="true">
                <f:content>
                <!-- <smartVariantManagement:SmartVariantManagement        
				             id="pageVariantId"
				             persistencyKey="PageVariantPKey" />                      -->
                    <!-- Smart Filter --><!--considerSelectionVariants Variant 표시 -->

                    <smartFilterBar:SmartFilterBar id="smartFilterBar" 
                    entitySet="MIMatListView" 
                    considerSelectionVariants="false" 
                    enableBasicSearch="false" >
                        <smartFilterBar:controlConfiguration>

                            <!-- 시황자재코드 -->
                            <smartFilterBar:ControlConfiguration  key="mi_material_code" groupId="_BASIC" index="1" label="{I18N>/MI_MATERIAL_CODE}"
                            visibleInAdvancedArea="true">
                                <smartFilterBar:customControl>
                                <Input id="input_mi_material_code" liveChange=".onUpperLiveChange" placeholder="{I18N>/INPUT}" class=".sapMInput.myCustomCSSClass .sapMInputBaseInner"/> 
                                        <!-- <ComboBox id="combobox_mi_material_code" items="{path: '/MIMatListView', templateShareable:true}" placeholder="{I18N>/OPTION}">
                                        <core:Item key="{mi_material_code}" text="{mi_material_code}"/>
                                    </ComboBox> -->
                                </smartFilterBar:customControl>
                                
                            </smartFilterBar:ControlConfiguration>

                            <!-- 시황자재명 -->
                            <smartFilterBar:ControlConfiguration key="mi_material_name" groupId="_BASIC" index="2" label="{I18N>/MI_MATERIAL_NAME}"  
                            visibleInAdvancedArea="true" >
                                <smartFilterBar:customControl>
                                        <Input id="input_mi_material_name" placeholder="{I18N>/INPUT}"/>
                                </smartFilterBar:customControl>
                            </smartFilterBar:ControlConfiguration>

                            <!-- Category명 -->
                            <smartFilterBar:ControlConfiguration key="category_code" groupId="_BASIC" index="3" label="{I18N>/CATEGORY}" 
                            visibleInAdvancedArea="true">
                                <smartFilterBar:customControl>
                                        <MultiComboBox
                                            id="multicombobox_category_code"
                                            showSecondaryValues= "true"
                                            placeholder="{I18N>/OPTION}"
                                            width="200px"
                                            items="{path:'/MICategoryHierarchyStructureView',
                                                    sorter: {
                                                        path: 'parent_category_code',
                                                        descending: false,
                                                        group: true
                                                    },
                                                    filters : [
                                                        {path : 'hierarchy_level', operator : 'NE', value1 : '0'}
                                                    ]
                                            }"> 
                                            <core:ListItem key="{category_code}" text="{category_code}" additionalText="{category_name}" />                                       
                                        </MultiComboBox>
                                </smartFilterBar:customControl>
                            </smartFilterBar:ControlConfiguration>

                             <!-- 사용여부 -->    
                          <smartFilterBar:ControlConfiguration key="use_flag" groupId="_BASIC" index="4" label="{I18N>/USE_FLAG}" 
                            visibleInAdvancedArea="true">
                                <smartFilterBar:customControl>
                                        <ComboBox id="combobox_use_flag" items="{path: '/UseYNView', templateShareable:true}" placeholder="{I18N>/OPTION}">
                                        <core:Item key="{code}" text="{code_name}"/>
                                    </ComboBox>
                                </smartFilterBar:customControl>
                            </smartFilterBar:ControlConfiguration>  
                            <smartFilterBar:ControlConfiguration key="Validated" filterType="single"/>          
                        </smartFilterBar:controlConfiguration>
                        <smartFilterBar:layoutData>
                            <FlexItemData shrinkFactor="0"/>
                        </smartFilterBar:layoutData>
                    </smartFilterBar:SmartFilterBar>
                </f:content>
            </f:DynamicPageHeader>
        </f:header>

        <!-- DynamicPage Content -->
        <f:content>
                <!-- Smart Table -->
                <smartTable:SmartTable
                    width="100%"
                    height="100%"
                    id="smartTable_MainTable_ResponsiveTable"
                    smartVariant="pageVariantId"                    
                    entitySet="MIMatListView"
                    tableBindingPath="{/MIMatListView}"
                    smartFilterId="smartFilterBar"
                    tableType="ResponsiveTable"
                    useExportToExcel="true"
                    beforeRebindTable=".onBeforeRebindTable"
                    beforeExport=".onBeforeExport"
                    useVariantManagement="false"
                    useTablePersonalisation="true"
                    showTablePersonalisation="false"
                    header="시황자재 Master List"
                    showRowCount="true"
                    editable="true"                    
                    persistencyKey="SmartTableAnalytical_Explored"
                    enableAutoBinding="true"                     
                    class="sapUiResponsiveContentPadding"                    
                    demandPopin="true"
                    initiallyVisibleFields="mi_material_code,mi_material_name,category_name,use_flag,category_code,system_update_dtm"
                    >
                    <smartTable:customToolbar>
                        <OverflowToolbar design="Transparent">
                            <ToolbarSpacer/>
                            <Button text="{I18N>/NEW}" id="buttonMainTableCreate" type="Transparent" press=".onMainTableCreate"/>                            
                            <!-- <Button text="Copy" id="buttonMainTableCopy"  type="Transparent" enabled="false" press=".onMainTableCopy"/> -->
                            <Button text="{I18N>/ROW_DELETE}" id="buttonMainTableDelete" type="Transparent" enabled="false" press=".onMainTableDelete"/>
                            <OverflowToolbarButton
                                icon="sap-icon://sort"
                                tooltip="Sort"
                                text="Sort"
                                press=".onMainTableSort"/>
                            <OverflowToolbarButton
                                icon="sap-icon://filter"
                                tooltip="Filter"
                                text="Filter"
                                press=".onMainTableFilter"/>
                            <OverflowToolbarButton
                                icon="sap-icon://action-settings"
                                tooltip="Column Settings"
                                text="Column Settings"
                                press=".onMainTableColumns"/>
                        </OverflowToolbar>
                    </smartTable:customToolbar>
                            <Table id="mainTable" 
                                   mode="MultiSelect"
                                   growingScrollToLoad="true"
                                   growing="true"
                                   sticky="ColumnHeaders,HeaderToolbar"
                                   growingThreshold="50"
                                   inset="false"   
                                   >
                                 <columns>  
                                       <Column minScreenWidth ="" demandPopin="false" importance="High"  popinDisplay="WithoutHeader">
                                        <customData>
                                        <core:CustomData key="p13nData"
                                        value='\{"columnKey": "mi_material_code", "leadingProperty": "mi_material_code", "sortProperty": "mi_material_code", "filterProperty": "mi_material_code", "columnIndex": 1}'/>
                                        </customData>
                                            <Text text="{I18N>/MI_MATERIAL_CODE}"></Text>
                                        </Column>

                                        <Column minScreenWidth ="" demandPopin="false" importance="High">
                                          <customData>
                                        <core:CustomData key="p13nData"
                                        value='\{"columnKey": "mi_material_name", "leadingProperty": "mi_material_name", "sortProperty": "mi_material_name", "filterProperty": "mi_material_name", "columnIndex": 2}'/>
                                        </customData>
                                             <Text text="{I18N>/MI_MATERIAL_NAME}"></Text>
                                        </Column>
                                        <Column minScreenWidth ="" demandPopin="false" importance="High">
                                          <customData>
                                        <core:CustomData key="p13nData"
                                        value='\{"columnKey": "category_name", "leadingProperty": "category_name", "sortProperty": "category_name", "filterProperty": "category_name", "columnIndex": 3}'/>
                                        </customData>
                                             <Text text="{I18N>/CATEGORY_NAME}"></Text>
                                        </Column>

                                        <Column minScreenWidth ="" demandPopin="true">
                                          <customData>
                                        <core:CustomData key="p13nData"
                                        value='\{"columnKey": "use_flag", "leadingProperty": "use_flag", "sortProperty": "use_flag", "filterProperty": "use_flag", "columnIndex": 4}'/>
                                        </customData>
                                             <Text text="{I18N>/USE_FLAG}"></Text>                                                                             
                                        </Column>

                                        <Column width="0px">
                                          <customData>
                                        <core:CustomData key="p13nData"
                                        value='\{"columnKey": "category_code", "leadingProperty": "category_code", "columnIndex": -100}'/>
                                        </customData>
                                             <Text visible="false" text="{I18N>/CATEGORY_CODE}"></Text>                                                                             
                                        </Column>

                                        <Column visible="false" width="0px">
                                          <customData>
                                        <core:CustomData key="p13nData"
                                        value='\{"columnKey": "tenant_id", "leadingProperty": "tenant_id", "columnIndex": -101}'/>
                                        </customData>
                                             <Text visible="false" text="{I18N>/TENANT_ID}"></Text>                                                                             
                                        </Column>

                                        <Column visible="false" width="0px">
                                          <customData>
                                        <core:CustomData  key="p13nData"
                                        value='\{"columnKey": "system_update_dtm", "leadingProperty": "system_update_dtm", "sortProperty": "system_update_dtm", "filterProperty": "system_update_dtm", "columnIndex": 6}'/>
                                        </customData>
                                             <Text text="system_update_dtm"></Text>                                                                             
                                        </Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem type="Navigation" press=".onMainTableItemPress">
                                             <Text textAlign="Center" text="{mi_material_code}"></Text>
                                             <Text textAlign="Center" text="{mi_material_name}"></Text>
                                             <Text textAlign="Center" text="{category_name}"></Text>
                                             <Text textAlign="Center" text="{= ${use_flag} ? 'Yes':'No'}"></Text>  
                                             <Text visible="false"  text="{category_code}"></Text>
                                             <Text visible="false"  text="{tenant_id}"></Text>
                                             <Text visible="false" text="{system_update_dtm}"></Text>
                                        </ColumnListItem>
                                    </items> 
                                </Table>
                </smartTable:SmartTable>
        
        </f:content>
        <!-- DynamicPage Footer -->
        <f:footer>
            <OverflowToolbar>
                <ToolbarSpacer/>
                <Button text="Save" type="Emphasized" press=".onPageSaveButtonPress"/>
                <Button text="Cancel" type="Transparent" press=".onPageCancelEditButtonPress"/>
            </OverflowToolbar>
        </f:footer>
    </f:DynamicPage>
</mvc:View>