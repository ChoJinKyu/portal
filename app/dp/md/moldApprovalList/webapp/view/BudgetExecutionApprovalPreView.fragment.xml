<!-- 
   description : 집행품의 미리보기  
-->
<core:FragmentDefinition
    xmlns:uxap="sap.uxap"
    xmlns:form="sap.ui.layout.form" 
    xmlns:core="sap.ui.core" 
    xmlns:layout="sap.ui.layout"
    xmlns:tnt="sap.tnt"
    xmlns:sc="sap.suite.ui.commons"
    xmlns:si="sap.suite.ui.commons.statusindicator"
    xmlns:u="sap.ui.unified" 
    xmlns:table="sap.ui.table" 
    xmlns="sap.m" 
    core:require="{ I18NFormatter: 'dp/md/util/controller/I18NFormatter' }"
    >
<Dialog id="budgetExecutionPreview" class="sapUiSmallMargin" title="Preview" contentWidth="100%" contentHeight="630px">
	<uxap:ObjectPageLayout 
        height="600px"
        id="page_bp_preview"
		showTitleInHeaderContent="true"
		showEditHeaderButton="true" 
        upperCaseAnchorBar="false"
		showFooter="true"
		editHeaderButtonPress="handleEditBtnPress" >
		<uxap:headerTitle>
			<uxap:ObjectPageDynamicHeaderTitle>
				<uxap:expandedHeading>
					<Title text="Budget Execution Approval" wrapping="true" />
				</uxap:expandedHeading>

				<uxap:snappedHeading>
                    <FlexBox fitContainer="true" alignItems="Center">
						<Title text="Budget Execution Approval" wrapping="true"/>
					</FlexBox>
				</uxap:snappedHeading>

			    <uxap:expandedContent>
				</uxap:expandedContent>

				<uxap:snappedContent>
				</uxap:snappedContent>

				<uxap:snappedTitleOnMobile>
				</uxap:snappedTitleOnMobile>

				<uxap:actions>
                    <!-- 상단 버튼 영역 -->
				</uxap:actions>

                <uxap:navigationActions>
					<OverflowToolbarButton   type="Transparent" icon="sap-icon://decline" text="back" tooltip="back to the list" press=".onPrvClosePress" />
                </uxap:navigationActions>
			</uxap:ObjectPageDynamicHeaderTitle>
		</uxap:headerTitle>

		<uxap:headerContent>
			<FlexBox wrap="Wrap" >
				<layout:VerticalLayout class="sapUiSmallMarginBeginEnd">
                  <ObjectStatus
                        title="{I18N>/APPROVAL_NUMBER}"
                        text="{appMaster>/approval_number}"/>
                    <ObjectStatus
                        title="{I18N>/REQUESTOR}"
                        text="[{appMaster>/user_english_name}]{appMaster>/user_local_name}"/>
                    <ObjectStatus
                        title="{I18N>/REQUEST_DATE}"
                        text="{appMaster>/request_date}"/>
				</layout:VerticalLayout>

                <layout:VerticalLayout class="sapUiSmallMarginBeginEnd">
					<HBox><Label text="{I18N>/STATUS}" /> <Label text=" :"/></HBox>
                    <ObjectStatus
                        class="sapMObjectStatusLarge"
                        text="{= ${appMaster>/approval_number} === undefined ?'New':''}{appMaster>/approve_status_code_nm}"
                        state="Error" />
				</layout:VerticalLayout>

                <layout:VerticalLayout class="sapUiSmallMarginBeginEnd">
                      <HBox>
                         <Title text="{I18N>/PROCESS}"/>
                    </HBox>
                    <HBox id="BudgetExecutionPressPrev">
                       
                   
                    </HBox>
                </layout:VerticalLayout>
			</FlexBox>
		</uxap:headerContent>

		<uxap:sections id="sections_bp">
			<uxap:ObjectPageSection id="pageSectionMain_bp" titleUppercase="true" title="General Info">
				<uxap:subSections>
					<uxap:ObjectPageSubSection >
                            <layout:VerticalLayout class="sapUiSmallMarginBeginEnd"> 
                            <HBox alignItems="Center">
                                <Label
                                    text="Subject"
                                    class="sapUiTinyMarginEnd"
                                    textAlign="Left"
                                    labelFor="input"
                                    required="true"/>
                                <Text
                                    text="{appMaster>/approval_title}"
                                    visible="true"
                                    />
                                 
                            </HBox>
                            <VBox>
                                <Label text="Description" labelFor="input" required="true"></Label> 
                                <layout:VerticalLayout class="sapUiContentPadding" width="100%">
                                    <layout:content>
                                        <core:HTML content="{appMaster>/approval_contents}">
                                        </core:HTML>
                                    </layout:content>
                                </layout:VerticalLayout>
                            </VBox>
                        </layout:VerticalLayout>
					</uxap:ObjectPageSubSection>
				</uxap:subSections>
			</uxap:ObjectPageSection>

            <uxap:ObjectPageSection titleUppercase="false" title="Item for Budget Execution">
				<uxap:subSections>
                    <uxap:ObjectPageSubSection> 
                        <form:SimpleForm editable="true" 
                         layout="ResponsiveGridLayout" 
                         labelSpanXL="2" 
                         labelSpanL="2" 
                         labelSpanM="2" 
                         labelSpanS="2" 
                         adjustLabelSpan="false" 
                         emptySpanXL="0" 
                         emptySpanL="0" 
                         emptySpanM="0" 
                         emptySpanS="0" 
                         columnsXL="2" 
                         columnsL="1" 
                         columnsM="1" 
                         singleContainerFullSize="true">
			        <form:content>
                <VBox  height="6em">
					<!-- Budget Type -->
					<Label text="{path:'I18N>/BUDGET_TYPE', formatter:'I18NFormatter'}" required="true"/>
                    <SegmentedButton enabled="false"
                                     selectedKey="{mdCommon>/investment_ecst_type_code}" 
                                     width="100%" 
                                     items="{ path : 'util>/Code',
                                              filters : [
                                                {path : 'tenant_id', operator : 'EQ', value1 : 'L2101'},
                                                {path : 'group_code', operator : 'EQ', value1 : 'DP_MD_BUDGET_TYPE'}
                                              ],
                                              sorter: { path: 'sort_no'}
                                            }">
						<items>
							<SegmentedButtonItem width="6em" text="{util>code_name}" key="{util>code}"/>
						</items>
					</SegmentedButton>
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox height="6em">
					<Label text="Acquisition Department" required="true"/>
                    <!-- view Mode -->
                    <Text text="" />
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox height="6em">
					<Label text="{path:'I18N>/ACQUISITION_DEPARTMENT', formatter:'I18NFormatter'}" required="true"/>
                    <!-- view Mode -->
                    <ComboBox 
                              editable="false" 
                              
                              width="100%"  
                              selectedKey="{mdCommon>/accounting_department_code}" 
                              items="{}">
						<core:Item key="{util>code}" text="{util>code_description}"/>
					</ComboBox>
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox height="6em">
					<Label text="{path:'I18N>/IMPORT_COMPANY', formatter:'I18NFormatter'}"/>
                    <!-- view Mode -->
                  	<ComboBox  editable="false" 
                              
                              width="100%" 
                              selectionChange=".onBCompanyChange"
                              selectedKey="{mdCommon>/import_company_code}" 
                              items="{
                                   path: 'org>/Company',
                                        filters: [
                                            {path: 'tenant_id', operator: 'EQ', value1: 'L2101'}
                                        ],
                                        sorter: { path: 'company_code'}
                              }">
						<core:Item key="{org>company_code}" text="[{org>company_code}] {org>company_name}" />
					</ComboBox>
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox height="6em">
					<!-- projectcode  {I18N>/PROJECT_CODE}-->
					<Label text="{I18N>/PROJECT_CODE}" required="true"/> 
                    <!-- view Mode -->
                    <ComboBox editable="false" 
                              
                              width="100%" 
                              selectedKey="{mdCommon>/project_code}" 
                              items="{}">
						<core:Item key="{util>code}" text="{util>code_description}"/>
					</ComboBox>
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox height="6em">
					<Label text="{path:'I18N>/IMPORT_PLANT', formatter:'I18NFormatter'}" />
                     <!-- view Mode -->
                   <ComboBox width="100%" 
                              editable="false" 
                              
                              selectedKey="{mdCommon>/import_company_org_code}" 
                              enabled="{=${mdCommon>/investment_ecst_type_code}!=='S'?false:true}"
                              items="{
                                  path: 'importPlant>/Pur_Operation_Org'
                              }">
						<core:Item key="{importPlant>org_code}" text="[{importPlant>org_code}]{importPlant>org_name}" />
					</ComboBox>
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox height="6em">
					<Label text="{I18N>/ACCOUNT}" required="true"/>
                    <ComboBox editable="false" 
                                
                              width="100%" 
                              required="true"
                              selectedKey="{mdCommon>/account_code}" 
                              items="{ path : 'util>/Code',
                                        filters : [
                                            {path : 'tenant_id', operator : 'EQ', value1 : 'L2101'},
                                            {path : 'group_code', operator : 'EQ', value1 : 'DP_MD_ACCOUNT_NEW'}
                                        ]
                                    }">
						<core:Item key="{util>code}" text="{util>code_name}"/>
					</ComboBox>
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox height="6em">
					<Label text="{I18N>/CUSTOMER}"/>
                    <Text text="" />
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox height="6em">
					<Label text="{path:'I18N>/BALANCED_BUDGET', formatter:'I18NFormatter'}"/>
					<HBox alignItems="End" justifyContent="End">
						<ObjectStatus text="{mdCommon>/provisional_budget_amount}"/>
						<ObjectStatus text="  KRW" state="Error"/>
					</HBox>
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox height="6em">
					<Label text="{path:'I18N>/CUSTOMER_PO_NO', formatter:'I18NFormatter'}"/>
                    <Text text="" />
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<HBox>
					<VBox class="sapUiSmallMargin">
						<Label text="{I18N>/COMPANY}"/>
						<ObjectStatus text="[{company>/company_code}] {company>/company_name}" state="Error"/>
					</VBox>
					<VBox class="sapUiSmallMargin">
						<Label text="{I18N>/PLANT}"/>
						<ObjectStatus text="[{plant>/plant_code}] {plant>/plant_name}" state="Error"/>
					</VBox>
				</HBox>
                </form:content>
		        </form:SimpleForm>
				</uxap:ObjectPageSubSection>
                 <uxap:ObjectPageSubSection>
                  	<table:Table 
                             selectionMode="None" 
                             fixedColumnCount="6" 
                             visibleRowCountMode="Auto" 
                             rows="{path:'mdItemMaster>/ItemBudgetExecution'}">
					<table:extension>
						<OverflowToolbar>
							<ToolbarSpacer/>
						
						</OverflowToolbar>
					</table:extension>
					<table:columns>
						<table:Column  visible="false">
							<Label text="mold_id"/>
							<table:template>
								<Text text="{mdItemMaster>mold_id}"/>
							</table:template>
						</table:Column>
						<table:Column visible="false">
							<Label text="{path:'I18N>/APPROVAL_NUMBER', formatter:'I18NFormatter'}"/>
							<table:template>
								<Text text="{mdItemMaster>approval_number}"/>
							</table:template>
						</table:Column>
						<table:Column width="8em" hAlign="Center">
							<Label text="{I18N>/MODEL}"/>
							<table:template>
								<Text text="{mdItemMaster>model}"/>
							</table:template>
						</table:Column>
						<table:Column width="12em"  hAlign="Center">
							<Label text="{path:'I18N>/MOLD_NO', formatter:'I18NFormatter'}" />
							<table:template>
								<Text  text="{mdItemMaster>mold_number}"/>
							</table:template>
						</table:Column>
						<table:Column  width="4em" hAlign="Center">
							<Label text="{path:'I18N>/SEQUENCE', formatter:'I18NFormatter'}" />
							<table:template>
								<Text  text="{mdItemMaster>mold_sequence}" textAlign="Center"/>
							</table:template>
						</table:Column>
						<table:Column  width="10em" hAlign="Center">
							<Label text="{I18N>/DESCRIPTION}"/>
							<table:template>
								<Text  text="{mdItemMaster>spec_name}"/>
							</table:template>
						</table:Column>
						<table:Column  width="8em" hAlign="Center">
							<Label text="{path:'I18N>/PRODUCTION_TYPE', formatter:'I18NFormatter'}"/>
							<table:template>
                                <ComboBox editable="false"  
                                         
                                        selectedKey="{mdItemMaster>mold_production_type_code}" 
                                        items="{ path : 'util>/Code',
                                        filters : [
                                            {path : 'tenant_id', operator : 'EQ', value1 : 'L2101'},
                                            {path : 'group_code', operator : 'EQ', value1 : 'DP_MD_PROD_TYPE'}
                                        ]
                                    }">
									<core:Item key="{util>code}" text="{util>code_name}"/>
								</ComboBox>
							</table:template>
						</table:Column>
						<table:Column  width="8em" hAlign="Center">
							<Label text="{path:'I18N>/ITEM_TYPE', formatter:'I18NFormatter'}" />
							<table:template>
								<ComboBox  editable="false" 
                                        selectedKey="{mdItemMaster>mold_item_type_code}" 
                                        
                                        items="{ path : 'util>/Code',
                                        filters : [
                                            {path : 'tenant_id', operator : 'EQ', value1 : 'L2101'},
                                            {path : 'group_code', operator : 'EQ', value1 : 'DP_MD_ITEM_TYPE'}
                                        ]
                                    }">
									<core:Item key="{util>code}" text="{util>code_name}"/>
								</ComboBox>
							</table:template>
						</table:Column>
						<table:Column width="6em" hAlign="Center">
							<Label text="{path:'I18N>/BOOK_CURRENCY', formatter:'I18NFormatter'}" />
							<table:template>
								<Text text="{mdItemMaster>book_currency_code}"/>
							</table:template>
						</table:Column>
						<table:Column  width="8em" hAlign="Center">
							<Label text="{path:'I18N>/BUDGET_AMOUNT', formatter:'I18NFormatter'}"/>
							<table:template>
                                <Text  text="{mdItemMaster>provisional_budget_amount}" textAlign="Right"/>
							</table:template>
						</table:Column>
						<table:Column  width="8em" hAlign="Center">
							<Label text="{path:'I18N>/ASSET_TYPE', formatter:'I18NFormatter'}"/>
							<table:template>
                                <ComboBox 
                                        editable="false" 
                                        selectedKey="{mdItemMaster>asset_type_code}" 
                                        items="{ path : 'util>/Code',
                                        filters : [
                                            {path : 'tenant_id', operator : 'EQ', value1 : 'L2101'},
                                            {path : 'group_code', operator : 'EQ', value1 : 'DP_MD_ASSET_TYPE'}
                                        ]
                                    }">
									<core:Item key="{util>code}" text="{util>code_name}"/>
								</ComboBox>
							</table:template>
						</table:Column>
						<table:Column  width="40em" hAlign="Center">
							<Label text="{path:'I18N>/FAMILY_PART_NUMBER'}"/>
							<table:template>
								<Text text="{mdItemMaster>family_part_number_1}" textAlign="Left"/>
							</table:template>
						</table:Column>
						<table:Column  width="10em" hAlign="Center">
							<Label text="{path:'I18N>/EXPECTED_SALES_DATE', formatter:'I18NFormatter'}"/>
							<table:template>
								<!-- 임시 컬럼명 -->
								<DatePicker value="{mdItemMaster>budget_exrate_date}" valueFormat="yyyyMMdd" displayFormat="yyyy-MM-dd" placeholder="YYYY-MM-DD"/>
							</table:template>
						</table:Column>
						<table:Column  width="10em" hAlign="Center">
							<Label text="{path:'I18N>/EXPECTED_DISPOSAL_DATE', formatter:'I18NFormatter'}"/>
							<table:template>
								<!-- 임시 컬럼명 -->
								<DatePicker value="{mdItemMaster>inspection_date}" valueFormat="yyyyMMdd" displayFormat="yyyy-MM-dd" placeholder="YYYY-MM-DD"/>
							</table:template>
						</table:Column>
					</table:columns>
				</table:Table>
                    </uxap:ObjectPageSubSection>
                    
				</uxap:subSections>
			</uxap:ObjectPageSection>

			<uxap:ObjectPageSection titleUppercase="false" title="Attachments">
				<uxap:subSections>
				    <uxap:ObjectPageSubSection id="pageAttachmentsSection_bp" >
                            <Label text=""/>
					</uxap:ObjectPageSubSection>
				</uxap:subSections>
			</uxap:ObjectPageSection>

			<uxap:ObjectPageSection titleUppercase="false" title="Approval Line">
				<uxap:subSections>
                	<uxap:ObjectPageSubSection id="pageApprovalLineSection_bp">
                    <!-- Approval Line -->
                        <Table       
                            growing="true"
                            growingThreshold="20"
                            class="sapFDynamicPageAlignContent" 
                            updateFinished=".onListMainTableUpdateFinished"
                            mode="None"
                            width="auto"
                            items="{approverPreview>/Approvers}"
                            >
                        <headerToolbar>
                            <OverflowToolbar>
                            <Label text="Approval Line"/>
                            </OverflowToolbar>
                        </headerToolbar>
                        <columns>
                            <Column  minScreenWidth="Tablet" hAlign="Center"  width="3em" >
                                <Text text="No." />
                            </Column>
                            <Column  minScreenWidth="Tablet" hAlign="Center" width="10em" >
                                <Text text="Type" />
                            </Column>
                            <Column  minScreenWidth="Tablet" hAlign="Center" width="20em" >
                                <Text text="Name/Dept" />
                            </Column>
                            <Column  minScreenWidth="Tablet" hAlign="Center" width="12em" >
                                <Text text="Status" />
                            </Column> 
                            <Column  minScreenWidth="Tablet" hAlign="Center" >
                                <Text text="Comment" />
                            </Column>
                        </columns>
                        <items>
                            <ColumnListItem>
                                <cells>
                                    <Text text="{approverPreview>approve_sequence}" />
                                    <Text text="{approverPreview>approver_type_code_nm}" />
                                    <Text text="{approverPreview>approver_name}" />
                                    <Text text="{approverPreview>approve_status_code}" />
                                    <Text text="{approverPreview>approve_comment}" />
                                </cells>
                            </ColumnListItem>
                        </items>
                    </Table>

					</uxap:ObjectPageSubSection>
					<uxap:ObjectPageSubSection >
                    <!-- Referer -->
                    <VBox class="sapUiSmallMarginBegin">
                        <Toolbar>
                        <Label text="Referer" />
                        </Toolbar>
                        <layout:VerticalLayout class="sapUiContentPadding" width="100%">
                            <MultiInput id="referMultiPrev"
                                placeholder="Choose codes from the ValueHelp"
                                showValueHelp="true" 
                                valueHelpRequest=".onMultiInputWithCodeValuePress"
                                editable="false"
                                >
                            </MultiInput>
                        </layout:VerticalLayout>
                        <layoutData>
                            <layout:GridData span="XL12 L12 M12 S12" />
                        </layoutData> 
                    </VBox>
                    </uxap:ObjectPageSubSection>
				</uxap:subSections>
			</uxap:ObjectPageSection>

		</uxap:sections>

	</uxap:ObjectPageLayout>
    </Dialog>
</core:FragmentDefinition>
