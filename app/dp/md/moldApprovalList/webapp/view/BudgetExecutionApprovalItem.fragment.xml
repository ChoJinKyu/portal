<!-- 
   description : 예산집행품의 테이블 Edit 화면  
-->
<core:FragmentDefinition
	xmlns="sap.m" 
        xmlns:uxap="sap.uxap" 
        xmlns:form="sap.ui.layout.form" 
        xmlns:core="sap.ui.core" 
        xmlns:layout="sap.ui.layout" 
        xmlns:tnt="sap.tnt" 
        xmlns:co="sap.suite.ui.commons" 
        xmlns:si="sap.suite.ui.commons.statusindicator" 
        xmlns:u="sap.ui.unified" 
        xmlns:table="sap.ui.table"
        core:require="{ I18NFormatter: 'dp/md/util/controller/I18NFormatter' }"
         >
    <VBox class="sapUiSmallMargin">

    <form:SimpleForm editable="true" 
                         layout="ResponsiveGridLayout" 
                         labelSpanXL="2" 
                         labelSpanL="2" 
                         labelSpanM="2" 
                         labelSpanS="2" 
                         adjustLabelSpan="false" 
                         emptySpanXL="0" 
                         emptySpanL="0" 
                         emptySpanM="0" 
                         emptySpanS="0" 
                         columnsXL="2" 
                         columnsL="1" 
                         columnsM="1" 
                         width="70%"
                         singleContainerFullSize="true">
			        <form:content>
                    <VBox height="6em">
					<!-- Budget Type -->
					<Label text="{path:'I18N>/BUDGET_TYPE', formatter:'I18NFormatter'}" required="true"/>
					<SegmentedButton enabled="{mode>/editFlag}" 
                                     selectionChange=".onBudgetChange"
                                     id="segInspection" 
                                     selectedKey="{mdCommon>/investment_ecst_type_code}" 
                                     width="100%" 
                                     items="{ path : 'util>/Code',
                                              filters : [
                                                {path : 'tenant_id', operator : 'EQ', value1 : 'L2101'},
                                                {path : 'group_code', operator : 'EQ', value1 : 'DP_MD_BUDGET_TYPE'}
                                              ],
                                              sorter: { path: 'sort_no'}
                                            }">
						<items>
							<SegmentedButtonItem width="6em" text="{util>code_name}" key="{util>code}"/>
						</items>
					</SegmentedButton>
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox height="6em">
					<Label text="{path:'I18N>/ACQUISITION_DEPARTMENT', formatter:'I18NFormatter'}" required="true"/>
                    <!-- Md_Asset > acq_department_code -->
					<Input id="acquisition_department" 
                           value="{mdCommon>/acq_department_code_nm}"
                          
                           editable="{mode>/editFlag}" 
                           showValueHelp="true" valueHelpRequest=".onValueHelpRequestedDept" />
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox  height="6em">
					<Label text="{path:'I18N>/ACCOUNT_DEPARTMENT', formatter:'I18NFormatter'}" required="true"/>
                    <!-- edit Mode -->
					<ComboBox id="accounting_department"
                              editable="{mode>/editFlag}" 
                              
                              width="100%"  
                              selectedKey="{mdCommon>/accounting_department_code}" 
                              items="{}">
						<core:Item key="{util>code}" text="{util>code_description}"/>
					</ComboBox>
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox  height="6em">
					<Label text="{path:'I18N>/IMPORT_COMPANY', formatter:'I18NFormatter'}"/>
                    <!-- edit Mode -->
					<Select  editable="{mode>/editFlag}" 
                              forceSelection="false"  
                              width="100%" 
                              id="importCompany" 
                              change=".onBCompanyChange"
                              selectedKey="{mdCommon>/import_company_code}" 
                              enabled="{=${mdCommon>/investment_ecst_type_code}!=='S'?false:true}"
                              items="{
                                   path: 'importCompany>/Company',
                                        filters: [
                                            {path: 'tenant_id', operator: 'EQ', value1: 'L2101'}
                                        ],
                                        sorter: { path: 'company_code'}
                              }">
						<core:Item key="{importCompany>company_code}" text="[{importCompany>company_code}] {importCompany>company_name}" />
					</Select>
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox  height="6em">
					<!-- projectcode  {I18N>/PROJECT_CODE}-->
					<Label text="{I18N>/PROJECT_CODE}" required="true"/> 
                    <!-- edit Mode -->
					<Select editable="{mode>/editFlag}" 
                              forceSelection="false" 
                              width="100%" 
                              id="projectCode" 
                              selectedKey="{mdCommon>/project_code}" 
                              items="{}">
						<core:Item key="{util>code}" text="{util>code_description}"/>
					</Select>

					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox  height="6em">
					<Label text="{path:'I18N>/IMPORT_PLANT', formatter:'I18NFormatter'}" />
					<Select width="100%" 
                              editable="{mode>/editFlag}" 
                              forceSelection="false" 
                              id="importPlant" 
                              selectedKey="{mdCommon>/import_company_org_code}" 
                              enabled="{=${mdCommon>/investment_ecst_type_code}!=='S'?false:true}"
                              items="{
                                  path: 'importPlant>/Divisions'
                              }">
						<core:Item key="{importPlant>org_code}" text="[{importPlant>org_code}]{importPlant>org_name}" />
					</Select>
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox  height="6em">
					<Label text="{I18N>/ACCOUNT}" required="true"/>
					<Select editable="{mode>/editFlag}" 
                              forceSelection="false"  
                              width="100%" 
                              id="account" 
                              required="true"
                              selectedKey="{mdCommon>/account_code}" 
                              items="{ path : 'util>/Code',
                                        filters : [
                                            {path : 'tenant_id', operator : 'EQ', value1 : 'L2101'},
                                            {path : 'group_code', operator : 'EQ', value1 : 'DP_MD_ACCOUNT_NEW'}
                                        ],
                                        sorter: { path: 'sort_no'}
                                    }">
						<core:Item key="{util>code}" text="{util>code_name}"/>
					</Select>
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox  height="6em">
					<Label text="{I18N>/CUSTOMER}"/>
					<Input value="" showValueHelp="true"  editable="{mode>/editFlag}" id="customer"  /> 
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox  height="6em">
					<Label text="{path:'I18N>/BALANCED_BUDGET', formatter:'I18NFormatter'}"/>
					<HBox alignItems="End" justifyContent="End">
						<ObjectStatus text="{path : 'mdCommon>/provisional_budget_amount'}"/>
						<ObjectStatus text="  KRW" state="Error"/>
					</HBox>
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<VBox height="6em">
					<Label text="{path:'I18N>/CUSTOMER_PO_NO', formatter:'I18NFormatter'}"/>
					<Input value="" editable="{mode>/editFlag}"   id="customer_po_no"  />
					<layoutData>
						<layout:GridData span="XL6 L6 M12 S12"/>
					</layoutData>
				</VBox>
				<HBox>
					<VBox class="sapUiSmallMargin">
						<Label text="{I18N>/COMPANY}"/>
						<ObjectStatus text="[{company>/company_code}] {company>/company_name}" state="Error"/>
					</VBox>
					<VBox class="sapUiSmallMargin">
						<Label text="{I18N>/PLANT}"/>
						<ObjectStatus text="[{plant>/org_code}] {plant>/org_name}" state="Error"/>
					</VBox>
				</HBox>
                </form:content>
		        </form:SimpleForm>
                 <form:SimpleForm editable="true" layout="ResponsiveGridLayout" adjustLabelSpan="false" labelSpanL="4" labelSpanM="4" emptySpanL="0" emptySpanM="0" columnsL="2" columnsM="2">
                    <form:content>
                     <!-- budgetExecutionTable Table -->
                    <table:Table id="budgetExecutionTable" 
                            selectionMode="{=${mode>/editFlag}?'MultiToggle':'None'}" 
                            fixedColumnCount="6"  
                            visibleRowCountMode="Auto" 
                            rows="{path:'mdItemMaster>/ItemBudgetExecution'}">
					<table:extension>
						<OverflowToolbar>
							<ToolbarSpacer/>
							    <!-- Add the Personalization button -->
							    <Button visible="{mode>/editFlag}" type="Transparent" text="{I18N>/ROW_ADD}" press=".onBudgetExecutionAddPress">
								<!-- Add -->
								<customData>
									<core:CustomData key="multi" value="true"/>
								</customData>
							</Button>
							<Button visible="{mode>/editFlag}" type="Transparent" text="{I18N>/ROW_DELETE}" press=".onBudgetExecutionDelRow"/>
						</OverflowToolbar>
					</table:extension>
					<table:columns>
						<table:Column visible="false">
							<Label text="mold_id"/>
							<table:template>
								<Text id="b_mold_id" text="{mdItemMaster>mold_id}"/>
							</table:template>
						</table:Column>
						<table:Column visible="false">
							<Label text="{path:'I18N>/APPROVAL_NUMBER', formatter:'I18NFormatter'}"/>
							<table:template>
								<Text id="b_approval_number" text="{mdItemMaster>approval_number}"/>
							</table:template>
						</table:Column>
						<table:Column width="8em" hAlign="Center">
							<Label text="{I18N>/MODEL}"/>
							<table:template>
								<Text id="b_model" text="{mdItemMaster>model}"/>
							</table:template>
						</table:Column>
						<table:Column width="12em" hAlign="Center">
							<Label text="{path:'I18N>/MOLD_NO', formatter:'I18NFormatter'}" />
							<table:template>
								<Text id="b_mold_number"  text="{mdItemMaster>mold_number}"/>
							</table:template>
						</table:Column>
						<table:Column width="4em" hAlign="Center">
							<Label text="{path:'I18N>/SEQUENCE', formatter:'I18NFormatter'}" />
							<table:template>
								<Text id="b_mold_sequence" text="{mdItemMaster>mold_sequence}" textAlign="Center"/>
							</table:template>
						</table:Column>
						<table:Column width="10em" hAlign="Center">
							<Label text="{I18N>/DESCRIPTION}"/>
							<table:template>
								<Text text="{mdItemMaster>spec_name}"/>
							</table:template>
						</table:Column>
						<table:Column width="8em" hAlign="Center">
							<Label text="{path:'I18N>/PRODUCTION_TYPE', formatter:'I18NFormatter'}"/>
							<table:template>
								<Select id="b_mold_production_type_code"  
                                        forceSelection="false"  
                                        editable="{mode>/editFlag}"
                                        selectedKey="{mdItemMaster>mold_production_type_code}" 
                                        items="{ path : 'util>/Code',
                                        filters : [
                                            {path : 'tenant_id', operator : 'EQ', value1 : 'L2101'},
                                            {path : 'group_code', operator : 'EQ', value1 : 'DP_MD_PROD_TYPE'}
                                        ],
                                        sorter: { path: 'sort_no'}
                                    }">
									<core:Item key="{util>code}" text="{util>code_name}"/>
								</Select>
							</table:template>
						</table:Column>
						<table:Column width="8em" hAlign="Center">
							<Label text="{path:'I18N>/ITEM_TYPE', formatter:'I18NFormatter'}" />
							<table:template>
								<Select  id="b_mold_item_type_code"
                                        editable="{mode>/editFlag}" 
                                        selectedKey="{mdItemMaster>mold_item_type_code}" 
                                        forceSelection="false"  
                                        items="{ path : 'util>/Code',
                                        filters : [
                                            {path : 'tenant_id', operator : 'EQ', value1 : 'L2101'},
                                            {path : 'group_code', operator : 'EQ', value1 : 'DP_MD_ITEM_TYPE'}
                                        ] ,
                                        sorter: { path: 'sort_no'}
                                    }">
									<core:Item key="{util>code}" text="{util>code_name}"/>
								</Select>
							</table:template>
						</table:Column>
						<table:Column width="6em" hAlign="Center">
							<Label text="{path:'I18N>/BOOK_CURRENCY', formatter:'I18NFormatter'}" />
							<table:template>
								<Text id="b_book_currency_code" text="{mdItemMaster>book_currency_code}" textAlign="Center"/>
							</table:template>
						</table:Column>
						<table:Column width="8em" hAlign="Center">
							<Label text="{path:'I18N>/BUDGET_AMOUNT', formatter:'I18NFormatter'}" required="true"/>
							<table:template>
								<Input id="b_provisional_budget_amount"  required="true" textAlign="Right" editable="{mode>/editFlag}"  value="{mdItemMaster>provisional_budget_amount}"/>
							</table:template>
						</table:Column>
						<table:Column width="8em" hAlign="Center">
							<Label text="{path:'I18N>/ASSET_TYPE', formatter:'I18NFormatter'}" required="true"/> 
                            <!-- Md_Asset > asset_type_code -->
							<table:template>
								<Select required="true" 
                                        editable="{mode>/editFlag}" 
                                        selectedKey="{mdItemMaster>asset_type_code}" 
                                        items="{ path : 'assetTypeCodeList>/CodeView',
                                                sorter: { path: 'sort_no'}
                                    }">
									<core:Item key="{assetTypeCodeList>code}" text="{assetTypeCodeList>code_name}"/>
								</Select>
                               
							</table:template>
						</table:Column>
						<table:Column width="40em" hAlign="Center">
							<Label text="{path:'I18N>/FAMILY_PART_NUMBER', formatter:'I18NFormatter'}"/>
							<table:template>
								<Text id="b_family_part_number_1" text="{mdItemMaster>family_part_number_1}"/>
							</table:template>
						</table:Column>
						<table:Column width="10em" hAlign="Center">
							<Label text="{path:'I18N>/EXPECTED_SALES_DATE', formatter:'I18NFormatter'}"/>
							<table:template>
								<!-- 임시 컬럼명 -->
								<DatePicker id="b_budget_exrate_date" value="{mdItemMaster>budget_exrate_date}" valueFormat="yyyyMMdd" displayFormat="yyyy.MM.dd" placeholder="YYYY.MM.DD"/>
							</table:template>
						</table:Column>
						<table:Column width="10em" hAlign="Center">
							<Label text="{path:'I18N>/EXPECTED_DISPOSAL_DATE', formatter:'I18NFormatter'}"/>
							<table:template>
								<!-- 임시 컬럼명 -->
								<DatePicker  id="b_inspection_date" value="{mdItemMaster>inspection_date}" valueFormat="yyyyMMdd" displayFormat="yyyy.MM.dd" placeholder="YYYY.MM.DD"/>
							</table:template>
						</table:Column>
					</table:columns>
				</table:Table>
                     </form:content>
                 </form:SimpleForm>



    </VBox>




       
	
</core:FragmentDefinition>
