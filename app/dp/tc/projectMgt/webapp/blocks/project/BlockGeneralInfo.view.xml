<mvc:View controllerName="dp.tc.projectMgt.controller.blocks.project.BlockGeneralInfo"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m"
  xmlns:f="sap.f"
  xmlns:t="sap.ui.table"
  xmlns:core="sap.ui.core"
  xmlns:form="sap.ui.layout.form"
  xmlns:layout="sap.ui.layout"
  xmlns:tnt="sap.tnt"
  xmlns:lib-m="ext.lib.control.m"
  xmlns:cm-ui="cm.util.control.ui"
  class="sapUiSizeCompact"
  displayBlock="true"
  height="100%">
  <VBox>
    <form:SimpleForm 
            editable="true" 
            visible="{detailModel>/mode/readMode}"
            layout="ResponsiveGridLayout">
        <form:content>
            <!--form line 1-->
            <Label text="{I18N>/PROJECT_CODE}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/project_code}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/PROJECT_NAME}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/project_name}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/PRODUCT_GROUP}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/product_group_text/code_name}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/EVENT}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/develope_event_code}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <!--form line 2-->
            <Label text="{I18N>/REPR_MODEL_CODE}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" linebreak="true" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/model_code}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/REPR_MODEL_NAME}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/model_name}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/PRODUCTION_COMPANY}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/production_company_code}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/QUOTE_PROJECT_CODE}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/quotation_project_code}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <!--form line 3-->
            <Label text="{I18N>/STATUS}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" linebreak="true" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/project_status_text/code_name}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/CREATION_DATE}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{
                            path: 'detailModel>/project_create_date',
                            formatter: '.dateFormatter.toUTCDateString'
                        }">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/GRADE}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/project_grade_text/code_name}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/CUSTOMER_NAME}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/customer_local_name}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>            

            <!--form line 4-->
            <Label text="{I18N>/PROJECT_LEADER}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" linebreak="true"/>
                </layoutData>
            </Label>
            <Text text="{detailModel>/project_leader_info/user_local_name} {detailModel>/project_leader_info/job_title}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/MCST_PERSON}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/buyer_info/user_local_name} {detailModel>/buyer_info/job_title}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/MARKETING}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/marketing_person_info/user_local_name} {detailModel>/marketing_person_info/job_title}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/PLANNING}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/planning_person_info/user_local_name} {detailModel>/planning_person_info/job_title}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <!--form line 5-->
            <Label text="{I18N>/LAST_CUSTOMER}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" linebreak="true"/>
                </layoutData>
            </Label>
            <Text text="{detailModel>/last_customer_name}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/LAST_CUSTOMER_MODEL_NAME}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/customer_model_desc}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/YIELD_MATERIAL_COST}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/mcst_yield_rate}%">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/BOM}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/bom_type_text/code_name}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>
        </form:content>
    </form:SimpleForm>
    <form:SimpleForm 
            editable="true" 
            visible="{detailModel>/mode/editMode}"
            layout="ResponsiveGridLayout">
        <form:content>
            <!--form line 1-->
            <Label text="{I18N>/PROJECT_CODE}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/project_code}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/PROJECT_NAME}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/project_name}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/PRODUCT_GROUP}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <!--<Input value="{detailModel>/product_group_text}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Input>-->
            <ComboBox
                width="100%"
                selectedKey="{detailModel>/product_group_code}"
                change=".onChangeComboBox"
                items="{
                    path: 'util>/Code',
                    filters: [
                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'},
                        {path: 'group_code', operator: 'EQ', value1: 'DC_TC_PRODUCT_GROUP_CODE'}
                    ],
                    sorter: { path: 'sort_no'}
                }">
                <items>
                    <core:Item key="{util>code}" text="{util>code_name}" />
                </items>
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </ComboBox>

            <Label text="{I18N>/EVENT}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <!--<Input value="{detailModel>/project_develope_event_code}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Input>-->
            <ComboBox
                width="100%"
                selectedKey="{detailModel>/develope_event_code}"
                items="{
                    path: 'util>/Code',
                    filters: [
                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'},
                        {path: 'group_code', operator: 'EQ', value1: 'DP_TC_DEVELOP_EVENT_CODE'}
                    ],
                    sorter: { path: 'sort_no'}
                }">
                <items>
                    <core:Item key="{util>code}" text="{util>code_name}" />
                </items>
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </ComboBox>

            <!--form line 2-->
            <Label text="{I18N>/REPR_MODEL_CODE}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" linebreak="true" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/model_code}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/REPR_MODEL_NAME}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Text text="{detailModel>/model_name}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Text>

            <Label text="{I18N>/PRODUCTION_COMPANY}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Input value="{detailModel>/production_company_code}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Input>

            <Label text="{I18N>/QUOTE_PROJECT_CODE}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Input value="{detailModel>/quotation_project_code}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Input>

            <!--form line 3-->
            <Label text="{I18N>/STATUS}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" linebreak="true" />
                </layoutData>
            </Label>
            <ComboBox
                width="100%"
                selectedKey="{detailModel>/project_status_code}"
                items="{
                    path: 'util>/Code',
                    filters: [
                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'},
                        {path: 'group_code', operator: 'EQ', value1: 'DP_TC_PROJECT_STATUS_CODE'}
                    ],
                    sorter: { path: 'sort_no'}
                }">
                <items>
                    <core:Item key="{util>code}" text="{util>code_name}" />
                </items>
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </ComboBox>            

            <Label text="{I18N>/CREATION_DATE}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <!--<Input value="{
                            path: 'detailModel>/project_create_date',
                            formatter: '.dateFormatter.toUTCDateString'
                        }">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Input>-->
            <DatePicker
                id="DP4"
                value="{path:'detailModel>/project_create_date', type:'sap.ui.model.type.Date', formatOptions: { style: 'medium', strictParsing: true}}"
                class="sapUiSmallMarginBottom">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </DatePicker>

            <Label text="{I18N>/GRADE}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <!--<Input value="{detailModel>/project_grade_text}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Input>-->
            <ComboBox
                width="100%"
                selectedKey="{detailModel>/project_grade_code}"
                items="{
                    path: 'util>/Code',
                    filters: [
                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'},
                        {path: 'group_code', operator: 'EQ', value1: 'DP_TC_PROJECT_GRADE_CODE'}
                    ],
                    sorter: { path: 'sort_no'}
                }">
                <items>
                    <core:Item key="{util>code}" text="{util>code_name}" />
                </items>
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </ComboBox>

            <Label text="{I18N>/CUSTOMER_NAME}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Input value="{detailModel>/customer_local_name}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Input>            

            <!--form line 4-->
            <Label text="{I18N>/PROJECT_LEADER}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" linebreak="true"/>
                </layoutData>
            </Label>
            <VBox>
                <Input value="{detailModel>/project_leader_info/user_local_name}"
                       showValueHelp="true" valueHelpRequest=".onInputWithEmployeeValuePress">
                    <customData>
                        <core:CustomData key="modelName" value="detailModel" />
                        <core:CustomData key="textPath" value="/project_leader_info/user_local_name" />
                        <core:CustomData key="codePath" value="/project_leader_empno" />
                    </customData>
                </Input>
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </VBox>

            <Label text="{I18N>/MCST_PERSON}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <VBox>
                <Input value="{detailModel>/buyer_info/user_local_name}"
                       showValueHelp="true" valueHelpRequest=".onInputWithEmployeeValuePress">
                    <customData>
                        <core:CustomData key="modelName" value="detailModel" />
                        <core:CustomData key="textPath" value="/buyer_info/user_local_name" />
                        <core:CustomData key="codePath" value="/buyer_empno" />
                    </customData>
                </Input>
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </VBox>

            <Label text="{I18N>/MARKETING}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <VBox>
                <Input value="{detailModel>/marketing_person_info/user_local_name}"
                       showValueHelp="true" valueHelpRequest=".onInputWithEmployeeValuePress">
                    <customData>
                        <core:CustomData key="modelName" value="detailModel" />
                        <core:CustomData key="textPath" value="/marketing_person_info/user_local_name" />
                        <core:CustomData key="codePath" value="/marketing_person_empno" />
                    </customData>
                </Input>
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </VBox>

            <Label text="{I18N>/PLANNING}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <VBox>
                <Input value="{detailModel>/planning_person_info/user_local_name}"
                       showValueHelp="true" valueHelpRequest=".onInputWithEmployeeValuePress">
                    <customData>
                        <core:CustomData key="modelName" value="detailModel" />
                        <core:CustomData key="textPath" value="/planning_person_info/user_local_name" />
                        <core:CustomData key="codePath" value="/planning_person_empno" />
                    </customData>
                </Input>
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </VBox>

            <!--form line 5-->
            <Label text="{I18N>/LAST_CUSTOMER}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" linebreak="true"/>
                </layoutData>
            </Label>
            <Input value="{detailModel>/last_customer_name}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Input>

            <Label text="{I18N>/LAST_CUSTOMER_MODEL_NAME}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <Input value="{detailModel>/customer_model_desc}">
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </Input>

            <Label text="{I18N>/YIELD_MATERIAL_COST}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <HBox>
                <Input value="{detailModel>/mcst_yield_rate}" width="95%"/>
                <Text text="%" width="100%" class="sapUiLargeMarginEnd"/>
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </HBox>

            <Label text="{I18N>/BOM}">
                <layoutData>
                    <layout:GridData span="XL1 L1 M3 S12" />
                </layoutData>
            </Label>
            <ComboBox
                width="100%"
                selectedKey="{detailModel>/bom_type_code}"
                items="{
                    path: 'util>/Code',
                    filters: [
                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'},
                        {path: 'group_code', operator: 'EQ', value1: 'DP_TC_BOM_TYPE_CODE'}
                    ],
                    sorter: { path: 'sort_no'}
                }">
                <items>
                    <core:Item key="{util>code}" text="{util>code_name}" />
                </items>
                <layoutData>
                    <layout:GridData span="XL2 L2 M3 S12" />
                </layoutData>
            </ComboBox>
        </form:content>
    </form:SimpleForm>
</VBox>

<VBox>

    <t:Table id="tblSimilModel"
            visible="{detailModel>/mode/readMode}"
            selectionMode="None"
            visibleRowCount="{= ${similarModel>/results}.length || 0 }"
            width="auto"
            rows="{similarModel>/results}"
            >
        <t:extension>
            <OverflowToolbar>
                <Title text="{I18N>/SIMILAR_MODEL} ({= ${similarModel>/results}.length || 0 })"/>
                <ToolbarSpacer/>
            </OverflowToolbar>
        </t:extension>
        <t:columns>
            <t:Column hAlign="Left" width="15%" >
                <Label text="{I18N>/MODEL_CODE}" textAlign="Center" width="100%"/>
                <t:template>
                    <Text text="{similarModel>similar_model_code}" textAlign="Left" width="100%" />
                </t:template>
            </t:Column>
            <t:Column hAlign="Left" width="auto" >
                <Label text="{I18N>/MODEL_NAME}" textAlign="Center" width="100%"/>
                <t:template>
                    <Text text="{similarModel>code_desc}"/>
                </t:template>
            </t:Column>
        </t:columns>
    </t:Table>
    <t:Table id="tblSimilModel_edit"
            visible="{detailModel>/mode/editMode}"
            selectionMode="MultiToggle"
            selectionBehavior="Row"
            visibleRowCountMode="Auto"
            minAutoRowCount="3"
            width="auto"
            rows="{similarModel>/results}"
            >
        <t:extension>
            <OverflowToolbar>
                <Text text="{I18N>/SIMILAR_MODEL} ({= ${similarModel>/results}.length || 0 })"/>
                <ToolbarSpacer/>
                <Button text="{I18N>/ROW_ADD}" type="Transparent" press=".onSimilarModelAddButtonPress" enabled="{= ${detailModel>/mcst_status_code} === 'CONFIRMED' ? false : true}"/>
                <Button text="{I18N>/ROW_DELETE}" type="Transparent" press=".onSimilarModelDeleteButtonPress" enabled="{= ${detailModel>/mcst_status_code} === 'CONFIRMED' ? false : true}"/>
            </OverflowToolbar>
        </t:extension>
        <t:columns>
            <t:Column id="mainColumnState" hAlign="Center" width="2em" >
                <ObjectStatus icon="sap-icon://document" text="State" visible="false" />
                <t:template>
                    <ObjectStatus icon="{
                        path: 'similarModel>_row_state_',
                        formatter: '.formatter.toModelStateColumnIcon'
                    }" />
                </t:template>
            </t:Column>
            <t:Column hAlign="Left" width="15%" >
                <Label text="{I18N>/MODEL_CODE}" required="true" textAlign="Center" width="100%"/>
                <t:template>
                    <HBox justifyContent="Begin">
                        <Input placeholder="Choose codes from the ValueHelp"
                                    value="{similarModel>similar_model_code}"
                                    showValueHelp="true"
                                    change=".onMatCodeChange"
                                    valueHelpRequest=".onMaterialCodeValueHelpPress" />
                    </HBox>
                </t:template>
            </t:Column>
            <t:Column hAlign="Left" width="auto" >
                <Label text="{I18N>/MODEL_NAME}" textAlign="Center" width="100%"/>
                <t:template>
                    <Input value="{similarModel>code_desc}"/>
                </t:template>
            </t:Column>
        </t:columns>
    </t:Table>
    <cm-ui:EmployeeDialog id="employeeDialog" 
        title="{I18N>/EMPLOYEE} {I18N>/FIND}"
        closeWhenApplied="true"
        items="{
            filters: [
                {path: 'tenant_id', operator: 'EQ', value1: 'L2100'}
            ]
        }"
        apply=".onEmployeeDialogApplyPress"
    />
</VBox>
</mvc:View>