<mvc:View controllerName="dp.tc.projectMgt.controller.ProjectMgtList"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m"
  xmlns:f="sap.f"
  xmlns:core="sap.ui.core"
  xmlns:form="sap.ui.layout.form"
  xmlns:t="sap.ui.table"
  xmlns:layout="sap.ui.layout"
  xmlns:tnt="sap.tnt"
  xmlns:lib-m="ext.lib.control.m"
  class="sapUiSizeCompact"
  displayBlock="true"
  height="100%">
    <f:DynamicPage 
        headerExpanded="true"
        showFooter="true"
        toggleHeaderOnTitleClick="true">
        <!--DynamicPage Title -->
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                    <Title text="{I18N>/PROJECT} {I18N>/MANAGEMENT}" />
                </f:heading>

                <f:expandedContent>
                    <form:SimpleForm 
                            maxContainerCols="4"
                            editable="true" 
                            layout="ResponsiveGridLayout"
                            labelSpanL="3"
                            labelSpanM="3"
                            labelSpanS="3"
                            emptySpanL="0"
                            emptySpanM="0"
                            adjustLabelSpan="false">
                        <form:content>

                            <Label text="{I18N>/COMPANY}" required="true">
                                <layoutData>
                                    <layout:GridData span="XL1 L1 M1 S1" />
                                </layoutData>
                            </Label>
                            <ComboBox width="100%" change="onChangeCompnay" selectedKey="{filterModel>/company_code/value}" 
                                items="{
                                    path: 'org>/Org_Company',
                                    filters: [
                                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'}
                                    ],
                                    sorter: { path: 'company_code'}
                            }">
                                <items>
                                    <core:Item key="{org>company_code}" text="[{org>company_code}] {org>company_name}" />
                                </items>
                                <layoutData>
                                    <layout:GridData span="XL2 L2 M2 S2" />
                                </layoutData>
                            </ComboBox>

                            <Label text="{I18N>/BUSINESS_DIVISION}" required="true">
                                <layoutData>
                                    <layout:GridData span="XL1 L1 M1 S1" />
                                </layoutData>
                            </Label>
                            <ComboBox
                                id="cbxExpandDivision"
                                width="100%"
                                selectedKey="{filterModel>/bizdivision_code/value}" change="onTestChange"
                                items="{
                                    path: '/Org_Div',
                                    filters: [
                                        {path: 'tenant_id', operator: 'EQ', value1: '999'}
                                    ],
                                    sorter: { path: 'bizdivision_code'}
                                }">
                                <items>
                                    <core:Item key="{bizdivision_code}" text="{bizdivision_name}" />
                                </items>
                                <layoutData>
                                    <layout:GridData span="XL2 L2 M2 S2" />
                                </layoutData>
                            </ComboBox>

                            <Label text="{I18N>/PROJECT_CODE}">
                                <layoutData>
                                    <layout:GridData span="XL1 L1 M1 S1" />
                                </layoutData>
                            </Label>
                            <Input value="{filterModel>/project_code/value}" submit="onSearch">
                                <layoutData>
                                    <layout:GridData span="XL2 L2 M2 S2" />
                                </layoutData>
                            </Input>

                            <Label text="{I18N>/PROJECT_NAME}">
                                <layoutData>
                                    <layout:GridData span="XL1 L1 M1 S1" />
                                </layoutData>
                            </Label>
                            <Input value="{filterModel>/project_name/value}" submit="onSearch">
                                <layoutData>
                                    <layout:GridData span="XL2 L2 M2 S2" />
                                </layoutData>
                            </Input>

                        </form:content>
                    </form:SimpleForm>
                </f:expandedContent>

                <f:snappedContent>
                    <form:SimpleForm 
                            maxContainerCols="4"
                            editable="true" 
                            layout="ResponsiveGridLayout"
                            labelSpanL="3"
                            labelSpanM="3"
                            labelSpanS="3"
                            emptySpanL="0"
                            emptySpanM="0"
                            adjustLabelSpan="false">
                        <form:content>
                            <!--Search line 2-->
                            <Label text="{I18N>/COMPANY}" required="true">
                                <layoutData>
                                    <layout:GridData span="XL1 L1 M1 S1" />
                                </layoutData>
                            </Label>
                            <ComboBox width="100%" change="onChangeCompnay" selectedKey="{filterModel>/company_code/value}" 
                                items="{
                                    path: 'org>/Org_Company',
                                    filters: [
                                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'}
                                    ],
                                    sorter: { path: 'company_code'}
                            }">
                                <items>
                                    <core:Item key="{org>company_code}" text="[{org>company_code}] {org>company_name}" />
                                </items>
                                <layoutData>
                                    <layout:GridData span="XL2 L2 M2 S2" />
                                </layoutData>
                            </ComboBox>
                            
                            <Label text="{I18N>/BUSINESS_DIVISION}" required="true">
                                <layoutData>
                                    <layout:GridData span="XL1 L1 M1 S1" />
                                </layoutData>
                            </Label>
                            <ComboBox
                                id="cbxSnapDivision"
                                width="100%"
                                selectedKey="{filterModel>/bizdivision_code/value}"
                                change="onTestChange"
                                items="{
                                    path: '/Org_Div',
                                    filters: [
                                        {path: 'tenant_id', operator: 'EQ', value1: '999'}
                                    ],
                                    sorter: { path: 'bizdivision_code'}
                                }">
                                <items>
                                    <core:Item key="{bizdivision_code}" text="{bizdivision_name}" />
                                </items>
                                <layoutData>
                                    <layout:GridData span="XL2 L2 M2 S2" />
                                </layoutData>
                            </ComboBox>

                            <Label text="{I18N>/PROJECT_CODE}">
                                <layoutData>
                                    <layout:GridData span="XL1 L1 M1 S1" />
                                </layoutData>
                            </Label>
                            <Input value="{filterModel>/project_code/value}" submit="onSearch">
                                <layoutData>
                                    <layout:GridData span="XL2 L2 M2 S2" />
                                </layoutData>
                            </Input>

                            <Label text="{I18N>/PROJECT_NAME}">
                                <layoutData>
                                    <layout:GridData span="XL1 L1 M1 S1" />
                                </layoutData>
                            </Label>
                            <Input value="{filterModel>/project_name/value}" >
                                <layoutData>
                                    <layout:GridData span="XL2 L2 M2 S2" />
                                </layoutData>
                            </Input>

                        </form:content>
                    </form:SimpleForm>
                </f:snappedContent>

                <f:actions>
                    <Button text="{I18N>/SEARCH}" type="Emphasized" press=".onSearch"/> 
                </f:actions>

            </f:DynamicPageTitle>
        </f:title>
        <!--DynamicPage Header -->
        <f:header>
            <f:DynamicPageHeader pinnable="true">
            <form:SimpleForm 
                maxContainerCols="4"
                editable="true" 
                layout="ResponsiveGridLayout"
                labelSpanL="3"
                labelSpanM="3"
                labelSpanS="3"
                emptySpanL="0"
                emptySpanM="0"
                adjustLabelSpan="false">
                    <form:content>
                        <!--Search line 2-->
                        <Label text="{I18N>/REPR_MODEL_CODE}">
                            <layoutData>
                                <layout:GridData span="XL1 L1 M1 S1" />
                            </layoutData>
                        </Label>
                        <SearchField value="{filterModel>/model_code/value}" >
                            <layoutData>
                                <layout:GridData span="XL2 L2 M2 S2" />
                            </layoutData>
                        </SearchField>

                        <Label text="{I18N>/PRODUCT_GROUP}">
                            <layoutData>
                                <layout:GridData span="XL1 L1 M1 S1" />
                            </layoutData>
                        </Label>
                        <ComboBox
                            width="100%"
                            selectedKey="{filterModel>/product_group_code/value}"
                            items="{
                                path: 'util>/Code',
                                filters: [
                                    {path: 'group_code', operator: 'EQ', value1: 'DC_TC_PRODUCT_GROUP_CODE'}
                                ],
                                sorter: { path: 'sort_no'}
                            }">
                            <items>
                            <core:Item key="{util>code}" text="{util>code_name}" />
                            </items>
                            <layoutData>
                                <layout:GridData span="XL2 L2 M2 S2" />
                            </layoutData>
                        </ComboBox>
                        <Label text="{I18N>/STATUS}">
                            <layoutData>
                                <layout:GridData span="XL1 L1 M1 S1" />
                            </layoutData>
                        </Label>
                        <ComboBox
                            width="100%"
                            selectedKey="{filterModel>/project_status_code/value}"
                            items="{
                                path: 'util>/Code',
                                filters: [
                                    {path: 'group_code', operator: 'EQ', value1: 'DP_TC_PROJECT_STATUS_CODE'}
                                ],
                                sorter: { path: 'sort_no'}
                            }">
                            <items>
                                <core:Item key="{util>code}" text="{util>code_name}" />
                            </items>
                            <layoutData>
                                <layout:GridData span="XL2 L2 M2 S2" />
                            </layoutData>
                        </ComboBox>
                        <Label text="{I18N>/MASSPROD_DATE}">
                            <layoutData>
                                <layout:GridData span="XL1 L1 M1 S1" />
                            </layoutData>
                        </Label>
                        <DateRangeSelection 
                            dateValue="{filterModel>/massprod_start_date/start}" 
                            secondDateValue="{filterModel>/massprod_start_date/end}" >
                            <layoutData>
                                <layout:GridData span="XL2 L2 M2 S2" />
                            </layoutData>
                        </DateRangeSelection>
                        <Label text="{I18N>/GRADE}">
                            <layoutData>
                                <layout:GridData span="XL1 L1 M1 S1" />
                            </layoutData>
                        </Label>
                        <ComboBox
                            width="100%"
                            selectedKey="{filterModel>/project_grade_code/value}"
                            items="{
                                path: 'util>/Code',
                                filters: [
                                    {path: 'group_code', operator: 'EQ', value1: 'DP_TC_PROJECT_GRADE_CODE'}
                                ],
                                sorter: { path: 'sort_no'}
                            }">
                            <items>
                                <core:Item key="{util>code}" text="{util>code_name}" />
                            </items>
                            <layoutData>
                                <layout:GridData span="XL2 L2 M2 S2" />
                            </layoutData>
                        </ComboBox>
                        <Label text="{I18N>/EVENT}">
                            <layoutData>
                                <layout:GridData span="XL1 L1 M1 S1" />
                            </layoutData>
                        </Label>
                        <ComboBox
                            width="100%"
                            selectedKey="{filterModel>/develope_event_code/value}"
                            items="{
                                path: 'util>/Code',
                                filters: [
                                    {path: 'group_code', operator: 'EQ', value1: 'DP_TC_DEVELOP_EVENT_CODE'}
                                ],
                                sorter: { path: 'sort_no'}
                            }">
                            <items>
                            <core:Item key="{util>code}" text="{util>code_name}" />
                            </items>
                            <layoutData>
                                <layout:GridData span="XL2 L2 M2 S2" />
                            </layoutData>
                        </ComboBox>
                        <Label text="{I18N>/MCST_PERSON}">
                            <layoutData>
                                <layout:GridData span="XL1 L1 M1 S1" />
                            </layoutData>
                        </Label>
                        <!--
                        <SearchField value="{filterModel>/buyer_name/value}" >
                            <layoutData>
                                <layout:GridData span="XL2 L2 M2 S2" />
                            </layoutData>
                        </SearchField>
                        -->
                        <VBox>
                            <lib-m:CodePicker
                                placeholder="Enter a Employee name"
                                selectedKey="{filterModel>/buyer_name/value}"
                                keyField="employee_number"
                                textField="user_local_name"
                                suggestionItems="{
                                    path: '/',
                                    filters: [
                                        {path: 'tenant_id', operator: 'EQ', value1: 'L2100'}
                                    ],
                                    serviceUrl: 'srv-api/odata/v2/cm.util.HrService/',
                                    entityName: 'Employee'
                                }">
                                <lib-m:CodePickerValueHelp contentWidth="500px" title="Choose a Employee"
                                    keyFieldHeaderText="Employee ID" textFieldHeaderText="Employee" />
                            </lib-m:CodePicker>
                            <layoutData>
                                <layout:GridData span="XL2 L2 M3 S12" />
                            </layoutData>
                        </VBox>
                        <Label text="{I18N>/COMPUT_EXCLUSION}">
                            <layoutData>
                                <layout:GridData span="XL1 L1 M1 S1" />
                            </layoutData>
                        </Label>
                        <SegmentedButton id="searchCodeSegmentButton"
                                         selectedKey="{filterModel>/mcst_excl_flag/value}"
                                         class="sapUiSmallMarginBottom"
                                         width="100%">
                            <items>
                                <SegmentedButtonItem text="All" key="" />
                                <SegmentedButtonItem text="Y" key="true" />
                                <SegmentedButtonItem text="N" key="false" />
                            </items>
                            <layoutData>
                                <layout:GridData span="XL2 L2 M3 S12" />
                            </layoutData>
                        </SegmentedButton>
                    </form:content>
                </form:SimpleForm>
            </f:DynamicPageHeader>
        </f:header>
        <f:content>
            <!--Part No List 시작-->
            <t:Table id="mainTable"
                selectionMode="Single"
                cellClick=".onCellClickPress"
                rowSelectionChange="onSelectionChange"
                rowActionCount="1"
                rows="{listModel>/results}"
                width="100%"
                class="sapFDynamicPageAlignContent" 
                visibleRowCountMode="Auto">
                <t:extension>
                    <OverflowToolbar>
                        <!-- <Title text="{I18N>/PART_NO_LIST}" level="H2"/> -->
                        <Title text="{I18N>/PROJECT} {I18N>/MANAGEMENT} {I18N>/LIST} ({= ${listModel>/results}.length || 0})" level="H2"/>
                        <ToolbarSpacer />
                        <Button text="{I18N>/QUOTATION_MCST}" type="Emphasized" press=".onGoalCreatePress">
                            <customData>
                                <core:CustomData key="mcst_code" value="QUOTATION" />
                            </customData>
                        </Button>
                        <Button text="{I18N>/TARGET_MCST}" type="Emphasized" press=".onGoalCreatePress" >
                            <customData>
                                <core:CustomData key="mcst_code" value="TARGETS"/>
                            </customData>
                        </Button>
                        <Button text="{I18N>/ESTIMATED} {I18N>/MATERIAL_COST}" type="Emphasized" press=".onGoalCreatePress" >
                            <customData>
                                <core:CustomData key="mcst_code" value="ESTIMATE"/>
                            </customData>
                        </Button>
                        <ToolbarSeparator/>
                        <Button text="{I18N>/MODEL_ADDITION}" type="Transparent" press=".onAddModelPress" />
                        <Button text="{I18N>/COMPUT_EXCLUSION}" type="Transparent" press=".onExcludeCalPress" />
                        <ToolbarSeparator/>
                        <Button icon="sap-icon://excel-attachment" press=".onExcelExportPress"/>
                    </OverflowToolbar>
                </t:extension>
                <t:columns>
                    <t:Column hAlign="Left" width="8rem">
                        <Label text="{I18N>/COMPANY}" textAlign="Center" width="100%"/>
                        <t:template>
                            <Text text="{listModel>company_code}" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Begin" width="10rem">
                        <Label text="{I18N>/BUSINESS_DIVISION}" textAlign="Center" width="100%" />
                        <t:template>
                            <Text text="{listModel>bizdivision_text}" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Left" width="10rem">
                        <Label text="{I18N>/PRODUCT_GROUP}" textAlign="Center" width="100%" />
                        <t:template>
                            <Text text="{listModel>product_group_text}" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Left" width="12rem">
                        <Label text="{I18N>/CUSTOMER_NAME}" textAlign="Center" width="100%" />
                        <t:template>
                            <Text text="{listModel>customer_local_name}" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Center" width="5rem">
                        <Label text="{I18N>/GRADE}" />
                        <t:template>
                            <Text text="{listModel>project_grade_text}" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Center"  width="12rem">
                        <Label text="{I18N>/PROJECT_CODE}" />
                        <t:template>
                            <Text text="{listModel>project_code}" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Left"  width="15rem">
                        <Label text="{I18N>/PROJECT_NAME}" textAlign="Center" width="100%" />
                        <t:template>
                            <Text text="{listModel>project_name}" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Center"  width="12rem">
                        <Label text="{I18N>/QUOTE_PROJECT_CODE}" />
                        <t:template>
                            <Text text="{listModel>quotation_project_code}" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Center"  width="15rem">
                        <Label text="{I18N>/REPR_MODEL_CODE}" textAlign="Center" width="100%" />
                        <t:template>
                            <Text text="{listModel>model_code}" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Center"  width="7rem">
                        <Label text="{I18N>/MASSPROD_DATE}" />
                        <t:template>
                            <Text text="{
                                path: 'listModel>massprod_start_date',
                                formatter: '.dateFormatter.toUTCDateString'
                            }" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Center"  width="6rem">
                        <Label text="{I18N>/BOM}" />
                        <t:template>
                            <Text text="{listModel>bom_type_text}" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Center"  width="6rem">
                        <Label text="{I18N>/STATUS}" />
                        <t:template>
                            <Text text="{listModel>project_status_text}" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Center"  width="6rem">
                        <Label text="{I18N>/EVENT}" />
                        <t:template>
                            <Text text="{listModel>develope_event_code}" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Center"  width="7rem">
                        <Label text="{I18N>/PROJECT_LEADER}" />
                        <t:template>
                            <Text text="{listModel>project_leader_name}" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Center"  width="6rem">
                        <Label text="{I18N>/MCST_PERSON}" />
                        <t:template>
                            <Text text="{listModel>buyer_name}" />
                        </t:template>
                    </t:Column>

                    <t:Column headerSpan="5" hAlign="Center" width="7rem">
                        <t:multiLabels>
                            <Label text="{I18N>/MCST_MGT_STATUS}" />
                            <Label text="{I18N>/LAST_REG_DATE}" />
                        </t:multiLabels>
                        <t:template>
                            <Text text="{
                                path: 'listModel>last_register_date'
                            }" />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Center" width="5rem">
                        <t:multiLabels>
                            <Label text="{I18N>/MCST_MGT_STATUS}" />
                            <Label text="{I18N>/COMPUT_EXCLUSION}" />
                        </t:multiLabels>
                        <t:template>
                            <tnt:InfoLabel
                                text="{= ${listModel>mcst_excl_flag} === true ? 'Y' : 'N'}"
                                renderMode = "Narrow"
                                displayOnly="true"
                                colorScheme= "{= ${listModel>mcst_excl_flag} === true ? 7 : 3}"
                                visible = "{= ${listModel>mcst_excl_flag} === true ? true : false }" 
                            />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Left" width="8rem">
                        <t:multiLabels>
                            <Label text="{I18N>/MCST_MGT_STATUS}" textAlign="Center" width="100%" />
                            <Label text="{I18N>/QUOTATION}" textAlign="Center" width="100%" />
                        </t:multiLabels>
                        <t:template>
                            <tnt:InfoLabel
                                text="{listModel>quotation_status_name}"
                                renderMode = "Narrow"
                                displayOnly="true"
                                colorScheme= "{
                                    path: 'listModel>quotation_status_code',
                                    formatter: '.formatStatusColor'
                                }"
                                visible = "{= !${listModel>quotation_status_code} ? false : true }" 
                            />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Left" width="8rem">
                        <t:multiLabels>
                            <Label text="{I18N>/MCST_MGT_STATUS}" textAlign="Center" width="100%" />
                            <Label text="{I18N>/TARGETS}" textAlign="Center" width="100%" />
                        </t:multiLabels>
                        <t:template>
                            <tnt:InfoLabel
                                text="{listModel>target_status_name}"
                                renderMode = "Narrow"
                                displayOnly="true"
                                colorScheme= "{
                                    path: 'listModel>target_status_code',
                                    formatter: '.formatStatusColor'
                                }"
                                visible = "{= !${listModel>target_status_code} ? false : true }" 
                            />
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="Left" width="8rem">
                        <t:multiLabels>
                            <Label text="{I18N>/MCST_MGT_STATUS}" textAlign="Center" width="100%" />
                            <Label text="{I18N>/ESTIMATED}" textAlign="Center" width="100%" />
                        </t:multiLabels>
                        <t:template>
                            <tnt:InfoLabel
                                text="{listModel>estimate_status_name}"
                                renderMode = "Narrow"
                                displayOnly="true"
                                colorScheme= "{
                                    path: 'listModel>estimate_status_code',
                                    formatter: '.formatStatusColor'
                                }"
                                visible = "{= !${listModel>estimate_status_code} ? false : true }" 
                            />
                        </t:template>
                    </t:Column>
                </t:columns>
                <t:rowActionTemplate>
                    <t:RowAction>
                        <t:items>
                            <t:RowActionItem type="Navigation" press=".onRowActionPress"></t:RowActionItem>
                        </t:items>
                    </t:RowAction>
                </t:rowActionTemplate>
            </t:Table>
            <!--Part No List 끝-->
        </f:content>
    </f:DynamicPage>
</mvc:View>