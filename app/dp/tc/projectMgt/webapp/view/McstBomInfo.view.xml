<mvc:View controllerName="dp.tc.projectMgt.controller.McstBomInfo" 
    xmlns:mvc="sap.ui.core.mvc" 
    xmlns="sap.m" 
    xmlns:f="sap.f" 
    xmlns:form="sap.ui.layout.form" 
    xmlns:layout="sap.ui.layout"
    xmlns:core="sap.ui.core" 
    xmlns:lib-m="ext.lib.m"
    xmlns:t="sap.ui.table"
    xmlns:tnt="sap.tnt"
    xmlns:uxap="sap.uxap"
    xmlns:block="dp.tc.projectMgt.blocks.mcstproject"
    height="100%">

    <f:DynamicPage id="dpBomInfo" headerExpanded="true" toggleHeaderOnTitleClick="true" class="sapUiSizeCompact">
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                    <HBox alignItems="End">
                        <OverflowToolbarButton type="Transparent" icon="sap-icon://nav-back" press=".onBackPress" />
                        <Title text="{I18N>/BOM} {I18N>/INFORMATION}" wrapping="true"/>
                    </HBox>
                </f:heading>
            </f:DynamicPageTitle>
        </f:title>
 
        <f:header>
            <f:DynamicPageHeader pinnable="true">
                <!--IconTabBar 시작-->
                <IconTabBar
                    id="itbProgress"
                    applyContentPadding="false"
                    class="sapUiNoContentPadding"
                    selectedKey="2"
                    select=".onTabSelect">
                    <items>
                        <IconTabFilter
                            icon="sap-icon://hint"
                            iconColor="Default"
                            design="Horizontal"
                            text="Project Info."
                            key="1" />
                        <IconTabSeparator icon="sap-icon://process" />
                        <IconTabFilter
                            icon="sap-icon://add-product"
                            iconColor="Default"
                            design="Horizontal"
                            text="BOM Info."
                            key="2" />
                        <IconTabSeparator icon="sap-icon://process" />
                        <IconTabFilter
                            icon="sap-icon://expense-report"
                            iconColor="Default"
                            design="Horizontal"
                            text="Net Price Info."
                            key="3" />
                    </items>
                    <content>
                        <VBox width="100%">
                            <form:SimpleForm  
                                editable="true"
                                layout="ResponsiveGridLayout"
                                class="sapUiNoMarginBottom sapUiNoContentPadding">
                                <form:content>

                                <form:SimpleForm  
                                    editable="true"
                                    layout="ResponsiveGridLayout"
                                    class="sapUiNoMarginBottom sapUiNoContentPadding">
                                    <form:content>
                                    
                                    <!--line1-->
                                    <Label text="{I18N>/PROJECT_CODE}">
                                        <layoutData>
                                            <layout:GridData span="XL1 L1 M2 S12" />
                                        </layoutData>
                                    </Label>
                                    <Text text="{detailModel>/project_code}">
                                        <layoutData>
                                            <layout:GridData span="XL2 L2 M2 S12" />
                                        </layoutData>
                                    </Text>

                                    <Label text="{I18N>/PROJECT_NAME}">
                                        <layoutData>
                                            <layout:GridData span="XL1 L1 M2 S12" />
                                        </layoutData>
                                    </Label>
                                    <Text text="{detailModel>/project_name}">
                                        <layoutData>
                                            <layout:GridData span="XL2 L2 M2 S12" />
                                        </layoutData>
                                    </Text>

                                    <Label text="{I18N>/MODEL_CODE}">
                                        <layoutData>
                                            <layout:GridData span="XL1 L1 M2 S12" />
                                        </layoutData>
                                    </Label>
                                    <Text text="{detailModel>/model_code}">
                                        <layoutData>
                                            <layout:GridData span="XL2 L2 M2 S12" />
                                        </layoutData>
                                    </Text>

                                    <Label text="{I18N>/MODEL_NAME}">
                                        <layoutData>
                                            <layout:GridData span="XL1 L1 M2 S12" />
                                        </layoutData>
                                    </Label>
                                    <Text text="{detailModel>/model_name}">
                                        <layoutData>
                                            <layout:GridData span="XL2 L2 M2 S12" />
                                        </layoutData>
                                    </Text>
                                    
                                    <!--line 2-->
                                    <Label text="{I18N>/COMPUT_TYPE}">
                                        <layoutData>
                                            <layout:GridData span="XL1 L1 M2 S12" linebreakL="true"/>
                                        </layoutData>
                                    </Label>
                                    <Text text="{detailModel>/mcst_text/code_name}">
                                        <layoutData>
                                            <layout:GridData span="XL2 L2 M2 S12" />
                                        </layoutData>
                                    </Text>

                                    <Label text="Seq">
                                        <layoutData>
                                            <layout:GridData span="XL1 L1 M2 S12" />
                                        </layoutData>
                                    </Label>
                                    <Text text="{detailModel>/version_sequence}'st ">
                                        <layoutData>
                                            <layout:GridData span="XL2 L2 M2 S12" />
                                        </layoutData>
                                    </Text>

                                    <Label text="{I18N>/REQUESTOR}">
                                        <layoutData>
                                            <layout:GridData span="XL1 L1 M2 S12" />
                                        </layoutData>
                                    </Label>
                                    <Text text="{detailModel>/project_creator_info/user_local_name} {detailModel>/project_creator_info/job_title}">
                                        <layoutData>
                                            <layout:GridData span="XL2 L2 M2 S12" />
                                        </layoutData>
                                    </Text>

                                    <Label text="{I18N>/COMPANY}">
                                        <layoutData>
                                            <layout:GridData span="XL1 L1 M2 S12" />
                                        </layoutData>
                                    </Label>
                                    <Text text="{detailModel>/company_code}">
                                        <layoutData>
                                            <layout:GridData span="XL2 L2 M2 S12" />
                                        </layoutData>
                                    </Text>

                                    <!--line3-->
                                    <Label text="{I18N>/CREATION_DATE}">
                                        <layoutData>
                                            <layout:GridData span="XL1 L1 M2 S12" />
                                        </layoutData>
                                    </Label>
                                    <Text text="{
                                                path: 'detailModel>/project_create_date',
                                                formatter: '.dateFormatter.toUTCDateString'
                                            }">
                                        <layoutData>
                                            <layout:GridData span="XL2 L2 M2 S12" />
                                        </layoutData>
                                    </Text>

                                    <Label text="{I18N>/BUSINESS_DIVISION}">
                                        <layoutData>
                                            <layout:GridData span="XL1 L1 M2 S12" />
                                        </layoutData>
                                    </Label>
                                    <Text text="{detailModel>/bizdivision_text/bizdivision_name}">
                                        <layoutData>
                                            <layout:GridData span="XL2 L2 M2 S12" />
                                        </layoutData>
                                    </Text>

                                    </form:content>

                                    <form:layoutData>
                                        <layout:GridData span="XL10 L10 M10 S12" />
                                    </form:layoutData>
                                
                                </form:SimpleForm>

                                <VBox class="sapUiSmallMarginTop">
                                    <Label text="{I18N>/STATUS}">
                                        <layoutData>
                                            <layout:GridData span="XL1 L1 M6 S12" />
                                        </layoutData>
                                    </Label>
                                    <ObjectStatus class="sapMObjectStatusLarge" text="{detailModel>/mcst_status_text/code_name}" state="Error">
                                        <layoutData>
                                            <layout:GridData span="XL3 L3 M6 S12" />
                                        </layoutData>
                                    </ObjectStatus>
                                    <layoutData>
                                        <layout:GridData span="XL2 L2 M2 S12" />
                                    </layoutData>
                                </VBox>

                                </form:content>
                            </form:SimpleForm>
                        </VBox>                        
                    </content>
                </IconTabBar>
                <!--IconTabBar 끝-->
            </f:DynamicPageHeader>
        </f:header>

        <f:content>
            <!--BOM List 시작-->
            <t:Table id="tblPartListTable" 
                    noData="{I18N>/NCM01004}"
                    rows="{partListModel>/PartListView}"
                    selectionMode="MultiToggle"
                    selectionBehavior="Row"
                    visibleRowCountMode="Auto"
                    columnResize=""
                    cellClick=""
                    rowSelectionChange=""
                    width="auto">
                <t:extension>
                    <OverflowToolbar>
                        <Title text="{I18N>/BOM} {I18N>/LIST} ({= ${partListModel>/PartListView}.length || 0 })" level="H2"/>
                        <ToolbarSpacer/>
                        <Button text="{I18N>/ROW_ADD}" type="Transparent" press=".onPartListAddButtonPress" enabled="{= ${detailModel>/mcst_status_code} === 'CONFIRMED' ? false : true}"/>
                        <Button text="{I18N>/ROW_DELETE}" type="Transparent" press=".onPartListDeleteButtonPress" enabled="{= ${detailModel>/mcst_status_code} === 'CONFIRMED' ? false : true}"/>
                        <Button text="{I18N>/COMPARE_BOM}" type="Transparent" press=".onCompareBomPress" enabled="{= ${detailModel>/mcst_status_code} === 'CONFIRMED' ? false : true}"/>
                        <Button text="{I18N>/BOM_MAPPING}" type="Transparent" press=".onBomInfoMappingPress" enabled="{= ${detailModel>/mcst_status_code} === 'CONFIRMED' ? false : true}"/>
                        <Button text="{I18N>/BOM}{I18N>/INFORMATION}" type="Transparent" press=".onBomInfo" enabled="{= ${detailModel>/mcst_status_code} === 'CONFIRMED' ? false : true}"/>
                        <ToolbarSeparator/>
                        <Button text="Search" type="Emphasized" press=".onSearchButtonPress" />
                        <Button text="Save" type="Emphasized" press=".onDraftPress" enabled="{= ${detailModel>/mcst_status_code} === 'CONFIRMED' ? false : true}"/>
                        <Button text="Save &amp; Next" type="Emphasized" press=".onSaveNext" enabled="{= ${detailModel>/mcst_status_code} === 'CONFIRMED' ? false : true}"/>
                        <ToolbarSeparator/>
                        <Button icon="sap-icon://upload" press=".onImportSheet" enabled="{= ${detailModel>/mcst_status_code} === 'CONFIRMED' ? false : true}"/>
                        <Button icon="sap-icon://excel-attachment" press=".onExportSheet"/>
                        <!-- <Button icon="sap-icon://group-2" press=""/>
                        <Button icon="sap-icon://action-settings" press=""/> -->
                    </OverflowToolbar>
                </t:extension>
                <t:columns>
                    <t:Column id="mainColumnState" hAlign="Center" width="2em" >
                        <ObjectStatus icon="sap-icon://document" text="State" visible="false" />
                        <t:template>
							<ObjectStatus icon="{
                                path: 'partListModel>_row_state_',
                                formatter: '.formatter.toModelStateColumnIcon'
                            }" />
						</t:template>
                    </t:Column>
                    <t:Column hAlign="Left" width="8%" >
                        <Label text="{I18N>/MATERIAL_CODE}" required="true" textAlign="Center" width="100%"/>
                        <t:template>
                            <HBox justifyContent="Begin">
                                <Text text="{partListModel>material_code}" textAlign="Left" width="100%" visible="{= ${partListModel>_row_state_} === 'C' ? false : true }" />
                                <Input placeholder="Choose codes from the ValueHelp"
                                            value="{partListModel>material_code}"
                                            showValueHelp="true"
                                            change=".onMatCodeChange"
                                            valueHelpRequest=".onMaterialCodeValueHelpPress"
                                            visible="{= ${partListModel>_row_state_} === 'C' ? true : false }" />
                            </HBox>
						</t:template>
                    </t:Column>
                    <t:Column hAlign="Left" width="auto" >
                        <Label text="{I18N>/MATERIAL_DESC}" required="true" textAlign="Center" width="100%"/>
                        <t:template>
							<Text text="{partListModel>material_desc}"/>
						</t:template>
                    </t:Column>
                    <t:Column hAlign="Left" width="10em" >
                        <Label text="{I18N>/UNIT}" required="true" textAlign="Center" width="100%"/>
                        <t:template>
                            <HBox justifyContent="Begin">
                                <Text text="{partListModel>uom_name}" textAlign="Center" visible="{= ${partListModel>_row_state_} === 'C' ? false : true }"/>
                                <!-- <Input value="{partListModel>uom_name}" visible="{= ${partListModel>_row_state_} === 'C' ? true : false }"/> -->
                                <ComboBox
                                    width="100%"
                                    selectedKey="{partListModel>uom_code}"
                                    visible="{= ${partListModel>_row_state_} === 'C' ? true : false }"
                                    items="{
                                        path: '/MM_UOM',
                                        filters: [
                                            {path: 'tenant_id', operator: 'EQ', value1: 'L2100'}
                                        ],
                                        sorter: { path: 'uom_name'}
                                    }">
                                    <items>
                                        <core:Item key="{uom_code}" text="{uom_name}" />
                                    </items>
                                </ComboBox>
                            </HBox>
						</t:template>
                    </t:Column>
                    <t:Column hAlign="End" width="8em" >
                        <Label text="{I18N>/REQ_QTY}" required="true" textAlign="Center" width="100%" />
                        <t:template>
                            <HBox justifyContent="End">
                                <!-- <Text text="{
                                        path : 'partListModel>material_reqm_quantity',
                                        formatter : '.numberFormatter.toNumberString'
                                      }"
                                    textAlign="End" visible="{= ${partListModel>_row_state_} === 'C' ? false : true }"/> -->
                                <Input type="Number" textAlign="End" value="{partListModel>material_reqm_quantity}" />
                            </HBox>
						</t:template>
                    </t:Column>
                    <t:Column hAlign="Center" width="8em" >
                        <Label text="{I18N>/CHANGE_INFO}" />
                        <t:template>
                            <tnt:InfoLabel
                                text="{partListModel>change_info_text}"
                                visible="{= ${partListModel>change_info_text} ? true : false }"
                                renderMode = "Narrow"
                                displayOnly="true"
                                colorScheme= "{= ${partListModel>change_info_text} === 'New' || ${partListModel>change_info_text} === 'Old' ? 1 :  ${partListModel>change_info_text} === 'Add' ? 9 : 3}"
                            />
						</t:template>
                    </t:Column>
                    <t:Column hAlign="Center" width="10%" >
                        <Label text="{I18N>/REQ_QTY_DIFFERENCE}" />
                        <t:template>
                            <HBox>
                                <Text text="{partListModel>material_reqm_diff_quantity}"/>
                            </HBox>
						</t:template>
                    </t:Column>
                    <t:Column hAlign="Left" width="15%" >
                        <Label text="{I18N>/MAPPING_RSN}" textAlign="Center" width="100%"/>
                        <t:template>
                            <!-- <Text text="{partListModel>eng_change_number}"/> -->
                            <Link
                                text="{partListModel>change_reason}"
                                emphasized="true"
                                press=".onChangeNumberLinkPress" />
						</t:template>
                    </t:Column>
                </t:columns>
            </t:Table>
            <!--BOM List 끝-->
        </f:content>

    </f:DynamicPage>

</mvc:View>