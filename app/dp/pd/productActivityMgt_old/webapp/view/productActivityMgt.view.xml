<mvc:View controllerName="dp.pd.productActivityMgt.controller.ProductActivityMgt"
    xmlns:mvc="sap.ui.core.mvc" 
    xmlns="sap.m" 
    xmlns:f="sap.f" 
    xmlns:form="sap.ui.layout.form" 
    xmlns:layout="sap.ui.layout" 
    xmlns:core="sap.ui.core" 
    xmlns:lib-m="ext.lib.m"
    height="100%">

    <f:DynamicPage id="page"  toggleHeaderOnTitleClick="true" headerExpanded="true" >
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                    <Title text="{I18N>/PRODUCT} {I18N>/ACTIVITY} {I18N>/MANAGEMENT}" />
                </f:heading>
                <!-- 즐겨찾기 -->
                <f:navigationActions>
                    <Button icon="sap-icon://unfavorite" type="Transparent" />
                </f:navigationActions>
            </f:DynamicPageTitle>
        </f:title>
        <!-- DynamicPage Header -->
        <f:header>
            <f:DynamicPageHeader pinnable="true">
                <form:SimpleForm id="pageSearchFormS" maxContainerCols="2" editable="true" layout="ResponsiveGridLayout" adjustLabelSpan="false" labelSpanL="4" labelSpanM="4" emptySpanL="0" emptySpanM="0" columnsL="2" columnsM="2">
                    <form:content>
                        <VBox>
                            <Label text="{I18N>/BUSINESS_UNIT}: " labelFor="searchPdOperationOrg" required="true"></Label>
                            
                            
                            <ComboBox id="searchPdOperationOrg" width="100%"  
                                items="{
                                    path: '/PdOperationOrg',
                                    sorter: { path: 'operation_org_code' }
                                }">
                                <core:Item key="{operation_org_code}" text="[{operation_org_code}] {operation_org_name}" />
                            </ComboBox>
                            <!--
                            <MultiComboBox id="searchPdOperationOrg" width="100%"  required="true" items="{
                                path: '/PdOperationOrg',
                                filters: [],
                                sorter: { path: 'operation_org_code'}
                                }">
                                <items>
                                    <core:Item key="{operation_org_code}" text="[{operation_org_code}] {operation_org_name}" />
                                </items>
                            </MultiComboBox>
                            -->
                            <layoutData>
                                <layout:GridData span="XL2 L3 M6 S12" />
                            </layoutData>
                        </VBox>
                        <VBox>
                            <Label text="{I18N>/STATUS}: " labelFor="searchStatusButton"></Label>
                            <SegmentedButton id="searchStatusButton" selectedKey="all" class="sapUiSmallMarginBottom" width="100%" >
                                <items>
                                    <SegmentedButtonItem text="All" key="all" width="3rem" />
                                    <SegmentedButtonItem text="Active" key="true" width="5rem" />
                                    <SegmentedButtonItem text="Inactive" key="false" width="5rem" />
                                </items>
                            </SegmentedButton>
                            <layoutData>
                                <layout:GridData span="XL6 L6 M12 S12" />
                            </layoutData>
                        </VBox>
                    </form:content>
                </form:SimpleForm>
                <HBox width="100%" alignItems="Center" alignContent="End" justifyContent="End">
                    <items>
                        <Button id="pageSearchButton" text="{I18N>/SEARCH}" type="Emphasized" press=".onSearch"/>
                    </items>
                </HBox>
            </f:DynamicPageHeader>
        </f:header>
        <f:content>
            <VBox>
                <Table id="mainTable"
                    mode="MultiSelect" 
                    sticky="HeaderToolbar,ColumnHeaders" 
                    noDataText="{I18N>/NCM01004}"
                    updateFinished=".onMainTableUpdateFinished"
                    items="{
                    path: 'list>/PdProdActivityTemplate'
                    }"
                    selectionChange=".onSelectionChange" 
                    width="auto"
                    growing="true"
                    growingThreshold="9"
                    growingScrollToLoad="false" >
                    <headerToolbar>
                        <OverflowToolbar class="sapFDynamicPageAlignContent">
                            <Title id="mainTableTitle" text=" " level="H2"/>
                            <ToolbarSpacer/>
                            <Button text="{I18N>/ROW_ADD}" id="buttonMainAddRow" press=".onAdd('mainTable', 'list', 'PdProdActivityTemplate', 'tenant_id')"  type="Transparent"/>
                            <Button text="{I18N>/DELETE}" id="buttonMainDeleteRow" press=".onDelete"   type="Transparent" enabled="true" />
                            <Button text="{I18N>/CANCEL}" id="buttonMainCancelRow" press=".onCancel"  type="Transparent" enabled="false"/>
                            <Button text="{I18N>/SAVE}" id="buttonSaveProc" press=".onSave"   type="Emphasized"/>
                            <ToolbarSeparator/>
                            <Button id="gTableExportButton" text="" type="Transparent" press=".onExportPress" class="sapUiTinyMargin" icon="sap-icon://excel-attachment" />
                            <Button icon="sap-icon://action-settings" press=".onPersoButtonPressed" >
                                <layoutData>
                                    <OverflowToolbarLayoutData priority="NeverOverflow" />
                                </layoutData>
                            </Button>
                        </OverflowToolbar>
                    </headerToolbar>

                    <columns>
                        <Column id="stat" minScreenWidth="Tablet" hAlign="Left" width="1.5rem"/>
                        <Column id="orgCode" minScreenWidth="Tablet" hAlign="Left" >
                            <Text text="{I18N>/ORG_CODE}" />
                        </Column>
                        <Column id="productActivityCode" minScreenWidth="Tablet" hAlign="Left" >
                            <Text text="{I18N>/PRODUCT} {I18N>/ACTIVITY} {I18N>/CODE}" />
                        </Column>
                        <Column id="productActivityHan" minScreenWidth="Tablet" hAlign="Left">
                            <Text text="{I18N>/PRODUCT} {I18N>/ACTIVITY}" />
                        </Column>
                        <Column id="productActivityEnd" minScreenWidth="Tablet" hAlign="Left">
                            <Text text="{I18N>/PRODUCT} {I18N>/ACTIVITY} {I18N>/DETAIL}" />
                        </Column>
                        <Column id="milestone" minScreenWidth="Tablet" hAlign="Left" width="7rem">
                            <Text text="{I18N>/MILESTONE}" />
                        </Column>
                        <Column id="status" minScreenWidth="Tablet" hAlign="Left" width="7rem">
                            <Text text="{I18N>/STATUS}" />
                        </Column>
                        <Column id="updateDate" minScreenWidth="Tablet" hAlign="Left" width="10rem">
                            <Text text="{I18N>/DATE_TIME}" />
                        </Column>
                        <Column id="updateUser" minScreenWidth="Tablet" hAlign="Left" width="10rem">
                            <Text text="{I18N>/UPDATE_USER_ID}" />
                        </Column>
                    </columns>

                    <items>
                        <ColumnListItem>
                            <cells>
                                <HBox>
                                    <ObjectStatus icon="sap-icon://document" text="State" visible="false" />
                                    <ObjectStatus icon="{
                                        path: 'list>_row_state_',
                                        formatter: '.formatter.toModelStateColumnIcon'
                                    }" />
                                </HBox>
                                <HBox>
                                    <Text text="{list>org_code}" ></Text>
                                </HBox>
                                <HBox>
                                    <Text text="{list>product_activity_code}" ></Text>
                                    <Input value="{list>product_activity_code}" visible="false" required="true"></Input>
                                    <Input value="{list>product_activity_code_ori}" visible="false"></Input>
                                </HBox>
                                <HBox>
                                    <Text text="{list>product_activity_name}" visible="true"></Text>
                                    <Input value="{list>product_activity_name}" visible="false" required="true"></Input>
                                </HBox>
                                <HBox>
                                    <Text text="{list>product_activity_english_name}" visible="true"></Text>
                                    <Input value="{list>product_activity_english_name}" visible="false"></Input>
                                </HBox>
                                <HBox>
                                    <Text text="{list>milestone_flag}" visible="false"></Text>
                                    <Input value="{list>milestone_flag}" visible="false"></Input>
                                    <ToggleButton  enabled="false" pressed="{list>milestone_flag}" press=".onMilestoneButtonPress">
                                        <layoutData>
                                            <FlexItemData growFactor="1" />
                                        </layoutData>
                                    </ToggleButton>
                                </HBox>
                                <HBox>
                                    <Text text="{list>active_flag}" visible="false"></Text>
                                    <Input value="{list>active_flag}" visible="false" required="true"></Input>
                                    <ToggleButton  enabled="false" pressed="{list>active_flag}"  press=".onActiveButtonPress">
                                        <layoutData>
                                            <FlexItemData growFactor="1" />
                                        </layoutData>
                                    </ToggleButton>
                                </HBox>
                                <HBox>
                                    <Text text="{path : 'list>local_update_dtm', formatter: '.dateFormatter.toUTCDateTimeString'}"></Text>
                                </HBox>
                                <HBox>
                                    <Text text="{list>update_user_id}" visible="true"></Text>
                                </HBox>
                            </cells>
                        </ColumnListItem>
                    </items>

                </Table>
            </VBox>
        </f:content>
    </f:DynamicPage>
</mvc:View>