<mvc:View controllerName="dp.pd.categoryCreationRequestMgt.controller.Selection" 
	xmlns:mvc="sap.ui.core.mvc"
    xmlns:uxap="sap.uxap"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:form="sap.ui.layout.form"
    xmlns:layout="sap.ui.layout"
    xmlns:core="sap.ui.core"
    xmlns:lib-m="ext.lib.m"
    xmlns:t="sap.ui.table"
    xmlns:co="sap.suite.ui.commons"
    xmlns:rte="sap.ui.richtexteditor"
    height="100%">

    <uxap:ObjectPageLayout
        id="midObjectForm"
        showTitleInHeaderContent="true"
		showEditHeaderButton="true"
        upperCaseAnchorBar="false"
        headerContentPinnable="true"
        showAnchorBarPopover="false"
        showFooter="true">

		<uxap:headerTitle>
			<uxap:ObjectPageDynamicHeaderTitle>
				<uxap:expandedHeading>
                    <HBox alignItems="End">
                        <OverflowToolbarButton id="pageNavBackButton" type="Transparent" icon="sap-icon://nav-back" press=".onPageNavBackButtonPress" />
                        <Title text="{I18N>/PART_CATEGORY_CREATION_REQUEST}" wrapping="true" />
                    </HBox>
				</uxap:expandedHeading>
			</uxap:ObjectPageDynamicHeaderTitle>
		</uxap:headerTitle>

		<uxap:headerContent>
            <FlexBox wrap="Wrap">
                <!-- Requester 시작 -->
                <layout:VerticalLayout class="sapUiLargeMarginBeginEnd">
                    <ObjectStatus title="{I18N>/REQUEST_NUMBER}" text="{master>/request_number}"/>
                    <ObjectStatus title="{I18N>/REQUESTOR}" text="{master>/requestor}"/>
                </layout:VerticalLayout>
                <!-- Requester 끝 -->

                <!-- Status 시작 -->
				<layout:VerticalLayout class="sapUiLargeMarginBeginEnd">
					<Label text="{I18N>/PROGRESS}{I18N>/STATUS}:"/>
                    <VBox visible="{= ${master>/request_number}==='new'?true:false}">
                        <ObjectStatus class="sapMObjectStatusLarge" text="NEW" state="Error" />
                    </VBox>
                    <VBox visible="{= ${master>/progress_status_code}==='A'?true:false}">
                        <ObjectStatus class="sapMObjectStatusLarge" text="{processModel>/0/code_name}" state="Error" />
                    </VBox>
                    <VBox visible="{= ${master>/progress_status_code}==='B'?true:false}">
                        <ObjectStatus class="sapMObjectStatusLarge" text="{processModel>/1/code_name}" state="Error" />
                    </VBox>
                    <VBox visible="{= ${master>/progress_status_code}==='C'?true:false}">
                        <ObjectStatus class="sapMObjectStatusLarge" text="{processModel>/2/code_name}" state="Error" />
                    </VBox>
                    <VBox visible="{= ${master>/progress_status_code}==='D'?true:false}">
                        <ObjectStatus class="sapMObjectStatusLarge" text="{processModel>/3/code_name}" state="Error" />
                    </VBox>
                    <VBox visible="{= ${master>/progress_status_code}==='E'?true:false}">
                        <ObjectStatus class="sapMObjectStatusLarge" text="{processModel>/4/code_name}" state="Error" />
                    </VBox>
                    <VBox visible="{= ${master>/progress_status_code}==='F'?true:false}">
                        <ObjectStatus class="sapMObjectStatusLarge" text="{processModel>/5/code_name}" state="Error" />
                    </VBox>
				</layout:VerticalLayout>
                <!-- Status 끝 -->
                
                <!-- Process 시작 -->
                <!-- <layout:VerticalLayout class="sapUiLargeMarginBeginEnd">
                    <HBox>
					    <Label text="{I18N>/PROCESS} : "/>
                    </HBox>
                    <HBox>
                        <co:MicroProcessFlow>
                            <co:content>
                                <co:MicroProcessFlowItem stepWidth="2rem" >
                                    <co:customControl>
                                        <VBox alignItems="Center">
                                            <core:Icon src="{detailViewModel>/processFlowIcons/0}" color="{detailViewModel>/processFlowColors/0}"/>
                                            <Text text="{processModel>/0/code_name}" textAlign="Center" class=""/>
                                        </VBox>
                                    </co:customControl>
                                </co:MicroProcessFlowItem>
                                <co:MicroProcessFlowItem stepWidth="2rem" >
                                    <co:customControl>
                                        <VBox alignItems="Center">
                                            <core:Icon src="{detailViewModel>/processFlowIcons/1}" color="{detailViewModel>/processFlowColors/1}"/>
                                            <Text text="{processModel>/1/code_name}" textAlign="Center" class=""/>
                                        </VBox>
                                    </co:customControl>
                                </co:MicroProcessFlowItem>
                                <co:MicroProcessFlowItem stepWidth="2rem" >
                                    <co:customControl>
                                        <VBox alignItems="Center">
                                            <core:Icon src="{detailViewModel>/processFlowIcons/2}" color="{detailViewModel>/processFlowColors/2}"/>
                                            <Text text="{processModel>/2/code_name}" textAlign="Center" class=""/>
                                        </VBox>
                                    </co:customControl>
                                </co:MicroProcessFlowItem>
                                <co:MicroProcessFlowItem stepWidth="2rem" >
                                    <co:customControl>
                                        <VBox alignItems="Center">
                                            <core:Icon src="{detailViewModel>/processFlowIcons/3}" color="{detailViewModel>/processFlowColors/3}"/>
                                            <Text text="{processModel>/3/code_name}" textAlign="Center" class=""/>
                                        </VBox>
                                    </co:customControl>
                                </co:MicroProcessFlowItem>
                                <co:MicroProcessFlowItem stepWidth="2rem" >
                                    <co:customControl>
                                        <VBox alignItems="Center">
                                            <core:Icon src="{detailViewModel>/processFlowIcons/3}" color="{detailViewModel>/processFlowColors/3}"/>
                                            <Text text="{processModel>/4/code_name}" textAlign="Center" class=""/>
                                        </VBox>
                                    </co:customControl>
                                </co:MicroProcessFlowItem>
                                <co:MicroProcessFlowItem stepWidth="2rem" >
                                    <co:customControl>
                                        <VBox alignItems="Center">
                                            <core:Icon src="{detailViewModel>/processFlowIcons/3}" color="{detailViewModel>/processFlowColors/3}"/>
                                            <Text text="{processModel>/5/code_name}" textAlign="Center" class=""/>
                                        </VBox>
                                    </co:customControl>
                                </co:MicroProcessFlowItem>
                            </co:content>
                        </co:MicroProcessFlow>
                    </HBox>
				</layout:VerticalLayout> -->
                <!-- Process 끝 -->
                
			</FlexBox>
		</uxap:headerContent>

		<uxap:sections>
            <!-- General Information 시작 -->
			<uxap:ObjectPageSection id="pageSectionMain" titleUppercase="false" title="{I18N>/BASIC_INFO}">
				<uxap:subSections>
                    <uxap:ObjectPageSubSection>
                        <form:SimpleForm width="100%">
                                <layout:Grid containerQuery="true" defaultSpan="XL12 L12">
                                    <VBox width="100%">
                                        <Label
                                            text="{I18N>/CATEGORY_GROUP}:"
                                            class="sapUiTinyMarginEnd"
                                            textAlign="Left"
                                            labelFor="input"
                                            required="true"/>
                                        <ComboBox
                                            selectionChange="onSelectionChange"
                                            width="50%"
                                            visible="{viewModel>/editMode}"
                                            id="categoryGroupCodeCombo"
                                            showSecondaryValues= "true"
                                            selectedKey="{master>/category_group_code}"
                                            items="{
                                                path: 'common>/Code',
                                                filters: [
                                                    {path: 'group_code', operator: 'EQ', value1: 'DP_PD_CATEGORY_GROUP'}
                                                ]
                                            }">
                                            <items>
                                                <core:ListItem
                                                    key="{common>code}" 
                                                    text="{common>code_name}" 
                                                    additionalText="{common>code}"/>
                                            </items>
                                        </ComboBox>
                                        <Text id="categoryGroupCodeTx" text="{master>/category_group_code}" visible="{viewModel>/showMode}" width="50%"/>
                                    
                                        <Label
                                            text="{I18N>/REQUEST_TITLE}:"
                                            class="sapUiTinyMarginEnd"
                                            textAlign="Left"
                                            labelFor="input"
                                            required="true"/>
                                        <Input id="requestTitle" value="{master>/request_title}" visible="{viewModel>/editMode}" width="50%" liveChange="onLiveChange" />
                                        <Text id="requestTitleTx" text="{master>/request_title}" visible="{viewModel>/showMode}" width="50%"/>
                                    
                                        <Label
                                            text="{I18N>/REQUEST_CATEGORY_NAME}:"
                                            class="sapUiTinyMarginEnd"
                                            textAlign="Left"
                                            labelFor="input"
                                            required="true"/>
                                        <Input id="requestCategoryName" value="{master>/request_category_name}" visible="{viewModel>/editMode}" width="50%" liveChange="onLiveChange" />
                                        <Text id="requestCategoryNameTx" text="{master>/request_category_name}" visible="{viewModel>/showMode}" width="50%"/>
                                        
                                        <Label
                                            text="{I18N>/SIMILAR_CATEGORY}: "
                                            class="sapUiTinyMarginEnd"
                                            textAlign="Left"
                                            labelFor="input"
                                            required="true"/>
                                        <SearchField id="similarCategoryCode" value="{master>/similar_category_name} [{master>/similar_category_code}]" search=".onSearchPartCategory"  visible="{viewModel>/editMode}" width="50%" liveChange="onLiveChange" />
                                        <Text id="similarCategoryCodeTx" text="{master>/similar_category_name} [{master>/similar_category_code}]" visible="{viewModel>/showMode}" width="50%" />
                                        
                                        <Label text="{I18N>/DESCRIPTION}: " required="true"/>
                                        <!-- Text Editor 시작 -->
                                        <rte:RichTextEditor
                                            id="richTextEditor"
                                            width="100%"
                                            height="300px" 
                                            value="{master>/request_desc}" 
                                            customToolbar="true" 
                                            showGroupFont="true" 
                                            showGroupLink="true" 
                                            showGroupInsert="true"
                                            editorType="TinyMCE4"
                                            visible="{viewModel>/editMode}">
                                        </rte:RichTextEditor>
                                        <!-- Text Editor 끝 -->
                                        <FormattedText height="200px" htmlText="{= ${master>/request_desc} ? ${master>/request_desc} : '' }" visible="{= !${viewModel>/editMode}}" width="100%"/>
                                        
                                    </VBox>
                                </layout:Grid>
                        </form:SimpleForm>

					</uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>
            <!-- General Information 끝 -->

            <!-- 첨부파일 시작 -->
			<uxap:ObjectPageSection titleUppercase="false" title="{I18N>/Attachments}">
				<uxap:subSections>
					<uxap:ObjectPageSubSection>
						<uxap:blocks>
                            <!-- File Upload 시작-->
                            <UploadCollection
                                id="UploadCollection"
                                maximumFilenameLength="55"
                                maximumFileSize="10"
                                multiple="true"
                                sameFilenameAllowed="true"
                                instantUpload="false"
                                noDataDescription="Drop files or use the &quot;Add&quot; button to keep files ready for upload"
                                change="onChange"
                                fileDeleted="onFileDeleted"
                                filenameLengthExceed="onFilenameLengthExceed"
                                fileSizeExceed="onFileSizeExceed"
                                typeMissmatch="onTypeMissmatch"
                                uploadComplete="onUploadComplete"
                                beforeUploadStarts="onBeforeUploadStarts" />
                            <!-- File Upload 끝-->
						</uxap:blocks>
					</uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>
            <!-- 첨부파일 끝 -->

            <!-- 결재라인 시작 -->
			<uxap:ObjectPageSection titleUppercase="false" title="{I18N>/APPROVAL_LINE}">
				<uxap:subSections>
					<uxap:ObjectPageSubSection>
                        <uxap:blocks>
                            <Table id="detailsTable"
                                growing="true"
                                growingThreshold="20"
                                class="sapFDynamicPageAlignContent" 
                                updateFinished=".onListMainTableUpdateFinished"
                                mode="SingleSelectMaster"
                                width="auto"
                                items="{details>/PdCategoryApprovalType}">
                                <headerToolbar>
                                    <OverflowToolbar>
                                        <Label text="{I18N>/APPROVAL_LINE}"/>
                                    </OverflowToolbar>
                                </headerToolbar>
                                <columns>
                                    <Column minScreenWidth="Tablet" hAlign="Center">
                                        <Text text="{I18N>/TENANT_ID}" />
                                    </Column>
                                    <Column minScreenWidth="Tablet" hAlign="Center">
                                        <Text text="{I18N>/REQUEST_NUMBER}" />
                                    </Column>
                                    <Column minScreenWidth="Tablet" hAlign="Center">
                                        <Text text="{I18N>/APPROVE} {I18N>/SEQUENCE}" />
                                    </Column>
                                    <Column minScreenWidth="Tablet" hAlign="Center">
                                        <Text text="{I18N>/APPROVAL_NUMBER}" />
                                    </Column>
                                    <Column minScreenWidth="Tablet" hAlign="Center">
                                        <Text text="{I18N>/REQUESTOR_EMPNO}" />
                                    </Column>
                                    <Column minScreenWidth="Tablet" hAlign="Center">
                                        <Text text="TF_FLAG" />
                                    </Column>
                                    <Column minScreenWidth="Tablet" hAlign="Center">
                                        <Text text="{I18N>/APPROVAL} {I18N>/COMMENT}" />
                                    </Column>
                                    <Column minScreenWidth="Tablet" hAlign="Center">
                                        <Text text="{I18N>/APPROVE_DATE}" />
                                    </Column>
                                    <Column minScreenWidth="Tablet" hAlign="Center">
                                        <Text text="{I18N>/UPDATE_USER_ID}" />
                                    </Column>
                                    <Column minScreenWidth="Tablet" hAlign="Center">
                                        <Text text="{I18N>/ROW_ADD}" />
                                    </Column>
                                    <Column minScreenWidth="Tablet" hAlign="Center">
                                        <Text text="{I18N>/ROW_DELETE}" />
                                    </Column>
                                </columns>
                                <items>
                                    <ColumnListItem type="Active" press=".onItemPress">
                                        <cells>
                                            <Input value="{details>tenant_id}" />
                                            <Input value="{details>request_number}" />
                                            <Input value="{details>approve_sequence}" />
                                            <Input value="{details>approval_number}" />
                                            <Input value="{details>requestor_empno}" />
                                            <Input value="{details>tf_flag}" />
                                            <Input value="{details>approval_comment}" />
                                            <Input value="{details>approve_date_time}" />
                                            <Input value="{details>update_user_id}" />

                                            <Button icon="sap-icon://sys-add" press=".onApproverAdd(${details>approve_sequence})" tooltip="add" />
                                            <Button icon="sap-icon://delete" press=".setApproverRemoveRow(${details>approve_sequence})" tooltip="delete" />
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>

                        </uxap:blocks>
					</uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>
            <!-- 결재라인 끝 -->

		</uxap:sections>
		        
        <!-- footer 시작 -->
        <uxap:footer>
            <OverflowToolbar>
                <ToolbarSpacer />
                <HBox visible="{= ${master>/request_number} === 'new' ? true : false}" alignItems="End" justifyContent="End">
                    <Button id="pageNSaveButton" type="Transparent" text="{I18N>/TEMP_SAVE}" press=".onPageSaveButtonPress('D')" />
                    <!-- <Button id="pageNCancelButton" type="Transparent" text="{I18N>/CANCEL}" press=".onPageCancelButtonPress('N')"/> -->
                    <Button id="pageNListButton" type="Transparent" text="{I18N>/LIST}" press=".onPageListButtonPress"/>
                    <Button id="pageNSubmitButton" type="Emphasized" text="{I18N>/REQUEST}" press=".onPageSaveButtonPress('R')" />
                </HBox>

                <HBox visible="{= ${master>/progress_status_code} === 'A' ? true : false}" alignItems="End" justifyContent="End">
                    <Button id="pageEditButton" type="Transparent" text="{I18N>/UPDATE}" press=".onPageEditButtonPress" />
                    <Button id="pageASaveButton" type="Transparent" text="{I18N>/TEMP_SAVE}" press=".onPageSaveButtonPress('D')" />
                    <Button id="pageACancelButton" type="Transparent" text="{I18N>/CANCEL}" press=".onPageCancelButtonPress"/>
                    <Button id="pageADeleteButton" type="Transparent" text="{I18N>/DELETE}" press=".onPageSaveButtonPress('DL')"/>
                    <Button id="pageAListButton" type="Transparent" text="{I18N>/LIST}" press=".onPageListButtonPress"/>
                    <Button id="pageASubmitButton" type="Emphasized" text="{I18N>/REQUEST}" press=".onPageSaveButtonPress('R')" />
                </HBox>

                <HBox visible="{= ${master>/progress_status_code} === 'B' ? true : false}" alignItems="End" justifyContent="End">
                    <Button id="pageBListButton" type="Transparent" text="{I18N>/LIST}" press=".onPageListButtonPress"/>
                    <Button id="pageApprovalButton" type="Emphasized" text="{I18N>/APPROVAL}" press=".onPageSaveButtonPress('A')" />
                    <Button id="pageRejectButton" type="Transparent" text="{I18N>/REJECT}" press=".onPageSaveButtonPress('E')"/>
                </HBox>

                <HBox visible="{= ${master>/progress_status_code} === 'C' ? true : false}" alignItems="End" justifyContent="End">
                    <Button id="pageRejectButton2" type="Transparent" text="{I18N>/CANCEL}" press=".onPageSaveButtonPress('F')"/>
                    <Button id="pageCListButton" type="Transparent" text="{I18N>/LIST}" press=".onPageListButtonPress"/>
                    <Button id="pageConfirmButton" type="Emphasized" text="{I18N>/CONFIRM_CREATE}" press=".onPageSaveButtonPress('C')" />
                </HBox>

                <HBox visible="{= ${master>/progress_status_code} === 'E' ? true : false}" alignItems="End" justifyContent="End">
                    <Button id="pageEListButton" type="Transparent" text="{I18N>/LIST}" press=".onPageListButtonPress"/>
                </HBox>

                <HBox visible="{= ${master>/progress_status_code} === 'F' ? true : false}" alignItems="End" justifyContent="End">
                    <Button id="pageFListButton" type="Transparent" text="{I18N>/LIST}" press=".onPageListButtonPress"/>
                </HBox>

                <HBox visible="{= ${master>/progress_status_code} === 'D' ? true : false}" alignItems="End" justifyContent="End">
                    <Button id="pageDListButton" type="Transparent" text="{I18N>/LIST}" press=".onPageListButtonPress"/>
                </HBox> 
            </OverflowToolbar>
		</uxap:footer>
        <!-- footer 끝 -->
	</uxap:ObjectPageLayout>
</mvc:View>