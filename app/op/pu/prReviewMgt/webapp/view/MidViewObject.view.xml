<mvc:View controllerName="op.pu.prReviewMgt.controller.MidViewObject" 
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:uxap="sap.uxap"
    xmlns:form="sap.ui.layout.form" 
    xmlns:f="sap.ui.layout.form" 
    xmlns:core="sap.ui.core" 
    xmlns:layout="sap.ui.layout"
    xmlns:tnt="sap.tnt"
    xmlns:co="sap.suite.ui.commons"
    xmlns:si="sap.suite.ui.commons.statusindicator"
    xmlns:u="sap.ui.unified" 
    xmlns:table="sap.ui.table" 
    xmlns="sap.m"
    height="100%"
>
	<uxap:ObjectPageLayout 
        id="page"
		showTitleInHeaderContent="true"
		showEditHeaderButton="true" 
        upperCaseAnchorBar="false"
		showFooter="true"
		editHeaderButtonPress="handleEditBtnPress" >

		<uxap:headerTitle>
			<uxap:ObjectPageDynamicHeaderTitle>
				<uxap:expandedHeading>
					<Title text="(미정)구매요청 검토" wrapping="true" />
				</uxap:expandedHeading>
                <uxap:navigationActions>
                    <!-- 전체화면 -->
                    <!-- visible="{= ${midObjectView>/screen} !== 'Full' }" -->
                    <OverflowToolbarButton 
                        icon="sap-icon://full-screen" 
                        type="Transparent"
                        tooltip="Enter Full Screen Mode"
                        visible="true"
                        press=".onOverflowToolbarButtonPress($event, 'navigation', { action: 'Full', column: 'two' })"
                    /> 
                    <!-- 전체화면해제 -->
                    <!-- visible="{= ${midObjectView>/screen} === 'Full' }" -->
                    <OverflowToolbarButton 
                        icon="sap-icon://exit-full-screen" 
                        type="Transparent"
                        tooltip="Exit Full Screen Mode" 
                        visible="true"
                        press=".onOverflowToolbarButtonPress($event, 'navigation', { action: 'Exit', column: 'two' })"
                    /> 
                    <!-- 뒤로가기 -->
                    <!-- visible="{= ${/actionButtonsInfo/midColumn/closeColumn} !== null }" -->
                    <OverflowToolbarButton 
                        icon="sap-icon://decline" 
                        type="Transparent"
                        text="back" 
                        tooltip="Back to the list" 
                        press=".onOverflowToolbarButtonPress($event, 'navigation', { action: 'NavBack', column: 'two' })"
                    />
                </uxap:navigationActions>
			</uxap:ObjectPageDynamicHeaderTitle>
		</uxap:headerTitle>

		<uxap:headerContent>
			<FlexBox wrap="Wrap" >
                <!-- 구매요청번호 -->
				<layout:VerticalLayout class="sapUiSmallMarginBeginEnd">
                    <Label text="{I18N>/PR_NUMBER} :"/>
                    <ObjectStatus
                        text="{detail>/Pr_ReviewDtlView/pr_number}"
                    />
                </layout:VerticalLayout>
                <!-- 생성일자 -->
                <layout:VerticalLayout class="sapUiSmallMarginBeginEnd">
                    <Label text="{I18N>/PR_REQUEST_DATE} :"/>
                    <ObjectStatus
                        text="{ 
                            path: 'detail>/Pr_ReviewDtlView/request_date',
                            type: 'sap.ui.model.type.Date',
                            formatOptions: {
                                pattern: 'yyyy-MM-dd'
                            }
                        }"
                    />
                </layout:VerticalLayout>
                <!-- 요청자 -->
				<layout:VerticalLayout class="sapUiSmallMarginBeginEnd">
                    <Label text="{I18N>/REQUESTOR_NAME} :"/>
                    <ObjectStatus
                        text="{detail>/Pr_ReviewDtlView/requestor_name}"
                    />
                </layout:VerticalLayout>
                <!-- 생성상태 -->
                <layout:VerticalLayout class="sapUiSmallMarginBeginEnd">
					<Label text="{I18N>/PR_CREATE_STATUS_CODE} :"/>
                    <ObjectStatus
                        class="sapMObjectStatusLarge"
                        text="{detail>/Pr_ReviewDtlView/pr_create_status_name}"
                        state="Error"
                    />
				</layout:VerticalLayout>
			</FlexBox>
		</uxap:headerContent>

		<uxap:sections id="pss">
            <!-- 기본정보 -->
			<uxap:ObjectPageSection titleUppercase="true" title="{I18N>/BASIC_INFO}">
				<uxap:subSections>
					<uxap:ObjectPageSubSection>
						<uxap:blocks>
                            <form:SimpleForm editable="false">
                                    <core:Title text="{I18N>/BASIC_INFO}" />
                                    <Label text="(미정)구매요청번호"/>
                                    <Text text="{detail>/Pr_ReviewDtlView/pr_number}" width="20em" textAlign="Left" />
                                    <Label text="(미정)품목번호"/>
                                    <Text text="{detail>/Pr_ReviewDtlView/pr_item_number}" width="20em" textAlign="Left" />
                                    <Label text="(미정)ERP구매요청번호"/>
                                    <Text text="{detail>/Pr_ReviewDtlView/erp_pr_number}" width="20em" textAlign="Left" />
                                    <Label text="(미정)진행상태"/>
                                    <Text text="{detail>/Pr_ReviewDtlView/pr_progress_status_name}" width="20em" textAlign="Left" />

                                    <core:Title text="" />
                                    <Label text="(미정)구매요청유형"/>
                                    <Text text="{detail>/Pr_ReviewDtlView/pr_type_name}" width="20em" textAlign="Left" />
                                    <Label text="(미정)품목그룹"/>
                                    <Text text="{detail>/Pr_ReviewDtlView/pr_type_name_2}" width="20em" textAlign="Left" />
                                    <Label text="(미정)품목"/>
                                    <Text text="{detail>/Pr_ReviewDtlView/pr_type_name_3}" width="20em" textAlign="Left" />
                                    <Label text="(미정)구매요청템플릿"/>
                                    <Text text="{detail>/Pr_ReviewDtlView/pr_template_number}" width="20em" textAlign="Left" />
                            </form:SimpleForm>
						</uxap:blocks>
					</uxap:ObjectPageSubSection>
				</uxap:subSections>
            </uxap:ObjectPageSection>
            
            <!-- 품목/담당자 정보 -->
			<uxap:ObjectPageSection titleUppercase="true" title="(미정)품목/담당자정보">
				<uxap:subSections>
					<uxap:ObjectPageSubSection>
						<uxap:blocks>
                            <form:SimpleForm editable="false">
                                <core:Title text="(미정)품목정보" />
                                <Label text="(미정)조직코드"/>
                                <Text text="{detail>/Pr_ReviewDtlView/org_name}" width="20em" textAlign="Left" />
                                <Label text="(미정)자재코드"/>
                                <Text text="[{detail>/Pr_ReviewDtlView/material_code}] {detail>/Pr_ReviewDtlView/material_name}" width="20em" textAlign="Left"
                                    visible="{= !!${detail>/Pr_ReviewDtlView/material_code}}"
                                />
                                <Label text="(미정)품명"/>
                                <Text text="{detail>/Pr_ReviewDtlView/pr_desc}" width="20em" textAlign="Left" />
                                <Label text="(미정)비고"/>
                                <Text text="{detail>/Pr_ReviewDtlView/remark}" width="20em" textAlign="Left" />

                                <Label text="(미정)자재그룹"/>
                                <Text text="[{detail>/Pr_ReviewDtlView/material_group_code}] {detail>/Pr_ReviewDtlView/material_group_name}"
                                    visible="{= !!${detail>/Pr_ReviewDtlView/material_group_code}}"
                                />
                                <Label text="(미정)품목범주"/>
                                <Text text="[{detail>/Pr_ReviewDtlView/item_category_code}] {detail>/Pr_ReviewDtlView/item_category_name}" width="20em" textAlign="Left" 
                                    visible="{= !!${detail>/Pr_ReviewDtlView/item_category_code}}"
                                />
                                <Label text="(미정)저장위치"/>
                                <Text text="[{detail>/Pr_ReviewDtlView/slot_code}] {detail>/Pr_ReviewDtlView/slot_name}" width="20em" textAlign="Left"
                                    visible="{= !!${detail>/Pr_ReviewDtlView/slot_code}}"
                                />
                            
                                <core:Title text="(미정)담당자정보"/>
                                <Label text="(미정)구매요청자"/>
                                <Text text="[{detail>/Pr_ReviewDtlView/requestor_department_name}] {detail>/Pr_ReviewDtlView/requestor_name}" width="20em" textAlign="Left" 
                                    visible="{= !!${detail>/Pr_ReviewDtlView/requestor_department_name}}"
                                />
                                <Label text="(미정)구매담당자"/>
                                <Text text="[{detail>/Pr_ReviewDtlView/buyer_department_name}] {detail>/Pr_ReviewDtlView/buyer_name}" width="20em" textAlign="Left"
                                    visible="{= !!${detail>/Pr_ReviewDtlView/buyer_department_name}}"
                                />

                                <Label text="(미정)요청자명"/>
                                <Text text="{detail>/Pr_ReviewDtlView/erp_requestor_name}" width="20em" textAlign="Left" />
                                <Label text="(미정)구매그룹"/>
                                <Text text="[{detail>/Pr_ReviewDtlView/purchasing_group_code}] {detail>/Pr_ReviewDtlView/purchasing_group_name}" width="20em" textAlign="Left" 
                                    visible="{= !!${detail>/Pr_ReviewDtlView/purchasing_group_code}}"
                                />
                                <Label text="(미정)자재구매그룹"/>
                                <Text text="[{detail>/Pr_ReviewDtlView/material_purchasing_group_code}] {detail>/Pr_ReviewDtlView/material_purchasing_group_name}" width="20em" textAlign="Left" 
                                    visible="{= !!${detail>/Pr_ReviewDtlView/material_purchasing_group_code}}"
                                />
                            </form:SimpleForm>
						</uxap:blocks>
					</uxap:ObjectPageSubSection>
				</uxap:subSections>
            </uxap:ObjectPageSection>
            
            <!-- 수량/금액/일자/공급업체 정보 -->
			<uxap:ObjectPageSection titleUppercase="true" title="(미정)수량/금액/일자정보">
				<uxap:subSections>
					<uxap:ObjectPageSubSection>
						<uxap:blocks>
                            <form:SimpleForm editable="false">
                                <core:Title text="(미정)수량/금액정보"/>
                                <Label text="(미정)요청수량"/>
                                <Text 
                                    text="{
                                        parts: [
                                            { path: 'detail>/Pr_ReviewDtlView/pr_quantity', formatter: '.numberFormatter.toNumberString' },
                                            { path: 'detail>/Pr_ReviewDtlView/pr_unit' }
                                        ]
                                    }"
                                    width="20em" 
                                    textAlign="Left" 
                                />

                                <Label text="(미정)잔여수량"/>
                                <Text 
                                    text="{
                                        parts: [
                                            { path: 'detail>/Pr_ReviewDtlView/remain_quantity', formatter: '.numberFormatter.toNumberString' },
                                            { path: 'detail>/Pr_ReviewDtlView/pr_unit' }
                                        ]
                                    }"
                                    width="20em" 
                                    textAlign="Left" 
                                />

                                <Label text="(미정)단가예산"/>
                                <Text 
                                    text="{
                                        parts: [
                                            { path: 'detail>/Pr_ReviewDtlView/estimated_price', formatter: '.numberFormatter.toNumberString' },
                                            { path: 'detail>/Pr_ReviewDtlView/currency_code' }
                                        ]
                                    }"
                                    width="20em" 
                                    textAlign="Left" 
                                />

                                <Label text="(미정)Per"/>
                                <Text text="{detail>/Pr_ReviewDtlView/price_unit}" width="20em" textAlign="Left" />
                                <Label text="(미정)금액"/>
                                <Text 
                                    text="{
                                        parts: [
                                            { path: 'detail>/Pr_ReviewDtlView/pr_amount', formatter: '.numberFormatter.toNumberString' },
                                            { path: 'detail>/Pr_ReviewDtlView/currency_code' }
                                        ]
                                    }"
                                    width="20em" 
                                    textAlign="Left" 
                                />

                                <core:Title text="(미정)일자정보" />
                                <Label text="(미정)생성일자"/>
                                <Text 
                                    text="{
                                        path: 'detail>/Pr_ReviewDtlView/request_date',
                                        formatter: '.dateFormatter.toUTCDateString'
                                    }"
                                    width="20em" 
                                    textAlign="Left"
                                />
                                <Label text="(미정)납품요청일자"/>
                                <Text 
                                    text="{
                                        path: 'detail>/Pr_ReviewDtlView/delivery_request_date',
                                        formatter: '.dateFormatter.toUTCDateString'
                                    }"
                                    width="20em" 
                                    textAlign="Left"
                                />
                                <Label text="(미정)결재일자"/>
                                <Text 
                                    text="{
                                        path: 'detail>/Pr_ReviewDtlView/approval_date',
                                        formatter: '.dateFormatter.toUTCDateString'
                                    }"
                                    width="20em" 
                                    textAlign="Left"
                                />
                                <Label text="(미정)변경일자"/>
                                <Text 
                                    text="{
                                        path: 'detail>/Pr_ReviewDtlView/locale_update_dtm',
                                        formatter: '.dateFormatter.toUTCDateString'
                                    }"
                                    width="20em" 
                                    textAlign="Left"
                                />
                            </form:SimpleForm>
						</uxap:blocks>
					</uxap:ObjectPageSubSection>
				</uxap:subSections>
            </uxap:ObjectPageSection>
            
            <!-- 계정지정 정보 -->
			<uxap:ObjectPageSection titleUppercase="true" title="(미정)공급업체정보" visible="{= !!${detail>/Pr_ReviewDtlView/supplier_code}}">
				<uxap:subSections>
					<uxap:ObjectPageSubSection>
						<uxap:blocks>
                            <form:SimpleForm>
                                <core:Title text="(미정)공급업체정보" />
                                <Label text="(미정)공급업체"/>
                                <Text text="[{detail>/Pr_ReviewDtlView/supplier_code}] {detail>/Pr_ReviewDtlView/supplier_name}" width="20em" textAlign="Left" />
                                
                                <core:Title text="" />
                            </form:SimpleForm>
                        </uxap:blocks>
					</uxap:ObjectPageSubSection>
				</uxap:subSections>
            </uxap:ObjectPageSection>

            <!-- 계정지정 정보 -->
			<uxap:ObjectPageSection titleUppercase="true" title="(미정)계정지정정보" visible="{= ${accounts>/Pr_ReviewDtlAcctView}.length > 0}">
				<uxap:subSections>
					<uxap:ObjectPageSubSection>
						<uxap:blocks>
                            <VBox class="sapUiSmallMargin">
                                <Table 
                                    id="accountsTable" 
                                    visible="true"
                                    sticky="HeaderToolbar,ColumnHeaders" 
                                    inset="false" 
                                    growing="true"
                                    mode="None"
                                    growingThreshold="10"
                                    class="sapFDynamicPageAlignContent" 
                                    items="{
                                        path : 'accounts>/Pr_ReviewDtlAcctView',
                                        sorter: {
                                            path: 'pr_number',
                                            descending: true
                                        }
                                    }"                        
                                    width="auto"
                                >
                                    <headerToolbar>
                                        <OverflowToolbar>
                                            <!-- <Title text="(미정)계정지정정보 ({= ${accounts>/Pr_ReviewDtlAcctView}.length || 0})" level="H2"/> -->
                                            <!-- <Title text="(미정)계정지정정보" level="H2"/> -->
                                            <ToolbarSpacer/>
                                            <Button 
                                                icon="sap-icon://excel-attachment" 
                                                press="onExcel($event, 'Download', ${list>/Pr_ReviewDtlAcctView}, {
                                                    fileName: 'Account List',
                                                    tId: 'accountsTable'
                                                })"
                                            >
                                                <layoutData>
                                                    <OverflowToolbarLayoutData priority="NeverOverflow" />
                                                </layoutData>
                                            </Button>
                                            <Button icon="sap-icon://action-settings" press=".onButtonPress($event, 'personalize', {})">
                                                <layoutData>
                                                    <OverflowToolbarLayoutData priority="NeverOverflow" />
                                                </layoutData>
                                            </Button> 
                                        </OverflowToolbar>
                                    </headerToolbar>
                                    <columns>
                                        <!-- 구매요청 번호 -->
                                        <Column hAlign="Center" width="auto">
                                            <Text text="(미정)코스트센터" />
                                        </Column>
                                        <!-- 구매요청 유형 -->
                                        <Column hAlign="Center" width="auto">
                                            <Text text="(미정)계정코드" />
                                        </Column>
                                        <!-- 품목 번호 -->
                                        <Column hAlign="Center" width="auto">
                                            <Text text="(미정)WBS코드" />
                                        </Column>
                                        <!-- 조직코드 -->
                                        <Column hAlign="Center" width="auto">
                                            <Text text="(미정)자산번호" />
                                        </Column>
                                        <!-- 자재코드 -->
                                        <Column demandPopin="true" minScreenWidth="Desktop" popinDisplay="Inline" hAlign="Center" width="auto">
                                            <Text text="(미정)계정지정범주" />
                                        </Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem type="Navigation">
                                            <cells>
                                                <!-- 코스트센터 -->
                                                <Text text="[{accounts>cctr_code}] {accounts>cctr_name}"/>
                                                <!-- 계정코드 -->
                                                <Text text="[{accounts>account_code}] {accounts>account_name}"/>
                                                <!-- WBS코드 -->
                                                <Text text="[{accounts>wbs_code}] {accounts>wbs_name}"/>
                                                <!-- 오더번호 -->
                                                <Text text="[{accounts>order_number}] {accounts>order_name}"/>
                                                <!-- 자산번호 -->
                                                <Text text="[{accounts>asset_number}] {accounts>asset_name}"/>
                                                <!-- 계정지정범주 -->
                                                <Text text="[{accounts>account_assignment_category_code}] {accounts>account_assignment_category_name}"/>
                                            </cells>
                                        </ColumnListItem>
                                    </items>
                                </Table>
                            </VBox>
						</uxap:blocks>
					</uxap:ObjectPageSubSection>
				</uxap:subSections>
			</uxap:ObjectPageSection>
        </uxap:sections>
        
		<uxap:footer>
			<OverflowToolbar>
                <ToolbarSpacer/>
                <Button 
                    text="(미정)마감취소"
                    type="Emphasized"
                    press=".onButtonPress($event, 'service', ${detail>/Pr_ReviewDtlView}, {
                        action: 'CLOSING_CANCEL',
                        service: 'op.prReviewMgtV4Service',
                        entry: 'CallPrReviewSaveProc'
                    })"
                    visible="{detail>/Pr_ReviewDtlView/closing_flag}"
                />
                <Button 
                    text="(미정)공사물량"
                    type="Transparent"
                    press=".onButtonPress($event, 'service', ${detail>/Pr_ReviewDtlView}, {
                        action: 'XXXXX',
                        service: 'op.prReviewMgtV4Service',
                        entry: 'CallPrReviewSaveProc'
                    })"
                    visible="true"
                />
                <Button 
                    text="(미정)변경이력"
                    type="Transparent"
                    press=".onButtonPress($event, 'service', ${detail>/Pr_ReviewDtlView}, {
                        action: 'XXXXX',
                        service: 'op.prReviewMgtV4Service',
                        entry: 'CallPrReviewSaveProc'
                    })"
                    visible="true"
                />
                <Button 
                    text="(미정)발주이력"
                    type="Transparent"
                    press=".onButtonPress($event, 'service', ${detail>/Pr_ReviewDtlView}, {
                        action: 'XXXXX',
                        service: 'op.prReviewMgtV4Service',
                        entry: 'CallPrReviewSaveProc'
                    })"
                    visible="true"
                />
                <Button 
                    text="(미정)사용실적"
                    type="Transparent"
                    press=".onButtonPress($event, 'service', ${detail>/Pr_ReviewDtlView}, {
                        action: 'XXXXX',
                        service: 'op.prReviewMgtV4Service',
                        entry: 'CallPrReviewSaveProc'
                    })"
                    visible="true"
                />
			    <Button text="{I18N>/CLOSE}" type="Transparent"  press=".onButtonPress($event, 'navigation', { action: 'NavBack' })" />
			</OverflowToolbar>
		</uxap:footer>
	</uxap:ObjectPageLayout>
</mvc:View>