view pg_MI_Cateogry_Detail_View as
    select
        main.tenant_id					as tenant_id,
        main.mi_material_code			as mi_material_code,
        mattext.mi_material_name		as mi_material_name,
        matcode.category_code			as category_code,
        categtext.category_name			as category_name,
        cast(null as nvarchar(3))		as reqm_quantity_unit,
        cast(null as decimal)			as reqm_quantity,
        main.use_flag					as use_flag,
        main.currency_unit				as currency_unit,
        main.quantity_unit				as quantity_unit,
        main.exchange					as exchange,
        main.termsdelv					as termsdelv,
        cast(max(main.mi_date) as date) as mi_date,
        main.price						as price,
        main.local_create_dtm			as local_create_dtm,
		main.local_update_dtm			as local_update_dtm,
		main.create_user_id				as create_user_id,
		main.update_user_id				as update_user_id,
		main.system_create_dtm			as system_create_dtm,
		main.system_update_dtm			as system_update_dtm
    from pg_mi_material_price_management as main
    left join pg_mi_material_code_lng as mattext
        on  main.tenant_id			= mattext.tenant_id
        and main.mi_material_code	= mattext.mi_material_code
		and	mattext.language_code	= upper(substring(session_context('LOCALE'),1,2))
    left join pg_mi_material_code as matcode
		on	main.tenant_id			= matcode.tenant_id
		and	main.mi_material_code	= matcode.mi_material_code
	left join PG_MI_CATEGORY_LNG as categtext
		on	matcode.tenant_id		= categtext.tenant_id
		and	matcode.category_code	= categtext.category_code
		and	categtext.language_code	= upper(substring(session_context('LOCALE'),1,2))
    group by	
        main.tenant_id,
        main.mi_material_code,
        mattext.mi_material_name,
        matcode.category_code,
        categtext.category_name,
        main.use_flag,
        main.currency_unit,
        main.quantity_unit,
        main.exchange,
        main.termsdelv,
        main.price,
        main.local_create_dtm,
		main.local_update_dtm,
		main.create_user_id,
		main.update_user_id,
		main.system_create_dtm,
		main.system_update_dtm
    order by	
        main.tenant_id,
        main.mi_material_code,
        mattext.mi_material_name,
        matcode.category_code,
        categtext.category_name,
        main.use_flag,
        main.currency_unit,
        main.quantity_unit,
        main.exchange,
        main.termsdelv,
        main.price,
        main.local_create_dtm,
		main.local_update_dtm,
		main.create_user_id,
		main.update_user_id,
		main.system_create_dtm,
		main.system_update_dtm
	;