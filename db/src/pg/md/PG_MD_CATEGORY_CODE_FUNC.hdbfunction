FUNCTION PG_MD_CATEGORY_CODE_FUNC (
            IN_SPMD_CODE NVARCHAR(4)
        )
RETURNS OUT_SPMD_CATEGORY_CODE NVARCHAR(4)

LANGUAGE SQLSCRIPT
AS

BEGIN
    DECLARE OUT_RETURN NVARCHAR(3);

	SELECT
		LPAD(IFNULL(MAX(SUBSTRING(SPMD_CATEGORY_CODE,2)), 0)+1, 3, '0') AS MAX_CODE 
		INTO OUT_RETURN
	FROM PG_MD_CATEGORY_ID
	;

    -- Category 전체Seq 채번
    IF (OUT_RETURN IS NULL) THEN
        OUT_RETURN := '001';
    END IF;

    OUT_SPMD_CATEGORY_CODE := 'C'||OUT_RETURN;

END;