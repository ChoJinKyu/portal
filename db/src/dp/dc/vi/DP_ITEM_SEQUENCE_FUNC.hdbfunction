FUNCTION DP_ITEM_SEQUENCE_FUNC (p_tenant_id NVARCHAR(5), p_approval_number NVARCHAR(50), p_increament DECIMAL)
    RETURNS D_RETURN DECIMAL
    LANGUAGE SQLSCRIPT
AS
BEGIN

    SELECT 
        IFNULL(MAX(ITEM_SEQUENCE), 0) + :p_increament
    INTO
        D_RETURN
    FROM 
        DP_VI_BASE_PRICE_ARL_DTL 
    WHERE 
        TENANT_ID = :p_tenant_id AND APPROVAL_NUMBER = :p_approval_number;

END;